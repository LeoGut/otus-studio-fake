(function() {
    'use strict';

    angular
        .module('editor.ui')
        .factory('EditableIDFactory', EditableIDFactory);

    EditableIDFactory.$inject = ['UpdateSurveyItemCustomID'];

    function EditableIDFactory(UpdateSurveyItemCustomID) {
        var self = this;

        self.create = create;

        function create(object) {
            return new EditableIDComponent(object, UpdateSurveyItemCustomID);
        }

        return self;
    }

    function EditableIDComponent(object, UpdateSurveyItemCustomID) {
        var self = this;
        var _object = object;
        var _lastValidID;

        self.getCustomizedID = getCustomizedID;
        self.getAutoGeneratedID = getAutoGeneratedID;
        self.getLastValidID = getLastValidID;
        self.updateCustomizedID = updateCustomizedID;

        function getAutoGeneratedID() {
            var autoGeneratedID;
            if (_object.objectType === "CheckboxAnswerOption") {
                autoGeneratedID = _object.optionID;
            } else {
                autoGeneratedID = _object.templateID;
            }
            return autoGeneratedID;
        }

        function getCustomizedID() {
            var customizedID;
            if (_object.objectType === "CheckboxAnswerOption") {
                customizedID = _object.customOptionID;
            } else {
                customizedID = _object.customID;
            }
            return customizedID;
        }

        function getLastValidID() {
            return _lastValidID;
        }

        function updateCustomizedID(customizedID) {
            _lastValidID = customizedID;
            if (_object.objectType === "CheckboxAnswerOption") {
                _object.setCustomOptionID(customizedID);
            } else {
                UpdateSurveyItemCustomID.execute(_object, customizedID);
            }
        }
    }

}());
