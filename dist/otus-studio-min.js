!function(){angular.module("studio",["dependencies","studio.dashboard","studio.authenticator","editor","otusjs","preview","otusjs.studio.navigationBuilder","surveyTemplates","ui.components","utils","otusjs.player.core","otusjs.player.component"])}(),function(){"use strict";angular.module("studio.authenticator",[])}(),function(){"use strict";function LoginController($scope,DashboardStateService,AuthenticationService){function authenticate(user){AuthenticationService.login(user)}function visitAccess(){DashboardStateService.goToHome()}var self=this;self.authenticate=authenticate,self.visitAccess=visitAccess}angular.module("studio.authenticator").controller("LoginController",LoginController),LoginController.$inject=["$scope","DashboardStateService","AuthenticationService"]}(),function(){angular.module("dependencies",["ngMaterial","ngMessages","ngAnimate","ui.router","lokijs","indexedDB","immutable","ui.utils.masks","otus.domain.client","otus.textEdition"])}(),function(){function localeConfiguration($mdDateLocaleProvider){$mdDateLocaleProvider.formatDate=function(date){return moment(date).format("DD/MM/YYYY")},$mdDateLocaleProvider.parseDate=function(dateString){var m=moment(dateString,"DD/MM/YYYY",!0);return m.isValid()?m.toDate():new Date(NaN)}}angular.module("studio").config(["$mdDateLocaleProvider",localeConfiguration])}(),function(){function stateConfiguration($stateProvider,$urlRouterProvider,$locationProvider){var dashboardMenu="app/dashboard/menu/dashboard-menu.html";$stateProvider.state("login",{url:"/login",views:{"system-wrap":{templateUrl:"app/authenticator/login.html",controller:"LoginController as loginController"}}}).state("home",{url:"/home",views:{"system-wrap":{templateUrl:"app/dashboard/main-dashboard-content-template.html",controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@home":{templateUrl:dashboardMenu},"system-content@home":{templateUrl:"app/dashboard/home/layout-template.html"},"section-info@home":{templateUrl:"app/dashboard/home/home-info-section.html"},"section-view@home":{templateUrl:"app/dashboard/home/home-view-section.html"},"section-commands@home":{templateUrl:"app/dashboard/home/home-commands-section.html"}}}).state("survey-templates",{url:"/survey-templates",views:{"system-wrap":{templateUrl:"app/dashboard/main-dashboard-content-template.html",controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@survey-templates":{templateUrl:dashboardMenu},"system-content@survey-templates":{templateUrl:"app/dashboard/survey-templates/layout-template.html",controller:"SurveyFormDashboardController as surveyFormDashboard"},"section-view@survey-templates":{templateUrl:"app/dashboard/survey-templates/survey-form-view-section.html",controller:"SurveyFormDashboardController as surveyFormDashboard"},"template-menu@survey-templates":{templateUrl:"app/dashboard/survey-templates/menu/md-fab.html"}}}).state("editor",{url:"/editor",params:{template:null},views:{"system-wrap":{templateUrl:"app/dashboard/main-dashboard-content-template.html",controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@editor":{templateUrl:dashboardMenu},"system-content@editor":{templateUrl:"app/editor/ui/main/main-container.html",controller:"MainContainerController as mainContainer",resolve:{editor:function($stateParams,SurveyEditorService,CrossSessionDatabaseService,$window,$q){function _loadFromIndexedDB(){var promise=CrossSessionDatabaseService.findSurveyTemplateByOID(surveyTemplate_OID);promise.then(function(result){$stateParams.template=result.template,_startEditor($stateParams.template),deferred.resolve(!0)})}function _startEditor(surveyTemplate){SurveyEditorService.startEditorWithSurveyTemplate(surveyTemplate)}var surveyTemplate_OID=$window.sessionStorage.getItem("surveyTemplate_OID");if($stateParams.template)_startEditor($stateParams.template);else if(surveyTemplate_OID){var deferred=$q.defer();return _loadFromIndexedDB(),deferred.promise}}}}}}),$urlRouterProvider.otherwise("/login")}angular.module("studio").config(["$stateProvider","$urlRouterProvider","$locationProvider",stateConfiguration]).constant("APP_STATE",{HOME:"home",SURVEY_TEMPLATES:"survey-templates",EDITOR:"editor",LOGIN:"login"})}(),function(){function themeConfiguration($mdThemingProvider,$mdIconProvider){$mdThemingProvider.theme("layoutTheme").primaryPalette("blue",{default:"A200","hue-1":"200","hue-2":"50","hue-3":"700"}).accentPalette("blue-grey",{default:"900","hue-1":"50"}).warnPalette("red"),$mdThemingProvider.theme("greyTheme").primaryPalette("grey"),$mdIconProvider.defaultIconSet("app/assets/img/icons/mdi.svg",24)}angular.module("studio").config(["$mdThemingProvider","$mdIconProvider",themeConfiguration])}(),function(){"use strict";angular.module("studio.dashboard",[])}(),function(){"use strict";angular.module("editor",["editor.core","editor.database","editor.ui","editor.workspace"])}(),function(){"use strict";angular.module("otusjs.studio.navigationBuilder",["otusjs.studio.navigationBuilder.model","otusjs.studio.navigationBuilder.routeBuilder","otusjs.studio.navigationBuilder.messenger","ngMaterial"]).constant("NBEVENTS",{ROUTE_MODE_OFF:"nbevents.module.mode.off",MAP_CONTAINER_READY:"nbevents.map.container.ready",ROUTE_BUILD_STARTED:"nbevents.map.route.started",ROUTE_BUILD_SAVED:"nbevents.map.route.build.saved",ROUTE_BUILD_CANCELED:"nbevents.map.route.build.canceled",ORIGIN_NODE_SELECTED:"nbevents.map.route.node.origin.selected",ORIGIN_NODE_UNSELECTED:"nbevents.map.route.node.origin.unselected",DESTINATION_NODE_SELECTED:"nbevents.map.route.node.destination.selected",DESTINATION_NODE_UNSELECTED:"nbevents.map.route.node.destination.unselected",SHOW_MESSENGER:"nbevents.messenger.show",HIDE_MESSENGER:"nbevents.messenger.hide"}).constant("NBMESSAGES",{ROUTE_BUILDER:{SELECT_ORIGIN:{header:"Origem da Rota",content:"Escolha o item que determinará o início da rota."},SELECT_DESTINATION:{header:"Destino da Rota",content:"Escolha o item que determinará o destino da rota."}}}).run(["otusjs.studio.navigationBuilder.NavigationBuilderScopeService","otusjs.studio.navigationBuilder.EventsService","$rootScope",function(NavigationBuilderScopeService,EventsService,$rootScope){NavigationBuilderScopeService.initialize($rootScope.$new()),EventsService.activate()}])}(),function(){"use strict";angular.module("preview",[])}(),function(){"use strict";function AuthenticationService(LogoutDialogService,DashboardStateService,RestResourceService,$mdToast,$window){function logout(){LogoutDialogService.showDialog().onConfirm(function(){invalidateSession(RestResourceService)})}function invalidateSession(domainRestResourceService){var authenticatorResource=domainRestResourceService.getAuthenticatorResource();domainRestResourceService.isLogged()?invalidateSessionLoggedUser(authenticatorResource):invalidateSessionVisitant()}function invalidateSessionLoggedUser(authenticatorResource){authenticatorResource.invalidate(function(response){DashboardStateService.logout(),$window.sessionStorage.clear()})}function invalidateSessionVisitant(){$window.sessionStorage.clear(),DashboardStateService.logout()}function login(user){RestResourceService.setUrl(user.domain);var authenticatorResource=RestResourceService.getAuthenticatorResource();authenticatorResource.authenticate(user,function(response){RestResourceService.setSecurityToken(response.data),response.hasErrors?$mdToast.show($mdToast.simple().textContent(LOGIN_ERROR_MESSAGE)):DashboardStateService.goToHome()})}var LOGIN_ERROR_MESSAGE="Login Inválido! Verifique os dados informados.",self=this;self.logout=logout,self.login=login}angular.module("studio.authenticator").service("AuthenticationService",AuthenticationService),AuthenticationService.$inject=["LogoutDialogService","DashboardStateService","RestResourceService","$mdToast","$window"]}(),function(){"use strict";function DashboardStateService($state,$http,APP_STATE){function init(){self.currentState="Home"}function goToLogin(){self.currentState="Login",$state.go(APP_STATE.LOGIN)}function goToHome(){self.currentState="Home",$state.go(APP_STATE.HOME)}function goToFormTemplates(){self.currentState="SurveyTemplates",$state.go(APP_STATE.SURVEY_TEMPLATES)}function goToEditor(){self.currentState="Edição de Formulário",$state.go(APP_STATE.EDITOR)}function goToEditorWithSurveyTemplate(surveyTemplate){self.currentState="Edição de Formulário",$state.go(APP_STATE.EDITOR,{template:surveyTemplate})}function logout(){goToLogin()}var self=this;self.goToLogin=goToLogin,self.goToHome=goToHome,self.goToFormTemplates=goToFormTemplates,self.goToEditor=goToEditor,self.logout=logout,self.goToEditorWithSurveyTemplate=goToEditorWithSurveyTemplate,init()}angular.module("studio.dashboard").service("DashboardStateService",DashboardStateService),DashboardStateService.$inject=["$state","$http","APP_STATE"]}(),function(){"use strict";function HomeController($http,$scope,$rootScope){var $HTTP_GET_URL_LOGGED_USER=window.location.origin+"/otus-domain-rest/session/rest/register/loggedUser";$scope.loggedUser={},$http.get($HTTP_GET_URL_LOGGED_USER).then(function(response){$scope.loggedUser=response.data.data}),$scope.isAdmin=function(loggedUser){return loggedUser.admin},$scope.isNotAdmin=function(loggedUser){return!loggedUser.admin},$scope.doesNotHasRepository=function(){if($rootScope.repositories)return $rootScope.repositories.length}}angular.module("studio.dashboard").controller("HomeController",HomeController),HomeController.$inject=["$http","$scope","$rootScope"]}(),function(){"use strict";function DashboardMenuController(DashboardStateService,$mdSidenav,AuthenticationService){function getSelectedSystemArea(){return DashboardStateService.currentState}function open(){$mdSidenav("left").toggle()}function close(){$mdSidenav("left").close()}function openHome(){DashboardStateService.goToHome(),close()}function openFormTemplates(){DashboardStateService.goToFormTemplates(),close()}function logout(){AuthenticationService.logout()}var self=this;self.getSelectedSystemArea=getSelectedSystemArea,self.open=open,self.close=close,self.openHome=openHome,self.openFormTemplates=openFormTemplates,self.logout=logout}angular.module("studio.dashboard").controller("DashboardMenuController",DashboardMenuController),DashboardMenuController.$inject=["DashboardStateService","$mdSidenav","AuthenticationService"]}(),function(){"use strict";function SurveyFormDashboardController(NewSurveyFormDialogService,DashboardStateService,SurveyEditorService){function startNewSurveyForm(){NewSurveyFormDialogService.showDialog().onConfirm(function(workInitializationData){SurveyEditorService.startEditor(workInitializationData),DashboardStateService.goToEditor()})}var self=this;self.startNewSurveyForm=startNewSurveyForm}angular.module("studio.dashboard").controller("SurveyFormDashboardController",SurveyFormDashboardController),SurveyFormDashboardController.$inject=["NewSurveyFormDialogService","DashboardStateService","SurveyEditorService"]}(),function(){"use strict";angular.module("surveyTemplates",[])}(),function(){"use strict";function SurveyEditorService(WorkspaceService){function startEditor(initializationData){WorkspaceService.initializeWorkspace({owner:"visitor"}),WorkspaceService.startNewWork(initializationData)}function startEditorWithSurveyTemplate(surveyTemplate){WorkspaceService.initializeWorkspace({owner:"visitor"}),WorkspaceService.loadWork(surveyTemplate)}var self=this;self.startEditor=startEditor,self.startEditorWithSurveyTemplate=startEditorWithSurveyTemplate}angular.module("editor").service("SurveyEditorService",SurveyEditorService),SurveyEditorService.$inject=["WorkspaceService"]}(),function(){"use strict";angular.module("editor.core",[])}(),function(){"use strict";angular.module("editor.database",[]).config(function($indexedDBProvider){$indexedDBProvider.connection("otus-studio").upgradeDatabase(1,function(event,db,tx){var store=db.createObjectStore("survey_template",{keyPath:"template_oid"});store.createIndex("contributor_idx","contributor",{unique:!1})})})}(),function(){"use strict";angular.module("editor.ui",["angular-bind-html-compile"])}(),function(){"use strict";angular.module("editor.workspace",[])}(),function(){"use strict";function service(MapFactory,RouteBuilderService,NavigationInspectorService){function nodes(){return _navigationMap.nodes()}function edges(){return _navigationMap.edges()}function setSurvey(survey){_survey=survey,_loadTemplateNavigations(survey.NavigationManager.getNavigationList())}function activateRouteCreatorMode(){_activeServiceMode=RouteBuilderService,_activeServiceMode.activate(_survey)}function activateNavigationInspectorMode(){_activeServiceMode=NavigationInspectorService}function deactiveMode(){return _activeServiceMode.deactivate()}function _addNodes(templateNavigations){templateNavigations.forEach(function(navigation){var nodeOptions={id:navigation.origin,label:navigation.origin},node=_navigationMap.createNode(nodeOptions);node.navigation=navigation,_navigationMap.addNode(node)})}function _addEdges(templateNavigations){templateNavigations.forEach(function(navigation){navigation.routes.forEach(function(route){var edgeOptions={};edgeOptions.id=navigation.origin,edgeOptions.source=route.origin,edgeOptions.target=route.destination;var edge=_navigationMap.createEdge(edgeOptions);edge.route=route,_navigationMap.addEdge(edge)})})}function _loadTemplateNavigations(templateNavigations){_navigationMap=MapFactory.create(),_addNodes(templateNavigations),_addEdges(templateNavigations)}var self=this,_survey={},_navigationMap={},_activeServiceMode=null;self.mapData=null,self.nodes=nodes,self.edges=edges,self.setSurvey=setSurvey,self.activateRouteCreatorMode=activateRouteCreatorMode,self.activateNavigationInspectorMode=activateNavigationInspectorMode,self.deactiveMode=deactiveMode}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.NavigationBuilderService",service),service.$inject=["otusjs.studio.navigationBuilder.model.MapFactory","otusjs.studio.navigationBuilder.routeBuilder.RouteBuilderService","otusjs.studio.navigationBuilder.NavigationInspectorService"]}(),function(){"use strict";function service(){function selectNode(node){_selectedNode=node,_selectedNodeFamily=[_selectedNode],_selectedEdges=[],_selectedNode.navigation.routes.forEach(function(route){_calculateSelectedNodeFamily(route),_calculateSelectedEdges(route)})}function _calculateSelectedNodeFamily(route){var result=_navigationMap.nodes().filter(function(node){return node.id===route.destination});_selectedNodeFamily.push(result[0])}function _calculateSelectedEdges(route){var result=_navigationMap.edges().filter(function(edge){return edge.target===route.destination});_selectedEdges.push(result[0])}var self=this,_selectedNode=null;self.selectNode=selectNode}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.NavigationInspectorService",service)}(),function(){"use strict";function service(scopeService,NavigationBuilderService){function activate(){scopeService.onEvent(scopeService.NBEVENTS.ROUTE_MODE_OFF,function(event){NavigationBuilderService.deactiveMode()})}var self=this;self.activate=activate}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.EventsService",service),service.$inject=["otusjs.studio.navigationBuilder.NavigationBuilderScopeService","otusjs.studio.navigationBuilder.NavigationBuilderService"]}(),function(){"use strict";function service(NBEVENTS,NBMESSAGES){function initialize(scope){scope.events=NBEVENTS,scope.messages=NBMESSAGES,_scope=scope}function onEvent(event,listener){return _scope.$on(event,listener)}function broadcast(event,data){_scope.$broadcast(event,data)}function emit(event,data){_scope.$emit(event,data)}function digest(){_scope.$digest()}var self=this,_scope=null;self.NBEVENTS=NBEVENTS,self.NBMESSAGES=NBMESSAGES,self.initialize=initialize,self.onEvent=onEvent,self.broadcast=broadcast,self.emit=emit,self.digest=digest}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.NavigationBuilderScopeService",service),service.$injects=["NBEVENTS","NBMESSAGES"]}(),function(){"use strict";function component(scopeService,MapVisualHandlerService,NavigationBuilderService,NavigationMessengerService){function onInit(){_initializeComponents(),_initializeModuleEvents()}function _initializeComponents(){self.routeMenuCtrl=new routeMenuController(NavigationBuilderService)}function _initializeModuleEvents(){scopeService.onEvent(scopeService.NBEVENTS.MAP_CONTAINER_READY,function(event,data){MapVisualHandlerService.loadMapView(new sigma("map-view")),_renderMap()})}function _renderMap(){var nodes=NavigationBuilderService.nodes(),edges=NavigationBuilderService.edges();MapVisualHandlerService.loadMapData(nodes,edges),MapVisualHandlerService.drawMap()}var self=this;self.showMessenger=!0,self.$onInit=onInit}function routeMenuController(NavigationBuilderService){function click(){self.isOpen=!self.isOpen}function addRoute(){NavigationBuilderService.activateRouteCreatorMode()}function _init(){self.isOpen=!1}var self=this;_init(),self.click=click,self.addRoute=addRoute}angular.module("otusjs.studio.navigationBuilder").component("otusNavigationMap",{templateUrl:"app/navigation-builder/map/map-template.html",controller:component}),component.$inject=["otusjs.studio.navigationBuilder.NavigationBuilderScopeService","otusjs.studio.navigationBuilder.MapVisualHandlerService","otusjs.studio.navigationBuilder.NavigationBuilderService","otusjs.studio.navigationBuilder.messenger.InstructorService"]}(),function(){"use strict";function service(){function loadMapView(mapView){_mapView=mapView,_initializeEventListeners()}function mapView(){return _mapView}function onClickNode(listener){_clickNodeListeners=[],_clickNodeListeners.push(listener)}function clearAllEventListeners(){_clickNodeListeners=[],_mapView.unbind(CLICK_NODE)}function _initializeEventListeners(){_mapView.bind(CLICK_NODE,function(event){_clickNodeListeners.forEach(function(listener){listener(event)})})}var self=this;const CLICK_NODE="clickNode";var _mapView=null,_clickNodeListeners=[];self.loadMapView=loadMapView,self.mapView=mapView,self.onClickNode=onClickNode,self.clearAllEventListeners=clearAllEventListeners}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.MapEventsHandlerService",service)}(),function(){"use strict";function service(){function mapView(){return _mapView}function loadMapView(mapView){clearMap(),_mapView=mapView}function loadMapData(nodes,edges){_mapView.graph.read({nodes:nodes,edges:edges})}function drawMap(){_mapView.refresh()}function clearMap(){_mapView&&(_mapView.graph.clear(),$("#map-view").empty())}function markOriginRouteNode(nodeToMark){nodeToMark.color="#00F",_selectedNodes.push(nodeToMark)}function markDestinationRouteNode(nodeToMark){nodeToMark.color="#F00",_selectedNodes.push(nodeToMark)}function unmarkNode(nodeToMark){nodeToMark.color="#000"}function lockPreviousNodesOf(nodeLimiter){_mapView.graph.nodes().every(function(node){if(node.id!==nodeLimiter.id)return node.color="#CCC",node.isDisabled=!0,_selectedNodes.push(node),!0})}function releasePreviousNodesOf(nodeLimiter){_mapView.graph.nodes().every(function(node){if(node.id!==nodeLimiter.id)return node.color="#000",node.isEnabled=!1,!0})}function clearSelections(){_selectedNodes.forEach(function(node){node.color="#000"}),drawMap()}var self=this,_mapView=null,_selectedNodes=[];self.mapView=mapView,self.loadMapView=loadMapView,self.loadMapData=loadMapData,self.drawMap=drawMap,self.clearMap=clearMap,self.markOriginRouteNode=markOriginRouteNode,self.markDestinationRouteNode=markDestinationRouteNode,self.unmarkNode=unmarkNode,self.lockPreviousNodesOf=lockPreviousNodesOf,self.releasePreviousNodesOf=releasePreviousNodesOf,self.clearSelections=clearSelections}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.MapVisualHandlerService",service)}(),function(){"use strict";angular.module("otusjs.studio.navigationBuilder.messenger",[])}(),function(){"use strict";function factory(){function create(data){return new Map(data)}var self=this;return self.create=create,self}function Map(data){function _init(){data&&(_yAxis=parseInt(data.nodes.length/2),data.nodes.forEach(function(item){addNode(_parseToNodeOptions(item))}))}function nodes(){return _nodes}function edges(){return _edges}function addNode(node){_nodeExists(node.id)||(node.x=_nodes.length,node.y=0,_nodes.push(node))}function addEdge(edge){_nodeExists(edge.source)&&_nodeExists(edge.target)&&_edges.push(edge)}function createNode(options){return new Node(options)}function createEdge(options){return new Edge(options)}function getNavigation(node){var result=_nodes.filter(function(nodeToCompare){return nodeToCompare.id===node.id});return result.length?result[0].navigation:void 0}function _parseToNodeOptions(data){return{id:data.origin,label:data.origin,x:_nodes.length,y:_yAxis}}function _nodeExists(nodeID){var result=_nodes.filter(function(node){return node.id===nodeID});return!!result.length}var self=this,_nodes=[],_edges=[],_yAxis=0;_init(),self.addNode=addNode,self.addEdge=addEdge,self.nodes=nodes,self.edges=edges,self.createNode=createNode,self.createEdge=createEdge,self.getNavigation=getNavigation}function Node(options){var self=this;self.id=options.id,self.label=options.label,self.x=options.x||0,self.y=options.y||0,self.size=options.size||"10",self.color=options.color||"#000"}function Edge(options){var self=this;self.id=options.id,self.source=options.source,self.target=options.target}angular.module("otusjs.studio.navigationBuilder.model").factory("otusjs.studio.navigationBuilder.model.MapFactory",factory)}(),function(){"use strict";angular.module("otusjs.studio.navigationBuilder.model",[])}(),function(){"use strict";angular.module("otusjs.studio.navigationBuilder.routeBuilder",[])}(),function(){"use strict";function EditionPreviewService($stateParams,AddSurveyItemEventFactory,$timeout,$q){function loadSurveyTemplate(){if(_surveyToLoad=$stateParams.template,_surveyToLoad.itemContainer.length>0)return self.isLoading=!0,_renderSurveyTemplate()}function _renderSurveyTemplate(){var deferred=$q.defer();return _scope.$$phase&&(AddSurveyItemEventFactory.create().load(_surveyToLoad.itemContainer[0]),_surveyToLoad.itemContainer.splice(0,1),_surveyToLoad.itemContainer.length>0?$timeout(function(){_surveyToLoad.itemContainer.forEach(function(item){AddSurveyItemEventFactory.create().load(item),_scope.$digest()}),deferred.resolve($stateParams.template)},1e3):deferred.resolve($stateParams.template)),deferred.promise}function isLoadingMode(){return $stateParams.template}function setScope(scope){_scope=scope}var _surveyToLoad,_scope,self=this;self.isLoading=!1,self.setScope=setScope,self.isLoadingMode=isLoadingMode,self.loadSurveyTemplate=loadSurveyTemplate}angular.module("preview").service("EditionPreviewService",EditionPreviewService),EditionPreviewService.$inject=["$stateParams","AddSurveyItemEventFactory","$timeout","$q"]}(),function(){"use strict";function otusSurveyPreviewGenerator(){var ddo={restrict:"A",controller:Controller};return ddo}function Controller($scope,$element,$compile,WorkspaceService){function _generateOtusPreview(){_newScope=$scope.$new(!0),_newScope.surveyTemplate=_getSurveyTemplateObject();var content=$compile(OTUS_SHEET_COMPONENT)(_newScope);$("#survey-preview").append(content)}function _getSurveyTemplateObject(){return JSON.parse(WorkspaceService.getSurvey().toJson())}var _newScope,OTUS_SHEET_COMPONENT='<otus-sheet md-theme="layoutTheme" survey-template="surveyTemplate" layout="column" flex="80"></otus-sheet>';$element.on("click",function(){var otusSheetDOMElement=$("otus-sheet");otusSheetDOMElement[0]&&(otusSheetDOMElement.remove(),_newScope.$destroy()),_generateOtusPreview()})}angular.module("preview").directive("otusSurveyPreviewGenerator",otusSurveyPreviewGenerator),Controller.$inject=["$scope","$element","$compile","WorkspaceService"]}(),function(){"use strict";var __slice=[].slice;angular.module("indexedDB",[]).provider("$indexedDB",function(){var IDBKeyRange,allTransactions,apiDirection,appendResultsToPromise,applyNeededUpgrades,cursorDirection,db,dbMode,dbName,dbPromise,dbVersion,defaultQueryOptions,errorMessageFor,indexedDB,readyState,upgradesByVersion;indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,IDBKeyRange=window.IDBKeyRange||window.mozIDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,dbMode={readonly:"readonly",readwrite:"readwrite"},readyState={pending:"pending"},cursorDirection={next:"next",nextunique:"nextunique",prev:"prev",prevunique:"prevunique"},apiDirection={ascending:cursorDirection.next,descending:cursorDirection.prev},dbName="",dbVersion=1,db=null,upgradesByVersion={},dbPromise=null,allTransactions=[],defaultQueryOptions={useIndex:void 0,keyRange:null,direction:cursorDirection.next},applyNeededUpgrades=function(oldVersion,event,db,tx,$log){var version;for(version in upgradesByVersion)!upgradesByVersion.hasOwnProperty(version)||oldVersion>=version||($log.log("$indexedDB: Running upgrade : "+version+" from "+oldVersion),upgradesByVersion[version](event,db,tx))},errorMessageFor=function(e){return e.target.readyState===readyState.pending?"Error: Operation pending":e.target.webkitErrorMessage||e.target.error.message||e.target.errorCode},appendResultsToPromise=function(promise,results){return void 0!==results?promise.then(function(){return results}):promise},this.connection=function(databaseName){return dbName=databaseName,this},this.upgradeDatabase=function(newVersion,callback){return upgradesByVersion[newVersion]=callback,dbVersion=Math.max.apply(null,Object.keys(upgradesByVersion)),this},this.$get=["$q","$rootScope","$log",function($q,$rootScope,$log){var DbQ,ObjectStore,Query,Transaction,addTransaction,closeDatabase,createDatabaseConnection,keyRangeForOptions,openDatabase,openTransaction,rejectWithError,validateStoreNames;return rejectWithError=function(deferred){return function(error){return $rootScope.$apply(function(){return deferred.reject(errorMessageFor(error))})}},createDatabaseConnection=function(){var dbReq,deferred;return deferred=$q.defer(),dbReq=indexedDB.open(dbName,parseInt(dbVersion)||1),dbReq.onsuccess=function(){db=dbReq.result,$rootScope.$apply(function(){deferred.resolve(db)})},dbReq.onblocked=dbReq.onerror=rejectWithError(deferred),dbReq.onupgradeneeded=function(event){var tx;db=event.target.result,tx=event.target.transaction,$log.log("$indexedDB: Upgrading database '"+db.name+"' from version "+event.oldVersion+" to version "+event.newVersion+" ..."),applyNeededUpgrades(event.oldVersion,event,db,tx,$log)},deferred.promise},openDatabase=function(){return dbPromise||(dbPromise=createDatabaseConnection())},closeDatabase=function(){return openDatabase().then(function(){return db.close(),db=null,dbPromise=null})},validateStoreNames=function(storeNames){var found,storeName,_i,_len;for(found=!0,_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],found&=db.objectStoreNames.contains(storeName);return found},openTransaction=function(storeNames,mode){return null==mode&&(mode=dbMode.readonly),openDatabase().then(function(){return validateStoreNames(storeNames)?new Transaction(storeNames,mode):$q.reject("Object stores "+storeNames+" do not exist.")})},keyRangeForOptions=function(options){return options.beginKey&&options.endKey?IDBKeyRange.bound(options.beginKey,options.endKey):void 0},addTransaction=function(transaction){return allTransactions.push(transaction.promise),transaction.promise.finally(function(){var index;return index=allTransactions.indexOf(transaction.promise),index>-1?allTransactions.splice(index,1):void 0})},Transaction=function(){function Transaction(storeNames,mode){null==mode&&(mode=dbMode.readonly),this.transaction=db.transaction(storeNames,mode),this.defer=$q.defer(),this.promise=this.defer.promise,this.setupCallbacks()}return Transaction.prototype.setupCallbacks=function(){return this.transaction.oncomplete=function(_this){return function(){return $rootScope.$apply(function(){return _this.defer.resolve("Transaction Completed")})}}(this),this.transaction.onabort=function(_this){return function(error){return $rootScope.$apply(function(){return _this.defer.reject("Transaction Aborted",error)})}}(this),this.transaction.onerror=function(_this){return function(error){return $rootScope.$apply(function(){return _this.defer.reject("Transaction Error",error)})}}(this),addTransaction(this)},Transaction.prototype.objectStore=function(storeName){return this.transaction.objectStore(storeName)},Transaction.prototype.abort=function(){return this.transaction.abort()},Transaction}(),DbQ=function(){function DbQ(){this.q=$q.defer(),this.promise=this.q.promise}return DbQ.prototype.reject=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],$rootScope.$apply(function(_this){return function(){var _ref;return(_ref=_this.q).reject.apply(_ref,args)}}(this))},DbQ.prototype.rejectWith=function(req){return req.onerror=req.onblocked=function(_this){return function(e){return _this.reject(errorMessageFor(e))}}(this)},DbQ.prototype.resolve=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],$rootScope.$apply(function(_this){return function(){var _ref;return(_ref=_this.q).resolve.apply(_ref,args)}}(this))},DbQ.prototype.notify=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],$rootScope.$apply(function(_this){return function(){var _ref;return(_ref=_this.q).notify.apply(_ref,args)}}(this))},DbQ.prototype.dbErrorFunction=function(){return function(_this){return function(error){return $rootScope.$apply(function(){return _this.q.reject(errorMessageFor(error))})}}(this)},DbQ.prototype.resolveWith=function(req){return this.rejectWith(req),req.onsuccess=function(_this){return function(e){return _this.resolve(e.target.result)}}(this)},DbQ}(),ObjectStore=function(){function ObjectStore(storeName,transaction){this.storeName=storeName,this.store=transaction.objectStore(storeName),this.transaction=transaction}return ObjectStore.prototype.defer=function(){return new DbQ},ObjectStore.prototype._mapCursor=function(defer,mapFunc,req){var results;return null==req&&(req=this.store.openCursor()),results=[],defer.rejectWith(req),req.onsuccess=function(e){var cursor;return(cursor=e.target.result)?(results.push(mapFunc(cursor)),defer.notify(mapFunc(cursor)),cursor.continue()):defer.resolve(results)}},ObjectStore.prototype._arrayOperation=function(data,mapFunc){var defer,item,req,results,_i,_len;for(defer=this.defer(),angular.isArray(data)||(data=[data]),_i=0,_len=data.length;_len>_i;_i++)item=data[_i],req=mapFunc(item),results=[],defer.rejectWith(req),req.onsuccess=function(e){return results.push(e.target.result),defer.notify(e.target.result),results.length>=data.length?defer.resolve(results):void 0};return 0===data.length?$q.when([]):defer.promise},ObjectStore.prototype.getAllKeys=function(){var defer,req;return defer=this.defer(),this.store.getAllKeys?(req=this.store.getAllKeys(),defer.resolveWith(req)):this._mapCursor(defer,function(cursor){return cursor.key}),defer.promise},ObjectStore.prototype.clear=function(){var defer,req;return defer=this.defer(),req=this.store.clear(),defer.resolveWith(req),defer.promise},ObjectStore.prototype.delete=function(key){var defer;return defer=this.defer(),defer.resolveWith(this.store.delete(key)),defer.promise},ObjectStore.prototype.upsert=function(data){return this._arrayOperation(data,function(_this){return function(item){return _this.store.put(item)}}(this))},ObjectStore.prototype.insert=function(data){return this._arrayOperation(data,function(_this){return function(item){return _this.store.add(item)}}(this))},ObjectStore.prototype.getAll=function(){var defer;return defer=this.defer(),this.store.getAll?defer.resolveWith(this.store.getAll()):this._mapCursor(defer,function(cursor){return cursor.value;
}),defer.promise},ObjectStore.prototype.eachWhere=function(query){var defer,direction,indexName,keyRange,req;return defer=this.defer(),indexName=query.indexName,keyRange=query.keyRange,direction=query.direction,req=indexName?this.store.index(indexName).openCursor(keyRange,direction):this.store.openCursor(keyRange,direction),this._mapCursor(defer,function(cursor){return cursor.value},req),defer.promise},ObjectStore.prototype.findWhere=function(query){return this.eachWhere(query)},ObjectStore.prototype.each=function(options){return null==options&&(options={}),this.eachBy(void 0,options)},ObjectStore.prototype.eachBy=function(indexName,options){var q;return null==indexName&&(indexName=void 0),null==options&&(options={}),q=new Query,q.indexName=indexName,q.keyRange=keyRangeForOptions(options),q.direction=options.direction||defaultQueryOptions.direction,this.eachWhere(q)},ObjectStore.prototype.count=function(){var defer;return defer=this.defer(),defer.resolveWith(this.store.count()),defer.promise},ObjectStore.prototype.find=function(key){var defer,req;return defer=this.defer(),req=this.store.get(key),defer.rejectWith(req),req.onsuccess=function(_this){return function(e){return e.target.result?defer.resolve(e.target.result):defer.reject(""+_this.storeName+":"+key+" not found.")}}(this),defer.promise},ObjectStore.prototype.findBy=function(index,key){var defer;return defer=this.defer(),defer.resolveWith(this.store.index(index).get(key)),defer.promise},ObjectStore.prototype.query=function(){return new Query},ObjectStore}(),Query=function(){function Query(){this.indexName=void 0,this.keyRange=void 0,this.direction=cursorDirection.next}return Query.prototype.$lt=function(value){return this.keyRange=IDBKeyRange.upperBound(value,!0),this},Query.prototype.$gt=function(value){return this.keyRange=IDBKeyRange.lowerBound(value,!0),this},Query.prototype.$lte=function(value){return this.keyRange=IDBKeyRange.upperBound(value),this},Query.prototype.$gte=function(value){return this.keyRange=IDBKeyRange.lowerBound(value),this},Query.prototype.$eq=function(value){return this.keyRange=IDBKeyRange.only(value),this},Query.prototype.$between=function(low,hi,exLow,exHi){return null==exLow&&(exLow=!1),null==exHi&&(exHi=!1),this.keyRange=IDBKeyRange.bound(low,hi,exLow,exHi),this},Query.prototype.$desc=function(unique){return this.direction=unique?cursorDirection.prevunique:cursorDirection.prev,this},Query.prototype.$asc=function(unique){return this.direction=unique?cursorDirection.nextunique:cursorDirection.next,this},Query.prototype.$index=function(indexName){return this.indexName=indexName,this},Query}(),{openStore:function(storeName,callBack,mode){return null==mode&&(mode=dbMode.readwrite),openTransaction([storeName],mode).then(function(transaction){var results;return results=callBack(new ObjectStore(storeName,transaction)),appendResultsToPromise(transaction.promise,results)})},openStores:function(storeNames,callback,mode){return null==mode&&(mode=dbMode.readwrite),openTransaction(storeNames,mode).then(function(transaction){var objectStores,results,storeName;return objectStores=function(){var _i,_len,_results;for(_results=[],_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],_results.push(new ObjectStore(storeName,transaction));return _results}(),results=callback.apply(null,objectStores),appendResultsToPromise(transaction.promise,results)})},openAllStores:function(callback,mode){return null==mode&&(mode=dbMode.readwrite),openDatabase().then(function(_this){return function(){var objectStores,results,storeName,storeNames,transaction;return storeNames=Array.prototype.slice.apply(db.objectStoreNames),transaction=new Transaction(storeNames,mode),objectStores=function(){var _i,_len,_results;for(_results=[],_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],_results.push(new ObjectStore(storeName,transaction));return _results}(),results=callback.apply(null,objectStores),appendResultsToPromise(transaction.promise,results)}}(this))},closeDatabase:function(){return closeDatabase()},deleteDatabase:function(){return closeDatabase().then(function(){var defer;return defer=new DbQ,defer.resolveWith(indexedDB.deleteDatabase(dbName)),defer.promise}).finally(function(){return $log.log("$indexedDB: "+dbName+" database deleted.")})},queryDirection:apiDirection,flush:function(){return allTransactions.length>0?$q.all(allTransactions):$q.when([])},databaseInfo:function(){return openDatabase().then(function(){var storeNames,transaction;return transaction=null,storeNames=Array.prototype.slice.apply(db.objectStoreNames),openTransaction(storeNames,dbMode.readonly).then(function(transaction){var store,storeName,stores;return stores=function(){var _i,_len,_results;for(_results=[],_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],store=transaction.objectStore(storeName),_results.push({name:storeName,keyPath:store.keyPath,autoIncrement:store.autoIncrement,indices:Array.prototype.slice.apply(store.indexNames)});return _results}(),transaction.promise.then(function(){return{name:db.name,version:db.version,objectStores:stores}})})})}}}]})}.call(this),function(){"use strict";function controller($scope,$mdDialog,ColorContext){function bold(){return document.execCommand("bold",!1,null),!1}function italic(){return document.execCommand("italic",!1,null),!1}function underlined(){return document.execCommand("underline",!1,null),!1}function strikeThrough(){return document.execCommand("strikeThrough",!1,null),!1}function foreColor(){var textColor=ColorContext.textColor;return document.execCommand("ForeColor",!1,textColor),!1}function hiliteColor(){var backgroundColor=ColorContext.backgroundColor;return document.execCommand("HiliteColor",!1,backgroundColor),!1}function justifyCenter(){return document.execCommand("justifyCenter",!1,null),!1}function justifyFull(){return document.execCommand("justifyFull",!1,null),!1}function justifyLeft(){return document.execCommand("justifyLeft",!1,null),!1}function justifyRight(){return document.execCommand("justifyRight",!1,null),!1}function removeFormat(){return document.execCommand("removeFormat",!1,null),!1}function openColors(){$mdDialog.show({templateUrl:"app/shared/text-edition-menu/color/color-picker-template.html",controller:"otus.textEdition.ColorController as controller",clickOutsideToClose:!0})}var self=this;self.bold=bold,self.italic=italic,self.underlined=underlined,self.strikeThrough=strikeThrough,self.openColors=openColors,self.foreColor=foreColor,self.hiliteColor=hiliteColor,self.justifyCenter=justifyCenter,self.justifyLeft=justifyLeft,self.justifyRight=justifyRight,self.justifyFull=justifyFull,self.removeFormat=removeFormat}angular.module("otus.textEdition").controller("otus.textEdition.TextEditionMenuController",controller),controller.$inject=["$scope","$mdDialog","otus.textEdition.ColorContext"]}(),function(){"use strict";function directive(){var ddo={templateUrl:"app/shared/text-edition-menu/text-edition-menu-template.html",retrict:"E",controller:"otus.textEdition.TextEditionMenuController as controller"};return ddo}angular.module("otus.textEdition").directive("otusTextEditionMenu",directive)}(),function(){"use strict";angular.module("otus.textEdition",["mdColorPicker"])}(),function(){angular.module("ui.components",[])}(),function(){"use strict";function LogoutDialogService($mdDialog){function init(){self.dialogSettings={parent:angular.element(document.body),templateUrl:"app/dashboard/dialog/logout/logout-dialog.html",controller:DialogController,controllerAs:"controller",openFrom:"#system-toolbar",closeTo:{bottom:0}}}function showDialog(){return $mdDialog.show(self.dialogSettings).then(forwardSuccessfulExecution,forwardUnsuccessfulExecution),{onConfirm:function(callback){self.callback=callback}}}function forwardSuccessfulExecution(response){"confirm"==response.action&&self.callback&&self.callback(response.data)}function forwardUnsuccessfulExecution(){}var self=this;self.showDialog=showDialog,init()}function DialogController($mdDialog){function cancel(response){$mdDialog.hide(response)}function confirm(response){$mdDialog.hide(response)}var self=this;self.cancel=cancel,self.confirm=confirm}angular.module("studio.dashboard").service("LogoutDialogService",LogoutDialogService),LogoutDialogService.$inject=["$mdDialog"]}(),function(){"use strict";function otusToolbar(){var ddo={templateUrl:"app/dashboard/menu/toolbar/menu-toolbar.html",retrict:"E"};return ddo}angular.module("studio.dashboard").directive("otusToolbar",otusToolbar)}(),function(){"use strict";function SelectedSurveyTemplatesManagementService(){function selectSurveyTemplate(template){self.selectedSurveyTemplates.push(template)}function removeSurveyTemplate(template){self.selectedSurveyTemplates.splice(_getSelectedTemplateIndex(template),1)}function hasSelectedSurveyTemplate(){return 0!==self.selectedSurveyTemplates.length}function hasOnlyOneSelectedSurveyTemplate(){return 1===self.selectedSurveyTemplates.length}function _getSelectedTemplateIndex(template){return self.selectedSurveyTemplates.indexOf(template)}var self=this;self.selectedSurveyTemplates=[],self.selectSurveyTemplate=selectSurveyTemplate,self.removeSurveyTemplate=removeSurveyTemplate,self.hasSelectedSurveyTemplate=hasSelectedSurveyTemplate,self.hasOnlyOneSelectedSurveyTemplate=hasOnlyOneSelectedSurveyTemplate}angular.module("surveyTemplates").service("SelectedSurveyTemplatesManagementService",SelectedSurveyTemplatesManagementService)}(),function(){"use strict";function SurveyTemplateManagerService(CrossSessionDatabaseService,SurveyExportService){function initializeSurveyTemplateList(){var promise=CrossSessionDatabaseService.getAllSurveyTemplatesByContributor();promise.then(function(value){self.surveyTemplates=value})}function deleteSurveyTemplate(template){CrossSessionDatabaseService.deleteSurveyTemplate(template.template_oid),_removeOfSurveyTemplatesList(template)}function exportSurveyTemplate(template){return SurveyExportService.exportSurvey(JSON.stringify(template.template))}function editSurveyTemplate(template){}function _getTemplateIndex(template){return self.surveyTemplates.indexOf(template)}function _removeOfSurveyTemplatesList(template){self.surveyTemplates.splice(_getTemplateIndex(template),1)}var self=this;self.surveyTemplates=[],self.initializeSurveyTemplateList=initializeSurveyTemplateList,self.deleteSurveyTemplate=deleteSurveyTemplate,self.exportSurveyTemplate=exportSurveyTemplate,self.editSurveyTemplate=editSurveyTemplate}angular.module("surveyTemplates").service("SurveyTemplateManagerService",SurveyTemplateManagerService),SurveyTemplateManagerService.$inject=["CrossSessionDatabaseService","SurveyExportService"]}(),function(){"use strict";function SurveyTemplateUpload(SurveyTemplateUploadService){function linkFunction($scope,$element,$attrs){function _uploadSurveyTemplate(fileToUpload){SurveyTemplateUploadService.upload(fileToUpload)}function _createInput(){return fileUploadElement=document.createElement("input"),fileUploadElement.setAttribute("type","file"),fileUploadElement.setAttribute("accept",".json"),fileUploadElement}var fileUploadElement;$element.on("click",function(){fileUploadElement=_createInput(),fileUploadElement.click(),fileUploadElement.addEventListener("change",function(){var fileToUpload=this.files[0];_uploadSurveyTemplate(fileToUpload)})})}var ddo={restrict:"A",link:linkFunction};return ddo}angular.module("surveyTemplates").directive("surveyTemplateUpload",SurveyTemplateUpload),SurveyTemplateUpload.$inject=["SurveyTemplateUploadService"]}(),function(){"use strict";function SurveyTemplateUploadService(CrossSessionDatabaseService,SurveyTemplateManagerService,$mdToast){function upload(fileSurveyTemplate){var reader=new FileReader;reader.readAsText(fileSurveyTemplate),reader.onload=function(){jsonReaded=reader.result;var promise=CrossSessionDatabaseService.insertSurveyTemplate(jsonReaded,{owner:"visitor"});promise.then(function(value){value&&$mdToast.show($mdToast.simple().textContent("Upload realizado com sucesso!"))},function(error){$mdToast.show($mdToast.simple().textContent(_getErrorMessage(error)))}),SurveyTemplateManagerService.initializeSurveyTemplateList()}}function _getErrorMessage(error){var message;switch(error){case"Key already exists in the object store.":message="Esse template já existe.";break;default:message="Ocorreu um erro ao realizar o upload"}return message}var jsonReaded,self=this;self.upload=upload}angular.module("surveyTemplates").service("SurveyTemplateUploadService",SurveyTemplateUploadService),SurveyTemplateUploadService.$inject=["CrossSessionDatabaseService","SurveyTemplateManagerService","$mdToast"]}(),function(){"use strict";function surveyTemplatesExport(SurveyTemplateManagerService,$mdToast,$timeout,SelectedSurveyTemplatesManagementService){var ddo={restrict:"A",link:function(scope,element){element.on("click",function(){SelectedSurveyTemplatesManagementService.selectedSurveyTemplates.forEach(function(template){var downloadElement=document.createElement("a");downloadElement.setAttribute("href",SurveyTemplateManagerService.exportSurveyTemplate(template)),downloadElement.setAttribute("download","surveyTemplate.json"),downloadElement.setAttribute("target","_blank"),downloadElement.click()}),$timeout(function(){$mdToast.show($mdToast.simple().textContent("Template(s) exportado(s) com sucesso!"))},1e3)})}};return ddo}angular.module("surveyTemplates").directive("surveyTemplatesExport",surveyTemplatesExport),surveyTemplatesExport.$inject=["SurveyTemplateManagerService","$mdToast","$timeout","SelectedSurveyTemplatesManagementService"]}(),function(){"use strict";function AddAnswerOptionEventFactory(AddAnswerOptionService,WorkspaceService){function create(){return new AddAnswerOptionEvent(AddAnswerOptionService,WorkspaceService)}var self=this;return self.create=create,self}function AddAnswerOptionEvent(AddAnswerOptionService,WorkspaceService){function execute(eventSource){var option=AddAnswerOptionService.execute(eventSource.getItem());return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),option}var self=this;self.execute=execute}angular.module("editor.core").factory("AddAnswerOptionEventFactory",AddAnswerOptionEventFactory),AddAnswerOptionEventFactory.$inject=["AddAnswerOptionService","WorkspaceService"]}(),function(){"use strict";function AddFillingRulesEventFactory(AddFillingRulesService,WorkspaceService){function create(){return new AddFillingRulesEvent(AddFillingRulesService,WorkspaceService)}var self=this;return self.create=create,self}function AddFillingRulesEvent(AddFillingRulesService,WorkspaceService){function execute(questionReference,validator){var option=AddFillingRulesService.execute(questionReference,validator);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),option}var self=this;self.execute=execute}angular.module("editor.core").factory("AddFillingRulesEventFactory",AddFillingRulesEventFactory),AddFillingRulesEventFactory.$inject=["AddFillingRulesService","WorkspaceService"]}(),function(){"use strict";function AddMetadataAnswerEventFactory(AddMetadataAnswerService,WorkspaceService){function create(){return new AddMetadataAnswerEvent(AddMetadataAnswerService,WorkspaceService)}var self=this;return self.create=create,self}function AddMetadataAnswerEvent(AddMetadataAnswerService,WorkspaceService){function execute(eventSource){var option=AddMetadataAnswerService.execute(eventSource.getItem());return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),option}var self=this;self.execute=execute}angular.module("editor.core").factory("AddMetadataAnswerEventFactory",AddMetadataAnswerEventFactory),AddMetadataAnswerEventFactory.$inject=["AddMetadataAnswerService","WorkspaceService"]}(),function(){"use strict";function AddRouteConditionEventFactory(AddRouteConditionService,WorkspaceService){function create(){return new AddRouteConditionEvent(AddRouteConditionService,WorkspaceService)}var self=this;return self.create=create,self}function AddRouteConditionEvent(AddRouteConditionService,WorkspaceService){function execute(conditionName,route){var routeCondition=AddRouteConditionService.execute(conditionName,route);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),routeCondition}var self=this;self.execute=execute}angular.module("editor.core").factory("AddRouteConditionEventFactory",AddRouteConditionEventFactory),AddRouteConditionEventFactory.$inject=["AddRouteConditionService","WorkspaceService"]}(),function(){"use strict";function AddRouteEventFactory(AddRouteService,WorkspaceService){function create(){return new AddRouteEvent(AddRouteService,WorkspaceService)}var self=this;return self.create=create,self}function AddRouteEvent(AddRouteService,WorkspaceService){function execute(routeData){var route=AddRouteService.execute(routeData);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),route}var self=this;self.execute=execute}angular.module("editor.core").factory("AddRouteEventFactory",AddRouteEventFactory),AddRouteEventFactory.$inject=["AddRouteService","WorkspaceService"]}(),function(){"use strict";function AddRuleEventFactory(AddRuleService,WorkspaceService){function create(){return new AddRuleEvent(AddRuleService,WorkspaceService)}var self=this;return self.create=create,self}function AddRuleEvent(AddRuleService,WorkspaceService){function execute(ruleData,route){var rule=AddRuleService.execute(ruleData,route);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),rule}var self=this;self.execute=execute}angular.module("editor.core").factory("AddRuleEventFactory",AddRuleEventFactory),AddRuleEventFactory.$inject=["AddRuleService","WorkspaceService"]}(),function(){"use strict";function AddSurveyItemEventFactory($rootScope,WorkspaceService,WidgetService,SheetContentService,AddSurveyItemService,PageAnchorService,$timeout){function create(){return new AddSurveyItemEvent($rootScope,WorkspaceService,WidgetService,SheetContentService,AddSurveyItemService,PageAnchorService,$timeout)}var self=this;return self.create=create,self}function AddSurveyItemEvent($rootScope,WorkspaceService,WidgetService,SheetContentService,AddSurveyItemService,PageAnchorService,$timeout){function execute(itemType){var item=AddSurveyItemService.execute(itemType,WorkspaceService.getSurvey());SheetContentService.loadQuestion(item),$rootScope.$broadcast("item.add",item),WorkspaceService.workspace.currentItem=item,WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}function load(itemToLoad){var newItem=AddSurveyItemService.execute(itemToLoad.objectType,WorkspaceService.getSurvey());itemToLoad.customID?newItem.customID=itemToLoad.customID:newItem.customID=newItem.templateID,newItem.isQuestion()?(newItem.label=itemToLoad.label,newItem.metadata.options=itemToLoad.metadata.options,newItem.fillingRules.options=itemToLoad.fillingRules.options,"SingleSelectionQuestion"!==itemToLoad.objectType&&"CheckboxQuestion"!==itemToLoad.objectType||(newItem.options=itemToLoad.options),"DecimalQuestion"!==itemToLoad.objectType&&"IntegerQuestion"!==itemToLoad.objectType||(newItem.unit=itemToLoad.unit)):"ImageItem"===itemToLoad.objectType?(newItem.url=itemToLoad.url,newItem.footer=itemToLoad.footer):newItem.value=itemToLoad.value,SheetContentService.loadQuestion(newItem),$rootScope.$broadcast("item.add",newItem),WorkspaceService.workspace.currentItem=newItem}var self=this;self.execute=execute,self.load=load}angular.module("editor.core").factory("AddSurveyItemEventFactory",AddSurveyItemEventFactory),AddSurveyItemEventFactory.$inject=["$rootScope","WorkspaceService","WidgetService","SheetContentService","AddSurveyItemService","PageAnchorService","$timeout"]}(),function(){"use strict";function RemoveAnswerOptionEventFactory(RemoveAnswerOptionService,WorkspaceService){function create(){return new RemoveAnswerOptionEvent(RemoveAnswerOptionService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveAnswerOptionEvent(RemoveAnswerOptionService,WorkspaceService){function execute(eventSource){RemoveAnswerOptionService.execute(eventSource.getItem()),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveAnswerOptionEventFactory",RemoveAnswerOptionEventFactory),RemoveAnswerOptionEventFactory.$inject=["RemoveAnswerOptionService","WorkspaceService"]}(),function(){"use strict";function RemoveFillingRulesEventFactory(RemoveFillingRulesWorkService,WorkspaceService){function create(){return new RemoveFillingRulesEvent(RemoveFillingRulesWorkService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveFillingRulesEvent(RemoveFillingRulesWorkService,WorkspaceService){function execute(questionSource,fillingRuleType){RemoveFillingRulesWorkService.execute(questionSource.getItem(),fillingRuleType),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveFillingRulesEventFactory",RemoveFillingRulesEventFactory),RemoveFillingRulesEventFactory.$inject=["RemoveFillingRulesWorkService","WorkspaceService"]}(),function(){"use strict";function RemoveMetadataOptionEventFactory(RemoveMetadataOptionService,WorkspaceService){function create(){return new RemoveMetadataOptionEvent(RemoveMetadataOptionService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveMetadataOptionEvent(RemoveMetadataOptionService,WorkspaceService){function execute(eventSource){RemoveMetadataOptionService.execute(eventSource.getItem()),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveMetadataOptionEventFactory",RemoveMetadataOptionEventFactory),RemoveMetadataOptionEventFactory.$inject=["RemoveMetadataOptionService","WorkspaceService"]}(),function(){"use strict";function RemoveRouteEventFactory(RemoveRouteService,WorkspaceService){function create(){return new RemoveRouteEvent(RemoveRouteService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveRouteEvent(RemoveRouteService,WorkspaceService){function execute(routeData){RemoveRouteService.execute(routeData),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveRouteEventFactory",RemoveRouteEventFactory),RemoveRouteEventFactory.$inject=["RemoveRouteService","WorkspaceService"]}(),function(){"use strict";function RemoveRuleEventFactory(RemoveRuleService,WorkspaceService){function create(){return new RemoveRuleEvent(RemoveRuleService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveRuleEvent(RemoveRuleService,WorkspaceService){function execute(rule,route){RemoveRuleService.execute(rule,route),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveRuleEventFactory",RemoveRuleEventFactory),RemoveRuleEventFactory.$inject=["RemoveRuleService","WorkspaceService"]}(),function(){"use strict";function RemoveSurveyItemEventFactory($rootScope,WorkspaceService,RemoveSurveyItemService){function create(){return new RemoveSurveyItemEvent($rootScope,WorkspaceService,RemoveSurveyItemService)}var self=this;return self.create=create,self}function RemoveSurveyItemEvent($rootScope,WorkspaceService,RemoveSurveyItemService){function execute(item){RemoveSurveyItemService.execute(item,WorkspaceService.getSurvey()),$rootScope.$broadcast("item.remove."+item.templateID,item),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveSurveyItemEventFactory",RemoveSurveyItemEventFactory),RemoveSurveyItemEventFactory.$inject=["$rootScope","WorkspaceService","RemoveSurveyItemService"]}(),function(){"use strict";function UpdateFillingRulesEventFactory(WorkspaceService){function create(){return new UpdateFillingRulesEvent(WorkspaceService)}var self=this;return self.create=create,self}function UpdateFillingRulesEvent(WorkspaceService){function execute(){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateFillingRulesEventFactory",UpdateFillingRulesEventFactory),UpdateFillingRulesEventFactory.$inject=["WorkspaceService"]}(),function(){"use strict";function UpdateQuestionEventFactory(WorkspaceService){function create(){return new UpdateQuestionEvent(WorkspaceService)}var self=this;return self.create=create,self}function UpdateQuestionEvent(WorkspaceService){function execute(data){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateQuestionEventFactory",UpdateQuestionEventFactory),UpdateQuestionEventFactory.$inject=["WorkspaceService"]}(),function(){"use strict";function UpdateRouteEventFactory(WorkspaceService){function create(){return new UpdateRouteEvent(WorkspaceService)}var self=this;return self.create=create,self}function UpdateRouteEvent(WorkspaceService){function execute(eventSource){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateRouteEventFactory",UpdateRouteEventFactory),UpdateRouteEventFactory.$inject=["WorkspaceService"]}(),function(){"use strict";function UpdateRuleEventFactory(WorkspaceService){function create(){return new UpdateRuleEvent(WorkspaceService)}var self=this;return self.create=create,self}function UpdateRuleEvent(WorkspaceService){function execute(eventSource){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateRuleEventFactory",UpdateRuleEventFactory),UpdateRuleEventFactory.$inject=["WorkspaceService"]}(),function(){"use strict";function CrossSessionDatabaseService($q,$indexedDB,InsertHelperService){function saveSurveyTemplateRevision(template,session){$indexedDB.openStore(STORE_NAME,function(store){var entry={};entry.template_oid=template.oid,entry.contributor=session.owner,entry.template=JSON.parse(template.toJson()),store.upsert(entry).then(function(e){})})}function insertSurveyTemplate(template,session){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){var parsedTemplate=JSON.parse(template),entry={};entry.template_oid=parsedTemplate.oid,entry.contributor=session.owner,entry.template=parsedTemplate,store.insert(entry).then(function(success){defer.resolve(success)},function(error){defer.reject(error)})}),defer.promise}function getAllSurveyTemplates(){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){store.getAll().then(function(templates){defer.resolve(templates)})}),defer.promise}function getAllSurveyTemplatesByContributor(){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){var criteria=store.query();criteria=criteria.$eq("visitor"),criteria=criteria.$index(INDEX),store.eachWhere(criteria).then(function(templates){defer.resolve(templates)})}),defer.promise}function deleteSurveyTemplate(templateOID){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){store.delete(templateOID).then(function(){defer.resolve(!0)})}),defer.promise}function findSurveyTemplateByOID(oid){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){store.find(oid).then(function(template){defer.resolve(template)})}),defer.promise}var self=this,STORE_NAME="survey_template",INDEX="contributor_idx";self.saveSurveyTemplateRevision=saveSurveyTemplateRevision,self.getAllSurveyTemplates=getAllSurveyTemplates,self.getAllSurveyTemplatesByContributor=getAllSurveyTemplatesByContributor,self.deleteSurveyTemplate=deleteSurveyTemplate,self.insertSurveyTemplate=insertSurveyTemplate,self.findSurveyTemplateByOID=findSurveyTemplateByOID}angular.module("editor.database").service("CrossSessionDatabaseService",CrossSessionDatabaseService),CrossSessionDatabaseService.$inject=["$q","$indexedDB","InsertHelperService"]}(),function(){"use strict";function InsertHelperService(){function cloneObject(object){var clone={};return Object.keys(object).forEach(function(key){var property=object[key];property instanceof Function&&(clone[key]=property)}),clone}var self=this;self.cloneObject=cloneObject}angular.module("editor.database").service("InsertHelperService",InsertHelperService)}(),function(){"use strict";function InSessionDatabaseFactory(Loki){function create(){return new InSessionDatabase(Loki)}var self=this;return self.create=create,self}function InSessionDatabase(Loki){function init(){instance=new Loki("in-session-db.json"),self[USER_EDITS_COLLECTION]=new CollectionFacade(instance.addCollection(USER_EDITS_COLLECTION)),self[DATA_POOL_COLLECTION]=new CollectionFacade(instance.addCollection(DATA_POOL_COLLECTION))}var self=this,instance=null,USER_EDITS_COLLECTION="userEdits",DATA_POOL_COLLECTION="dataPool";init()}function CollectionFacade(collectionReference){function init(){Object.defineProperty(self,"collection",{value:collectionReference,writable:!1})}function store(data){self.collection.insert(data)}function storeUnique(data){var event=fetchEventBy("id",data.source.id);event?(remove(event),store(data)):self.collection.insert(data)}function fetchEventBy(attribute,value){var data=self.collection.chain().where(function(obj){return getModelValue(attribute,obj)===value}).simplesort("$loki","isdesc").data();return data}function fetchLastSelectEvent(){var data=self.collection.chain().where(function(event){return event.type.isSelectData()}).simplesort("$loki","isdesc").data();return data[0]}function fetchLastAddedData(){var data=self.collection.chain().simplesort("$loki","isdesc").data();return data[0]}function remove(data){self.collection.remove(data)}function getModelValue(modelpath,model){var pathArray=modelpath.split("."),modelValue=model;return pathArray.forEach(function(path){modelValue=modelValue[path]}),modelValue}var self=this;self.store=store,self.fetchEventBy=fetchEventBy,self.fetchLastSelectEvent=fetchLastSelectEvent,self.fetchLastAddedData=fetchLastAddedData,self.storeUnique=storeUnique,init()}angular.module("editor.database").factory("InSessionDatabaseFactory",InSessionDatabaseFactory),InSessionDatabaseFactory.$inject=["Loki"]}(),function(){"use strict";function mpath(){function getWidgetPath(directive){return MODULE.concat("core/question/".concat(directive).concat("/".concat(directive.concat("-question-template.html"))))}function getQuestionEditorWidgetPath(){return QUESTION_EDITOR_TEMPLATE}function getMetadataWidgetPath(){return METADATA_TEMPLATE}var self=this,MODULE="app/editor/ui/",QUESTION_EDITOR_TEMPLATE="app/editor/ui/core/survey-item-editor/survey-item-editor.html",METADATA_TEMPLATE="app/editor/ui/core/metadata/metadata-question-template.html";self.getWidgetPath=getWidgetPath,self.getQuestionEditorWidgetPath=getQuestionEditorWidgetPath,self.getMetadataWidgetPath=getMetadataWidgetPath}angular.module("editor.ui").service("editor.ui.mpath",mpath)}(),function(){"use strict";function UiBindingService(){function setScope(scope){scope.$on("otusWidgetPreLoad",function(event){}),scope.$on("otusWidgetBinding",function(event){})}var self=this;self.setScope=setScope}angular.module("editor.ui").service("UiBindingService",UiBindingService)}(),function(){"use strict";function WidgetService(WidgetTemplateService,SurveyItemWidgetFactory,SurveyItemEditorWidgetFactory,AnswerOptionWidgetFactory,MetadataGroupWidgetFactory,MetadataOptionWidgetFactory){function getWidgetForModel(model){
var widget=SurveyItemWidgetFactory.create(model);return widget.template=WidgetTemplateService.getDirectiveTemplate(model.objectType),widget}function getMetadataWidget(model){var widget=MetadataGroupWidgetFactory.create(model);return widget.template=WidgetTemplateService.getDirectiveTemplate("MetadataGroup"),widget}function getSurveyItemEditorWidget(question){return SurveyItemEditorWidgetFactory.create(question)}function getQuestionAnswerOptionWidget(model){return AnswerOptionWidgetFactory.create(model)}function getMetadataAnswerOptionWidget(model){return MetadataOptionWidgetFactory.create(model)}var self=this;self.widgetMap={},self.getWidgetForModel=getWidgetForModel,self.getMetadataWidget=getMetadataWidget,self.getSurveyItemEditorWidget=getSurveyItemEditorWidget,self.getQuestionAnswerOptionWidget=getQuestionAnswerOptionWidget,self.getMetadataAnswerOptionWidget=getMetadataAnswerOptionWidget}angular.module("editor.ui").service("WidgetService",WidgetService),WidgetService.$inject=["WidgetTemplateService","SurveyItemWidgetFactory","SurveyItemEditorWidgetFactory","AnswerOptionWidgetFactory","MetadataGroupWidgetFactory","MetadataOptionWidgetFactory"]}(),function(){"use strict";function WidgetTemplateService(){function getDirectiveTemplate(directive){return directiveTemplates[directive]}var self=this,directiveTemplates={CalendarQuestion:"<calendar-question></calendar-question>",IntegerQuestion:"<integer-question></integer-question>",SingleSelectionQuestion:"<single-selection-question></single-selection-question>",TextQuestion:"<text-question></text-question>",TimeQuestion:"<time-question></time-question>",PhoneQuestion:"<phone-question></phone-question>",CheckboxQuestion:"<checkbox-question></checkbox-question>",MetadataGroup:"<metadata-question></metadata-question>"};self.getDirectiveTemplate=getDirectiveTemplate}angular.module("editor.ui").service("WidgetTemplateService",WidgetTemplateService)}(),function(){function EditorToolbarController(WorkspaceService){function saveOfflineWork(){WorkspaceService.saveWork()}function isSurveyEmpty(){return 0===WorkspaceService.getSurvey().SurveyItemManager.getItemListSize()}var self=this;self.saveOfflineWork=saveOfflineWork,self.isSurveyEmpty=isSurveyEmpty}angular.module("editor.ui").controller("EditorToolbarController",EditorToolbarController),EditorToolbarController.$inject=["WorkspaceService"]}(),function(){"use strict";function MainContainerContentService(){function init(cotroller){controllerReference=cotroller}function showQuestionDataEditor(data){}var self=this,controllerReference=null;self.showQuestionDataEditor=showQuestionDataEditor,self.init=init}angular.module("editor.ui").service("MainContainerContentService",MainContainerContentService)}(),function(){function MainContainerController($scope,$window,MainContainerContentService,UiBindingService,$mdBottomSheet,NavigationBuilderService,NavigationBuilderScopeService,WorkspaceService,NBEVENTS){function init(){MainContainerContentService.init(self),UiBindingService.setScope($scope)}function showQuestionsMenu(){$mdBottomSheet.show({templateUrl:"app/editor/ui/survey-item-palette/bottom-sheet.html",disableParentScroll:!1})}function startNavigationBuilder(){var $navContainer=$("#navigation-preview-container"),$tabContainer=$navContainer.parent().parent().parent();$navContainer.css("margin-top","10px"),$navContainer.css("height",$tabContainer.height()-10+"px"),$window.addEventListener("resize",function(){$navContainer.css("height",$tabContainer.height()-10+"px")}),NavigationBuilderService.setSurvey(WorkspaceService.getSurvey()),NavigationBuilderScopeService.broadcast(NBEVENTS.MAP_CONTAINER_READY)}var self=this;self.showQuestionsMenu=showQuestionsMenu,self.startNavigationBuilder=startNavigationBuilder,init()}angular.module("editor.ui").controller("MainContainerController",MainContainerController),MainContainerController.$inject=["$scope","$window","MainContainerContentService","UiBindingService","$mdBottomSheet","otusjs.studio.navigationBuilder.NavigationBuilderService","otusjs.studio.navigationBuilder.NavigationBuilderScopeService","WorkspaceService","NBEVENTS"]}(),function(){"use strict";function AnchorController($element,PageAnchorService){var self=this;self.$onInit=function(){$element.attr("tabindex",-1),PageAnchorService.anchorRegistry($element)}}angular.module("editor.ui").component("otusPageAnchor",{templateUrl:"app/editor/ui/page-anchor-item/page-anchor-template.html",controller:AnchorController,bindings:{id:"<"}}),AnchorController.$inject=["$element","PageAnchorService"]}(),function(){function PageAnchorService(){function anchorRegistry(anchorElement){anchorList[anchorElement[0].id]=anchorElement}function sheetAutoFocus(sheet){var childrenNb=sheet.children().length;childrenNb>6?_focusOnBottom():_focusOnTop()}function _focusOnTop(){anchorList["top-anchor"]&&anchorList["top-anchor"].focus()}function _focusOnBottom(){anchorList["bottom-anchor"]&&anchorList["bottom-anchor"].focus()}var self=this,anchorList={};self.sheetAutoFocus=sheetAutoFocus,self.anchorRegistry=anchorRegistry}angular.module("editor.ui").service("PageAnchorService",PageAnchorService)}(),function(){"use strict";function otusSheet(){var ddo={restrict:"E",controller:"SheetController",controllerAs:"sheetController",templateUrl:"app/editor/ui/sheet/sheet.html"};return ddo}angular.module("editor.ui").directive("otusEditionSheet",otusSheet)}(),function(){"use strict";function SheetContentService(TemplateLoaderService,PageAnchorService,$q,$timeout){function init(scopeReference,sheetReference){scope=scopeReference,sheet=sheetReference}function loadQuestion(item){self.lastLoadedQuestion=item;var content=TemplateLoaderService.loadDirective("<otus:survey-item-editor></otus:survey-item-editor>",scope),sheetTemplate=sheet.find("#sheet").append(content);PageAnchorService.sheetAutoFocus(sheetTemplate)}function loadItem(item){self.lastLoadedQuestion=item;var content=TemplateLoaderService.loadDirective("<otus:page-item-editor></otus:page-item-editor>",scope);sheet.find("#sheet").append(content),PageAnchorService.sheetAutoFocus(sheetTemplate)}function unloadQuestion(question){sheet.find('[question-target="'+question.templateID+'"]').remove()}function updateQuestion(question){var target='[es-id="question-editor-'+question.templateID+'-label"]',label=UIUtils.jq(sheet.find(target)[0]);label.text(question.label.ptBR.plainText)}var self=this,scope=null,sheet=null;self.init=init,self.loadQuestion=loadQuestion,self.loadItem=loadItem,self.unloadQuestion=unloadQuestion,self.updateQuestion=updateQuestion}angular.module("editor.ui").service("SheetContentService",SheetContentService),SheetContentService.$inject=["TemplateLoaderService","PageAnchorService"]}(),function(){"use strict";function SheetController($scope,$element,SheetContentService,EditionPreviewService,WorkspaceService,$window){function _init(){EditionPreviewService.isLoadingMode()?(EditionPreviewService.setScope($scope),EditionPreviewService.loadSurveyTemplate().then(function(template){EditionPreviewService.isLoading=!1,WorkspaceService.getSurvey().NavigationManager.loadJsonData(template.navigationList)})):$window.sessionStorage.setItem("surveyTemplate_OID",WorkspaceService.getSurvey().oid)}var self=this;self.EditionPreviewService=EditionPreviewService,SheetContentService.init($scope,$element),_init(),$scope.$on("$destroy",function(){WorkspaceService.closeWork(),$window.sessionStorage.removeItem("surveyTemplate_OID")})}angular.module("editor.ui").controller("SheetController",SheetController),SheetController.$inject=["$scope","$element","SheetContentService","EditionPreviewService","WorkspaceService","$window"]}(),function(){"use strict";function otusStage(){var ddo={restrict:"E",templateUrl:"app/editor/ui/stage/stage.html"};return ddo}angular.module("editor.ui").directive("otusStage",otusStage)}(),function(){"use strict";function SurveyItemWidgetFactory(CalendarQuestionWidgetFactory,IntegerQuestionWidgetFactory,DecimalQuestionWidgetFactory,SingleSelectionQuestionWidgetFactory,CheckboxQuestionWidgetFactory,TextQuestionWidgetFactory,TimeQuestionWidgetFactory,EmailQuestionWidgetFactory,PhoneQuestionWidgetFactory,TextItemWidgetFactory,ImageItemWidgetFactory){function create(scope,element,item){return widgetFactories[item.objectType].create(scope,element,item)}var self=this,widgetFactories={CalendarQuestion:CalendarQuestionWidgetFactory,IntegerQuestion:IntegerQuestionWidgetFactory,DecimalQuestion:DecimalQuestionWidgetFactory,SingleSelectionQuestion:SingleSelectionQuestionWidgetFactory,CheckboxQuestion:CheckboxQuestionWidgetFactory,TextQuestion:TextQuestionWidgetFactory,TimeQuestion:TimeQuestionWidgetFactory,EmailQuestion:EmailQuestionWidgetFactory,PhoneQuestion:PhoneQuestionWidgetFactory,TextItem:TextItemWidgetFactory,ImageItem:ImageItemWidgetFactory};return self.create=create,self}angular.module("editor.ui").factory("SurveyItemWidgetFactory",SurveyItemWidgetFactory),SurveyItemWidgetFactory.$inject=["CalendarQuestionWidgetFactory","IntegerQuestionWidgetFactory","DecimalQuestionWidgetFactory","SingleSelectionQuestionWidgetFactory","CheckboxQuestionWidgetFactory","TextQuestionWidgetFactory","TimeQuestionWidgetFactory","EmailQuestionWidgetFactory","PhoneQuestionWidgetFactory","TextItemWidgetFactory","ImageItemWidgetFactory"]}(),function(){"use strict";function directive(SurveyItemEditorWidgetFactory,SheetContentService,UUIDService,PageAnchorService){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item-editor/survey-item-editor.html",retrict:"E",link:function(scope,element,attrs){scope.uuid=UUIDService.generateUUID(),scope.widget=SurveyItemEditorWidgetFactory.create(scope,element,SheetContentService.lastLoadedQuestion)}};return ddo}angular.module("editor.ui").directive("otusSurveyItemEditor",directive),directive.$inject=["SurveyItemEditorWidgetFactory","SheetContentService","UUIDService","PageAnchorService"]}(),function(){"use strict";function SurveyItemEditorWidgetFactory(RemoveSurveyItemEventFactory){function create(scope,element,item){return new SurveyItemEditorWidget(scope,element,item,RemoveSurveyItemEventFactory)}var self=this;return self.create=create,self}function SurveyItemEditorWidget(scope,element,item,RemoveSurveyItemEventFactory){function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return item}function getQuestionId(){return getItem().templateID}function getContainer(){return item.isQuestion()?"<otus:question-item></otus:question-item>":"<misc-item></misc-item>"}function deleteSurveyItem(){RemoveSurveyItemEventFactory.create().execute(item),element.remove()}var self=this;self.className="SurveyItemEditorWidget",self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getContainer=getContainer,self.deleteSurveyItem=deleteSurveyItem,self.getQuestionId=getQuestionId}angular.module("editor.ui").factory("SurveyItemEditorWidgetFactory",SurveyItemEditorWidgetFactory),SurveyItemEditorWidgetFactory.$inject=["RemoveSurveyItemEventFactory"]}(),function(){"use strict";function directive(OtusSurveyItemPaletteWidgetFactory){var ddo={scope:{label:"@",ariaLabel:"@",leftIcon:"@"},transclude:!0,templateUrl:"app/editor/ui/survey-item-palette/survey-item-palette.html",retrict:"E",link:function(scope){scope.widget=OtusSurveyItemPaletteWidgetFactory.create(scope.$parent.widget)}};return ddo}angular.module("editor.ui").directive("otusSurveyItemPalette",directive),directive.$inject=["OtusSurveyItemPaletteWidgetFactory"]}(),function(){"use strict";function OtusSurveyItemPaletteWidgetFactory(AddSurveyItemEventFactory){function create(parentWidget){return new OtusQuestionPaletteWidget(parentWidget,AddSurveyItemEventFactory)}var self=this;return self.create=create,self}function OtusQuestionPaletteWidget(parentWidget,AddSurveyItemEventFactory){function addCalendarQuestion(){AddSurveyItemEventFactory.create().execute("CalendarQuestion")}function addIntegerQuestion(){AddSurveyItemEventFactory.create().execute("IntegerQuestion")}function addDecimalQuestion(){AddSurveyItemEventFactory.create().execute("DecimalQuestion")}function addSingleSelectionQuestion(){AddSurveyItemEventFactory.create().execute("SingleSelectionQuestion")}function addTextQuestion(){AddSurveyItemEventFactory.create().execute("TextQuestion")}function addTimeQuestion(){AddSurveyItemEventFactory.create().execute("TimeQuestion")}function addEmailQuestion(){AddSurveyItemEventFactory.create().execute("EmailQuestion")}function addTextItem(){AddSurveyItemEventFactory.create().execute("TextItem")}function addImageItem(){AddSurveyItemEventFactory.create().execute("ImageItem")}function addPhoneQuestion(){AddSurveyItemEventFactory.create().execute("PhoneQuestion")}function addCheckboxQuestion(){AddSurveyItemEventFactory.create().execute("CheckboxQuestion")}var self=this;self.className=self.constructor.name,self.parent=parentWidget,self.addCalendarQuestion=addCalendarQuestion,self.addIntegerQuestion=addIntegerQuestion,self.addDecimalQuestion=addDecimalQuestion,self.addSingleSelectionQuestion=addSingleSelectionQuestion,self.addTextQuestion=addTextQuestion,self.addTimeQuestion=addTimeQuestion,self.addEmailQuestion=addEmailQuestion,self.addTextItem=addTextItem,self.addImageItem=addImageItem,self.addPhoneQuestion=addPhoneQuestion,self.addCheckboxQuestion=addCheckboxQuestion}angular.module("editor.ui").factory("OtusSurveyItemPaletteWidgetFactory",OtusSurveyItemPaletteWidgetFactory),OtusSurveyItemPaletteWidgetFactory.$inject=["AddSurveyItemEventFactory"]}(),function(){"use strict";angular.module("editor.ui").component("otusSurveyTemplateHeader",{templateUrl:"app/editor/ui/survey-template-header/survey-template-header-template.html",controller:function(WorkspaceService){var self=this;self.name="",self.acronym="",self.identity={},self.$onInit=function(){self.identity=WorkspaceService.getSurvey().identity,self.name=self.identity.name,self.acronym=self.identity.acronym}}})}(),function(){"use strict";function TemplateLoaderService($compile,$templateRequest,$templateCache){function load(templateUrl,scope,callback){$templateRequest(templateUrl).then(function(html){var compiledTemplate=compileTemplate(html,scope);callback&&callback(compiledTemplate)})}function loadDirective(html,scope){return $compile(html)(scope)}function compileTemplate(html,scope){return $compile(html)(scope)}var self=this;self.load=load,self.loadDirective=loadDirective}angular.module("editor.ui").service("TemplateLoaderService",TemplateLoaderService),TemplateLoaderService.$inject=["$compile","$templateRequest","$templateCache"]}(),function(){"use strict";function OtusFillingRulesWidgetFactory(){function create(validator){return validatorsTemplates[validator]}var self=this;self.create=create;var validatorsTemplates={alphanumeric:"<otus:alphanumeric-validator></otus:alphanumeric-validator>",distinct:"<otus:distinct-validator></otus:distinct-validator>",futureDate:"<otus:future-date-validator></otus:future-date-validator>",in:"<otus:in-validator></otus:in-validator>",lowerLimit:"<otus:lower-limit-validator></otus:lower-limit-validator>",lowerCase:"<otus:lower-case-validator></otus:lower-case-validator>",mandatory:"<otus:mandatory-validator></otus:mandatory-validator>",maxDate:"<otus:max-date-validator></otus:max-date-validator>",maxLength:"<otus:max-length-validator></otus:max-length-validator>",maxTime:"<otus:max-time-validator></otus:max-time-validator>",minDate:"<otus:min-date-validator></otus:min-date-validator>",minLength:"<otus:min-length-validator></otus:min-length-validator>",minTime:"<otus:min-time-validator></otus:min-time-validator>",parameter:"<otus:parameter-validator></otus:parameter-validator>",pastDate:"<otus:past-date-validator></otus:past-date-validator>",precision:"<otus:precision-validator></otus:precision-validator>",rangeDate:"<otus:range-date-validator></otus:range-date-validator>",scale:"<otus:scale-validator></otus:scale-validator>",specials:"<otus:specials-validator></otus:specials-validator>",upperCase:"<otus:upper-case-validator></otus:upper-case-validator>",upperLimit:"<otus:upper-limit-validator></otus:upper-limit-validator>"};return self}angular.module("editor.ui").factory("OtusFillingRulesWidgetFactory",OtusFillingRulesWidgetFactory)}(),function(){"use strict";function SurveyLoaderService(ModelFacadeService){function newSurvey(name,acronym,version){return ModelFacadeService.getSurveyFactory().create(name,acronym)}function loadSurvey(surveyTemplate){return ModelFacadeService.getSurveyFactory().load(surveyTemplate)}var self=this;self.newSurvey=newSurvey,self.loadSurvey=loadSurvey}angular.module("editor.workspace").service("SurveyLoaderService",SurveyLoaderService),SurveyLoaderService.$inject=["ModelFacadeService"]}(),function(){"use strict";function WorkspaceFactory(InSessionDatabaseFactory){function create(workSession){var inSessionDatabase=InSessionDatabaseFactory.create();return new Workspace(workSession,inSessionDatabase)}var self=this;return self.create=create,self}function Workspace(workSession,inSessionDatabase){function init(){self.isdb=inSessionDatabase,self.sessions={workspaceOwner:workSession}}function importProject(projectToImport){Object.defineProperty(self,"project",{value:projectToImport,writable:!1})}function attachWorkeSession(workSession){self.sessions[workSession.owner.username]=workSession}function loadProjectConfiguration(){}var self=this;self.importProject=importProject,self.attachWorkeSession=attachWorkeSession,self.loadProjectConfiguration=loadProjectConfiguration,init()}angular.module("editor.workspace").factory("WorkspaceFactory",WorkspaceFactory),WorkspaceFactory.$inject=["InSessionDatabaseFactory"]}(),function(){"use strict";function WorkspaceService(WorkspaceFactory,SurveyProjectFactory,SurveyLoaderService,CrossSessionDatabaseService,SurveyExportService){function initializeWorkspace(ownerWorkSession){self.workspace=WorkspaceFactory.create(ownerWorkSession),questionIdCounter=-1,notifyObservers({type:"NEW_PROJECT"})}function startNewWork(initializationData){var survey=SurveyLoaderService.newSurvey(initializationData.name,initializationData.acronym.toUpperCase(),initializationData.version);importProject(SurveyProjectFactory.create(survey,self.workspace.sessions.workspaceOwner))}function loadWork(surveyTemplate){var survey=SurveyLoaderService.loadSurvey(surveyTemplate);importProject(SurveyProjectFactory.create(survey,self.workspace.sessions.workspaceOwner))}function closeWork(){saveWork(),self.workspace.project.close("now"),questionIdCounter=-1,observers=[],self.workspace=void 0}function saveWork(){CrossSessionDatabaseService.saveSurveyTemplateRevision(self.workspace.project.survey,self.workspace.sessions.workspaceOwner)}function exportWork(){return SurveyExportService.exportSurvey(self.workspace.project.survey.toJson())}function getQuestionId(){return++questionIdCounter}function getSurvey(){return self.workspace.project.survey}function importProject(project){self.workspace.importProject(project),self.workspace.loadProjectConfiguration()}function notifyObservers(update){observers.forEach(function(observer){observer.update(update)})}function registerObserver(observer){observers.push(observer)}var self=this,questionIdCounter=-1,observers=[];self.initializeWorkspace=initializeWorkspace,self.startNewWork=startNewWork,self.loadWork=loadWork,self.closeWork=closeWork,self.saveWork=saveWork,self.getQuestionId=getQuestionId,self.exportWork=exportWork,self.getSurvey=getSurvey,self.registerObserver=registerObserver}angular.module("editor.workspace").service("WorkspaceService",WorkspaceService),WorkspaceService.$inject=["WorkspaceFactory","SurveyProjectFactory","SurveyLoaderService","CrossSessionDatabaseService","SurveyExportService"]}(),function(){"use strict";function surveyTemplateExport(WorkspaceService){var ddo={restrict:"A",link:function(scope,element){element.on("click",function(){var downloadElement=document.createElement("a");downloadElement.setAttribute("href",WorkspaceService.exportWork()),downloadElement.setAttribute("download","surveyTemplate.json"),downloadElement.setAttribute("target","_blank"),downloadElement.click()})}};return ddo}angular.module("editor.workspace").directive("surveyTemplateExport",surveyTemplateExport),surveyTemplateExport.$inject=["WorkspaceService"]}(),function(){"use strict";function SurveyExportService(){function exportSurvey(JsonTemplate){return"data:text/json;charset=utf-8,"+encodeURIComponent(JsonTemplate)}var self=this;self.exportSurvey=exportSurvey}angular.module("editor.workspace").service("SurveyExportService",SurveyExportService)}(),function(){"use strict";function SurveyProjectFactory(){function create(survey,author){return new SurveyProject(survey,author)}var self=this;return self.create=create,self}function SurveyProject(survey,author){function addContributor(contributor){contributors.push(contributor)}function removeContributor(contributor){var indexToRemove=contributors.indexOf(contributor);contributors=contributors.slice(indexToRemove,1)}function listContributors(){return contributors}function close(lastSaveDateTime){Object.defineProperty(self,"lastSaveDateTime",{value:lastSaveDateTime,writable:!1})}var self=this;self.configuration={};var contributors=[];Object.defineProperty(this,"survey",{value:survey,writable:!1}),Object.defineProperty(this,"creationDateTime",{value:Date.now(),writable:!1}),Object.defineProperty(this,"author",{value:author,writable:!1}),self.addContributor=addContributor,self.removeContributor=removeContributor,self.listContributors=listContributors,self.close=close}angular.module("editor.workspace").factory("SurveyProjectFactory",SurveyProjectFactory)}(),function(){"use strict";function EditingWorkFactory(){function create(){return new EditingWork}var self=this;return self.create=create,self}function EditingWork(){var self=this;self.survey=null,self.creationDateTime=null,self.author=null,self.contributors=null,self.isPublished=null,self.isSincronized=null,self.isLocallyPersisted=null}angular.module("editor.workspace").factory("EditingWorkFactory",EditingWorkFactory)}(),function(){"use strict";function EditingWorkService(){var self=this;self.startNewWork=startNewWork,self.loadWork=loadWork}angular.module("editor.workspace").factory("EditingWorkService",EditingWorkService)}(),function(){"use strict";function component($scope,scopeService){function onInit(){scopeService.onEvent(scopeService.NBEVENTS.SHOW_MESSENGER,function(event,message){self.isVisible=!0,self.message=message}),scopeService.onEvent(scopeService.NBEVENTS.HIDE_MESSENGER,function(event){self.isVisible=!1})}var self=this;self.message={},self.isVisible=!1,self.$onInit=onInit}angular.module("otusjs.studio.navigationBuilder.messenger").component("otusMessengerInstructor",{templateUrl:"app/navigation-builder/messenger/instructor/instructor-template.html",controller:component}),component.$inject=["$scope","otusjs.studio.navigationBuilder.NavigationBuilderScopeService"]}(),function(){"use strict";function service(scopeService){function showMessenger(message){scopeService.broadcast(scopeService.NBEVENTS.SHOW_MESSENGER,message)}function clearMessenger(){scopeService.broadcast(scopeService.NBEVENTS.HIDE_MESSENGER)}var self=this;self.showMessenger=showMessenger,self.clearMessenger=clearMessenger}angular.module("otusjs.studio.navigationBuilder.messenger").service("otusjs.studio.navigationBuilder.messenger.InstructorService",service),service.$inject=["otusjs.studio.navigationBuilder.NavigationBuilderScopeService"]}(),function(){"use strict";function service(scopeService,DataService,EventsService,UiEventsService){function activate(survey){DataService.activate(survey),UiEventsService.activate(),EventsService.activate()}function deactivate(){DataService.deactivate(),EventsService.deactivate(),UiEventsService.deactivate()}function selectNode(node){DataService.selectNode(node)}function selectedCondition(){return DataService.selectedCondition()}function selectedNode(){return DataService.selectedNode()}function selectedEdges(){return DataService.selectedEdges()}function selectedRoute(){return DataService.selectedRoute()}function createCondition(){DataService.createCondition()}function deleteCondition(index){DataService.deleteCondition(index)}function saveRouteBuilding(){DataService.apply(),scopeService.emit(scopeService.NBEVENTS.ROUTE_BUILD_SAVED),deactivate()}function selectCondition(index){DataService.selectCondition(index)}function startRouteBuilding(origin,destination){DataService.isSimpleNavigation(origin.id)?(DataService.initializeRouteData(),DataService.createCondition()):DataService.routeExists(origin,destination)?DataService.useCurrentRouteData():(DataService.initializeRouteData(),DataService.createCondition()),DataService.selectCondition(0)}function cancelRouteBuilding(){scopeService.emit(scopeService.NBEVENTS.ROUTE_BUILD_CANCELED),deactivate()}function createRule(when,operator,answer){DataService.createRule(when,operator,answer)}function deleteRule(ruleIndex){DataService.deleteRule(ruleIndex)}function getAnswerListForRule(question){return DataService.listAvailableAnswer(question)}function getOperatorListForRule(itemType){return DataService.listAvailableOperator(itemType)}function getWhenListForRule(){return DataService.listAvailableWhen()}function updateRule(ruleIndex,when,operator,answer){DataService.updateRule(ruleIndex,when,operator,answer)}var self=this;self.activate=activate,self.deactivate=deactivate,self.selectNode=selectNode,self.selectedCondition=selectedCondition,self.selectedEdges=selectedEdges,self.selectedNode=selectedNode,self.selectedRoute=selectedRoute,self.createCondition=createCondition,self.deleteCondition=deleteCondition,self.saveRouteBuilding=saveRouteBuilding,self.selectCondition=selectCondition,self.startRouteBuilding=startRouteBuilding,self.cancelRouteBuilding=cancelRouteBuilding,self.createRule=createRule,self.deleteRule=deleteRule,self.getAnswerListForRule=getAnswerListForRule,self.getOperatorListForRule=getOperatorListForRule,self.getWhenListForRule=getWhenListForRule,self.updateRule=updateRule}angular.module("otusjs.studio.navigationBuilder.routeBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.RouteBuilderService",service),service.$inject=["otusjs.studio.navigationBuilder.NavigationBuilderScopeService","otusjs.studio.navigationBuilder.routeBuilder.DataService","otusjs.studio.navigationBuilder.routeBuilder.EventsService","otusjs.studio.navigationBuilder.routeBuilder.UiEventsService"]}(),function(){"use strict";function service(scopeService,RuleWhenBuilderService,RuleOperatorBuilderService,RuleAnswerBuilderService){function activate(survey){_survey=survey,window.survey=_survey}function deactivate(){_survey=null,_originNode=null,_destinationNode=null,_routeData=null,_selectedNavigation=null,_selectedCondition=null}function hasDestinationNode(){return _nodeExists(_destinationNode)}function hasOriginNode(){return _nodeExists(_originNode)}function selectNode(node){_areSameNode(_originNode,node)?(_originNode=null,scopeService.emit(scopeService.NBEVENTS.ORIGIN_NODE_UNSELECTED,node)):_areSameNode(_destinationNode,node)?(_destinationNode=null,scopeService.emit(scopeService.NBEVENTS.DESTINATION_NODE_UNSELECTED,node)):hasOriginNode()?(_destinationNode=node,scopeService.emit(scopeService.NBEVENTS.DESTINATION_NODE_SELECTED,selectedNode())):(_originNode=node,scopeService.emit(scopeService.NBEVENTS.ORIGIN_NODE_SELECTED,node))}function selectedEdges(){return null}function selectedNode(){return[_originNode,_destinationNode]}function _areSameNode(originalNode,nodeToCompare){return!(!_nodeExists(originalNode)||originalNode.id!==nodeToCompare.id)}function _nodeExists(node){return!!node}function apply(){_survey.NavigationManager.selectNavigationByOrigin(_originNode.id),_survey.NavigationManager.applyRoute(_routeData)}function createCondition(){var newConditionData={};newConditionData.name="ROUTE_CONDITION",newConditionData.rules=[],_routeData.conditionSet.push(newConditionData)}function deleteCondition(index){_routeData.conditionSet.splice(index,1),selectCondition(0)}function initializeRouteData(){selectNavigation(_originNode.id),_routeData={},_routeData.origin=_originNode.id,_routeData.destination=_destinationNode.id,_routeData.conditionSet=[]}function selectCondition(index){return!!_routeData.conditionSet.length&&void(_selectedCondition=_routeData.conditionSet[index])}function selectedCondition(){return _selectedCondition}function selectedRoute(){return _routeData}function isSimpleNavigation(origin){return 1===selectNavigation(origin).listRoutes().length}function selectNavigation(origin){return _selectedNavigation=_survey.NavigationManager.selectNavigationByOrigin(origin)}function routeExists(origin,destination){var routeData={};return routeData.origin=origin.id,routeData.destination=destination.id,_selectedNavigation.hasRoute(routeData)}function useCurrentRouteData(){selectNavigation(_originNode.id);var routeQuery={name:_originNode.id+"_"+_destinationNode.id};_routeData=_selectedNavigation.getRoute(routeQuery).toJson(),_routeData=JSON.parse(_routeData)}function createRule(when,operator,answer){var ruleData={};ruleData.when=when,ruleData.operator=operator,ruleData.answer=answer,_selectedCondition.rules.push(ruleData)}function deleteRule(ruleIndex){_selectedCondition.rules.splice(ruleIndex,1)}function listAvailableAnswer(item){return RuleAnswerBuilderService.build(item)}function listAvailableOperator(itemType){return RuleOperatorBuilderService.build(itemType)}function listAvailableWhen(){var itemList=_survey.NavigationManager.getAvaiableRuleCriterionTargets(_originNode.id);return itemList.map(RuleWhenBuilderService.build)}function updateRule(ruleIndex,when,operator,answer){var ruleData=_selectedCondition.rules[ruleIndex];ruleData.when=when,ruleData.operator=operator,ruleData.answer=answer}var self=this,_survey=null,_originNode=null,_destinationNode=null,_routeData=null,_selectedNavigation=null,_selectedCondition=null;self.activate=activate,self.deactivate=deactivate,self.hasDestinationNode=hasDestinationNode,self.hasOriginNode=hasOriginNode,self.selectNode=selectNode,self.selectedEdges=selectedEdges,self.selectedNode=selectedNode,self.apply=apply,self.createCondition=createCondition,self.deleteCondition=deleteCondition,self.initializeRouteData=initializeRouteData,self.isSimpleNavigation=isSimpleNavigation,self.routeExists=routeExists,self.selectCondition=selectCondition,self.selectedCondition=selectedCondition,self.selectedRoute=selectedRoute,self.useCurrentRouteData=useCurrentRouteData,self.createRule=createRule,self.deleteRule=deleteRule,self.listAvailableAnswer=listAvailableAnswer,self.listAvailableOperator=listAvailableOperator,self.listAvailableWhen=listAvailableWhen,self.updateRule=updateRule}angular.module("otusjs.studio.navigationBuilder.routeBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.DataService",service),service.$inject=["otusjs.studio.navigationBuilder.NavigationBuilderScopeService","otusjs.studio.navigationBuilder.routeBuilder.RuleWhenBuilderService","otusjs.studio.navigationBuilder.routeBuilder.RuleOperatorBuilderService","otusjs.studio.navigationBuilder.routeBuilder.RuleAnswerBuilderService"]}(),function(){"use strict";function service(scopeService,MapVisualHandlerService,MapEventsHandlerService,InstructorService,RouteDialogService){function activate(){var event=scopeService.onEvent(scopeService.NBEVENTS.ORIGIN_NODE_SELECTED,function(event,selectedNode){MapVisualHandlerService.lockPreviousNodesOf(selectedNode),MapVisualHandlerService.markOriginRouteNode(selectedNode),MapVisualHandlerService.drawMap(),InstructorService.showMessenger(scopeService.NBMESSAGES.ROUTE_BUILDER.SELECT_DESTINATION),scopeService.digest()});_events.push(event),event=scopeService.onEvent(scopeService.NBEVENTS.ORIGIN_NODE_UNSELECTED,function(event,selectedNode){MapVisualHandlerService.releasePreviousNodesOf(selectedNode),MapVisualHandlerService.unmarkNode(selectedNode),MapVisualHandlerService.drawMap(),
InstructorService.showMessenger(scopeService.NBMESSAGES.ROUTE_BUILDER.SELECT_ORIGIN),scopeService.digest()}),_events.push(event),event=scopeService.onEvent(scopeService.NBEVENTS.DESTINATION_NODE_SELECTED,function(event,selectedNode){MapVisualHandlerService.markDestinationRouteNode(selectedNode),MapVisualHandlerService.drawMap(),InstructorService.clearMessenger(),RouteDialogService.showDialog(selectedNode[0],selectedNode[1]),scopeService.digest()}),_events.push(event),event=scopeService.onEvent(scopeService.NBEVENTS.DESTINATION_NODE_UNSELECTED,function(event,selectedNode){MapVisualHandlerService.unmarkNode(selectedNode),MapVisualHandlerService.drawMap(),InstructorService.showMessenger(scopeService.NBMESSAGES.ROUTE_BUILDER.SELECT_DESTINATION),scopeService.digest()}),_events.push(event),event=scopeService.onEvent(scopeService.NBEVENTS.ROUTE_BUILD_SAVED,function(event){MapVisualHandlerService.clearSelections(),InstructorService.clearMessenger(),RouteDialogService.closeDialog(),scopeService.emit(scopeService.NBEVENTS.ROUTE_MODE_OFF)}),_events.push(event),event=scopeService.onEvent(scopeService.NBEVENTS.ROUTE_BUILD_CANCELED,function(event){MapVisualHandlerService.clearSelections(),InstructorService.clearMessenger(),RouteDialogService.closeDialog(),scopeService.emit(scopeService.NBEVENTS.ROUTE_MODE_OFF)}),_events.push(event),InstructorService.showMessenger(scopeService.NBMESSAGES.ROUTE_BUILDER.SELECT_ORIGIN)}function deactivate(){_events.forEach(function(event){event()})}var self=this,_events=[];self.activate=activate,self.deactivate=deactivate}angular.module("otusjs.studio.navigationBuilder.routeBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.EventsService",service),service.$inject=["otusjs.studio.navigationBuilder.NavigationBuilderScopeService","otusjs.studio.navigationBuilder.MapVisualHandlerService","otusjs.studio.navigationBuilder.MapEventsHandlerService","otusjs.studio.navigationBuilder.messenger.InstructorService","otusjs.studio.navigationBuilder.routeBuilder.RouteDialogService"]}(),function(){"use strict";function service(){}angular.module("otusjs.studio.navigationBuilder.routeBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.MessageService",service)}(),function(){"use strict";function service(){function build(item){var answers=[];return item.options&&(answers=answers.concat(item.options.map(getAnswerOption))),item.metadata&&item.metadata.options&&(answers=answers.concat(item.metadata.options.map(getMetadataOption))),answers}function getAnswerOption(option){return{isMetadata:!1,option:option}}function getMetadataOption(option){return{isMetadata:!0,option:option}}var self=this;self.build=build}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.RuleAnswerBuilderService",service)}(),function(){"use strict";function service(){function build(itemType){return _isTextItem(itemType)?_operatorMap.text:_isNumberItem(itemType)?_operatorMap.number:_isDateItem(itemType)?_operatorMap.date:_isTimeItem(itemType)?_operatorMap.time:_isSingleChoiceItem(itemType)?_operatorMap.singleChoice:_isMultipleChoiceItem(itemType)?_operatorMap.multipleChoice:[]}function _isTextItem(itemType){return"TextQuestion"===itemType||"EmailQuestion"===itemType||"PhoneQuestion"===itemType}function _isNumberItem(itemType){return"IntegerQuestion"===itemType||"DecimalQuestion"===itemType}function _isDateItem(itemType){return"CalendarQuestion"===itemType}function _isTimeItem(itemType){return"TimeQuestion"===itemType}function _isSingleChoiceItem(itemType){return"SingleSelectionQuestion"===itemType}function _isMultipleChoiceItem(itemType){return"CheckboxQuestion"===itemType}function _initOperatorMap(){_operatorMap={};var _notEqual={};_notEqual.type="notEqual",_notEqual.label={},_notEqual.label.ptBR={},_notEqual.label.ptBR.plainText="Diferente de";var _equal={};_equal.type="equal",_equal.label={},_equal.label.ptBR={},_equal.label.ptBR.plainText="Igual a";var _contains={};_contains.type="contains",_contains.label={},_contains.label.ptBR={},_contains.label.ptBR.plainText="Contém";var _in={};_in.type="in",_in.label={},_in.label.ptBR={},_in.label.ptBR.plainText="Está dentro do intervalo";var _between={};_between.type="between",_between.label={},_between.label.ptBR={},_between.label.ptBR.plainText="Está entre os valores";var _greater={};_greater.type="greater",_greater.label={},_greater.label.ptBR={},_greater.label.ptBR.plainText="É maior que";var _greaterEqual={};_greaterEqual.type="greaterEqual",_greaterEqual.label={},_greaterEqual.label.ptBR={},_greaterEqual.label.ptBR.plainText="É maior ou igual a";var _lower={};_lower.type="lower",_lower.label={},_lower.label.ptBR={},_lower.label.ptBR.plainText="É menor que";var _lowerEqual={};_lowerEqual.type="lowerEqual",_lowerEqual.label={},_lowerEqual.label.ptBR={},_lowerEqual.label.ptBR.plainText="É menor ou igual a",_operatorMap.singleChoice=[_notEqual,_equal],_operatorMap.text=Array.prototype.concat(_operatorMap.singleChoice,[_contains]),_operatorMap.number=Array.prototype.concat(_operatorMap.singleChoice,[_in,_between,_greater,_greaterEqual,_lower,_lowerEqual]),_operatorMap.date=_operatorMap.number,_operatorMap.time=_operatorMap.date,_operatorMap.multipleChoice=_operatorMap.text}var self=this,_operatorMap={};_initOperatorMap(),self.build=build}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.RuleOperatorBuilderService",service)}(),function(){"use strict";function service(){function build(item){var builded={};return builded.type=item.objectType,builded.icon=item.objectType,builded.customID=item.customID,builded.label=item.label,builded.item=item,builded}var self=this;self.build=build}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.RuleWhenBuilderService",service)}(),function(){"use strict";function service(MapVisualHandlerService,MapEventsHandlerService,DataService){function activate(){MapEventsHandlerService.loadMapView(MapVisualHandlerService.mapView()),MapEventsHandlerService.onClickNode(function(event){var clickedNode=event.data.node;clickedNode.isDisabled||DataService.selectNode(event.data.node)})}function deactivate(){MapEventsHandlerService.clearAllEventListeners()}var self=this;self.activate=activate,self.deactivate=deactivate}angular.module("otusjs.studio.navigationBuilder.routeBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.UiEventsService",service),service.$inject=["otusjs.studio.navigationBuilder.MapVisualHandlerService","otusjs.studio.navigationBuilder.MapEventsHandlerService","otusjs.studio.navigationBuilder.routeBuilder.DataService"]}(),function(){"use strict";function service($mdDialog,scopeService){function _init(){_setupDialogConfiguration()}function showDialog(originNode,destinationNode){_dialogSettings.locals={origin:originNode,destination:destinationNode,scopeService:scopeService},$mdDialog.show(_dialogSettings)}function closeDialog(){$mdDialog.hide()}function _setupDialogConfiguration(){_dialogSettings.templateUrl="app/navigation-builder/route/dialog/route-dialog-template.html",_dialogSettings.controller=DialogController,_dialogSettings.controllerAs="ctrl",_dialogSettings.escapeToClose=!1,_dialogSettings.fullscreen=!0,_dialogSettings.hasBackdrop=!0}var self=this,_dialogSettings={};self.showDialog=showDialog,self.closeDialog=closeDialog,_init()}function DialogController($mdDialog,origin,destination,scopeService){function cancel(response){$mdDialog.hide(response)}function confirm(response){$mdDialog.hide(response)}var self=this;self.origin=origin,self.destination=destination,self.cancel=cancel,self.confirm=confirm}angular.module("otusjs.studio.navigationBuilder.routeBuilder").service("otusjs.studio.navigationBuilder.routeBuilder.RouteDialogService",service),service.$inject=["$mdDialog","otusjs.studio.navigationBuilder.NavigationBuilderScopeService"]}(),function(){"use strict";function component(RouteBuilderService){function onInit(){_initializeLabels(),RouteBuilderService.startRouteBuilding(self.originNode,self.destinationNode),self.condition=RouteBuilderService.selectedCondition()}function cancel(){RouteBuilderService.cancelRouteBuilding()}function save(){RouteBuilderService.saveRouteBuilding()}function _initializeLabels(){self.label={dialog:{title:"Criar nova Rota"},button:{cancel:"Cancelar",save:"Salvar Rota",createCondition:"Criar grupo de Regras",deleteCondition:"Excluir grupo atual"},origin:"Origem",destination:"Destino",originNode:self.originNode.label,destinationNode:self.destinationNode.label,message:{emptyConditions:"Você ainda não criou condições de rota. Clicando em CRIAR GRUPO DE REGRAS"}}}var self=this;self.routeConditions=[],self.$onInit=onInit,self.cancel=cancel,self.save=save}angular.module("otusjs.studio.navigationBuilder.routeBuilder").component("otusRouteEditor",{templateUrl:"app/navigation-builder/route/editor/route-editor.html",controller:component,bindings:{originNode:"<",destinationNode:"<",onConfirm:"&"}}),component.$inject=["otusjs.studio.navigationBuilder.routeBuilder.RouteBuilderService"]}(),function(){"use strict";function component(RouteBuilderService){function onInit(){_initializeWhenList(),self.ruleData?(self.ruleData.index=self.ruleItemIndex,_applyRuleDataWhen(),_applyRuleDataOperator(),_applyRuleDataAnswer(),self.isOperatorDisable=!1,self.isAnswerDisable=!1,self.showSaveRuleButton=!1,self.showUpdateRuleButton=!0,self.showDeleteRuleButton=!0):(self.isOperatorDisable=!0,self.isAnswerDisable=!0,self.showSaveRuleButton=!0,self.showUpdateRuleButton=!1,self.showDeleteRuleButton=!1,self.readyToSave=_readyToSave())}function _applyRuleDataWhen(){var customID=self.ruleData.when.customID||self.ruleData.when;self.whenList.some(function(when){if(when.customID===customID)return self.selectedWhen=when,!0})}function _applyRuleDataOperator(){self.operatorList=RouteBuilderService.getOperatorListForRule(self.selectedWhen.type);var type=self.ruleData.operator.type||self.ruleData.operator;self.operatorList.some(function(operator){if(operator.type===type)return self.selectedOperator=operator,!0})}function _applyRuleDataAnswer(){self.answerList=RouteBuilderService.getAnswerListForRule(self.selectedWhen.item);var value=self.ruleData.answer.option?self.ruleData.answer.option.value:self.ruleData.answer;self.answerList.some(function(answer){if(answer.option.value===value)return self.selectedAnswer=answer,!0})}function answers(filterValue){if(self.inputedValue=filterValue,filterValue){var filterResult=self.answerList.filter(function(answer){return answer.label.search(filterValue)!=-1||self.selectedWhen.customID.search(filterValue)!=-1});return filterResult}return self.answerList}function answerChange(answer){self.readyToSave=_readyToSave()}function answerInputChange(){self.readyToSave=_readyToSave()}function operatorChange(operator){self.selectedOperator=operator,self.readyToSave=_readyToSave()}function whens(filterValue){if(filterValue){var filterResult=self.whenList.filter(function(when){return when.label.ptBR.plainText.search(filterValue)!=-1||when.customID.search(filterValue)!=-1});return filterResult}return self.whenList}function whenChange(when){self.selectedWhen=when,self.operatorList=[],self.answerList=[],self.selectedWhen?(self.operatorList=RouteBuilderService.getOperatorListForRule(self.selectedWhen.type),self.answerList=RouteBuilderService.getAnswerListForRule(self.selectedWhen.item),self.isOperatorDisable=!1):self.isOperatorDisable=!0,self.readyToSave=_readyToSave()}function saveRule(){_readyToSave()&&RouteBuilderService.createRule(self.selectedWhen,self.selectedOperator,self.selectedAnswer),self.whenSearchText="",self.operatorSearchText="",self.answerSearchText=""}function updateRule(){RouteBuilderService.updateRule(self.ruleData.index,self.selectedWhen,self.selectedOperator,self.selectedAnswer)}function deleteRule(){RouteBuilderService.deleteRule(self.ruleData.index)}function _initializeWhenList(){self.whenList=[],self.whenList=RouteBuilderService.getWhenListForRule()}function _readyToSave(){return!!(_resolveRuleWhen()&&_resolveRuleOperator()&&_resolveRuleAnswer())}function _resolveRuleWhen(){return!!self.selectedWhen}function _resolveRuleOperator(){return!!self.selectedOperator}function _resolveRuleAnswer(){return!(!self.selectedAnswer&&!self.inputedValue)&&(!self.selectedAnswer&&self.inputedValue?(self.selectedAnswer=self.inputedValue,!0):!!self.selectedAnswer||void 0)}var self=this;self.$onInit=onInit,self.answers=answers,self.answerChange=answerChange,self.answerInputChange=answerInputChange,self.operatorChange=operatorChange,self.whens=whens,self.whenChange=whenChange,self.saveRule=saveRule,self.updateRule=updateRule,self.deleteRule=deleteRule}angular.module("otusjs.studio.navigationBuilder.routeBuilder").component("otusRuleEditor",{templateUrl:"app/navigation-builder/route/editor/rule-editor-template.html",controller:component,bindings:{ruleData:"<",ruleItemIndex:"<"}}),component.$inject=["otusjs.studio.navigationBuilder.routeBuilder.RouteBuilderService"]}(),function(){"use strict";function service(){var self=this;self.backgroundColor="#448aff",self.textColor="#737373"}angular.module("otus.textEdition").service("otus.textEdition.ColorContext",service)}(),function(){"use strict";function controller(ColorContext,$mdDialog){function _init(){self.currentBackgroundColor=ColorContext.backgroundColor,self.currentTextColor=ColorContext.textColor}function cancel(){$mdDialog.cancel()}function select(){ColorContext.backgroundColor=self.currentBackgroundColor,ColorContext.textColor=self.currentTextColor,$mdDialog.hide()}var self=this;self.select=select,self.cancel=cancel,_init()}angular.module("otus.textEdition").controller("otus.textEdition.ColorController",controller),controller.$inject=["otus.textEdition.ColorContext","$mdDialog"]}(),function(){function otusAccordion(OtusAccordionWidgetFactory){var directive={restrict:"E",transclude:!0,templateUrl:"app/shared/ui-components/accordion/accordion-template.html",scope:{},link:function(scope,template,attrs,controller,transclude){var userHeader,userContent,templateHeader=angular.element(template.children()[0]),templateContent=angular.element(template.children()[1]);transclude(function(clone,cloneScope){userHeader=angular.element(clone[1]),userContent=angular.element(clone[3])}),userHeader.children().insertBefore(templateHeader.children()),templateContent.append(userContent.children()),scope.widget=OtusAccordionWidgetFactory.create(scope,attrs,scope.$parent)}};return directive}angular.module("ui.components").directive("otusAccordion",otusAccordion),otusAccordion.$inject=["OtusAccordionWidgetFactory"]}(),function(){"use strict";function OtusAccordionWidgetFactory(){function create(templateData,templateConfig,parentWidget){return new OtusAccordionWidget(templateData,templateConfig,parentWidget)}var self=this;return self.create=create,self}function OtusAccordionWidget(templateData,templateConfig,parentWidget){function changeState(){self.isToShow=!self.isToShow,self.template.icon=self.isToShow?"expand_less":"expand_more"}var self=this;self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.icon="expand_more",self.parent=parentWidget,self.isToShow=!1,self.changeState=changeState}angular.module("ui.components").factory("OtusAccordionWidgetFactory",OtusAccordionWidgetFactory)}(),function(){"use strict";function SurveyTemplateController($element,$scope,SelectedSurveyTemplatesManagementService){function _select(){self.isSelected=!0,mdCard.addClass("selected-template"),SelectedSurveyTemplatesManagementService.selectSurveyTemplate(self.surveyTemplate)}function _remove(){self.isSelected=!1,mdCard.removeClass("selected-template"),SelectedSurveyTemplatesManagementService.removeSurveyTemplate(self.surveyTemplate)}function _scopeApply(){$scope.$apply()}var mdCard,self=this;self.isSelected=!1,self.$onDestroy=function(){self.isSelected&&SelectedSurveyTemplatesManagementService.removeSurveyTemplate(self.surveyTemplate)},$element.on("click",function(){mdCard=$element.children(),self.isSelected?_remove():_select(),_scopeApply()})}angular.module("surveyTemplates").component("surveyTemplate",{templateUrl:"app/dashboard/survey-templates/components/survey-template/survey-template.html",controller:SurveyTemplateController,bindings:{surveyTemplate:"<"}}),SurveyTemplateController.$inject=["$element","$scope","SelectedSurveyTemplatesManagementService"]}(),function(){"use strict";function SurveyTemplateControllerList(SurveyTemplateManagerService){function getSurveyTemplatesList(){return SurveyTemplateManagerService.surveyTemplates}var self=this;self.getSurveyTemplatesList=getSurveyTemplatesList,self.$onInit=function(){SurveyTemplateManagerService.initializeSurveyTemplateList()}}angular.module("surveyTemplates").component("surveyTemplatesList",{templateUrl:"app/dashboard/survey-templates/components/survey-templates-list/survey-templates-list.html",controller:SurveyTemplateControllerList}),SurveyTemplateControllerList.$inject=["SurveyTemplateManagerService"]}(),function(){"use strict";function SurveyTemplatesToolbarController(SurveyTemplateManagerService,SelectedSurveyTemplatesManagementService,$mdToast,DashboardStateService,$window){function deleteSelectedSurveyTemplate(){SelectedSurveyTemplatesManagementService.selectedSurveyTemplates.forEach(function(template){SurveyTemplateManagerService.deleteSurveyTemplate(template)}),$mdToast.show($mdToast.simple().textContent("Template(s) removido(s) com sucesso!"))}function openEditorForSelectedSurveyTemplate(){var selectedSurveyTemplate=_getSelectedSurveyTemplate();$window.sessionStorage.setItem("surveyTemplate_OID",selectedSurveyTemplate.oid),DashboardStateService.goToEditorWithSurveyTemplate(selectedSurveyTemplate)}function _getSelectedSurveyTemplate(){return SelectedSurveyTemplatesManagementService.selectedSurveyTemplates[0].template}var self=this;self.SelectedSurveyTemplatesManagementService=SelectedSurveyTemplatesManagementService,self.deleteSelectedSurveyTemplate=deleteSelectedSurveyTemplate,self.openEditorForSelectedSurveyTemplate=openEditorForSelectedSurveyTemplate}angular.module("surveyTemplates").component("surveyTemplatesToolbar",{templateUrl:"app/dashboard/survey-templates/components/survey-templates-toolbar/survey-templates-toolbar-template.html",controller:SurveyTemplatesToolbarController}),SurveyTemplatesToolbarController.$inject=["SurveyTemplateManagerService","SelectedSurveyTemplatesManagementService","$mdToast","DashboardStateService","$window"]}(),function(){"use strict";function NewSurveyFormDialogService($mdDialog){function init(){self.dialogSettings={parent:angular.element(document.body),templateUrl:"app/dashboard/survey-templates/dialog/new-survey-form/new-survey-form-dialog.html",controller:DialogController,controllerAs:"controller",openFrom:"#system-toolbar",closeTo:{bottom:0}}}function showDialog(){return $mdDialog.show(self.dialogSettings).then(forwardSuccessfulExecution,forwardUnsuccessfulExecution),{onConfirm:function(callback){self.callback=callback}}}function forwardSuccessfulExecution(response){"create"==response.action&&self.callback&&self.callback(response.data)}function forwardUnsuccessfulExecution(error){}var self=this;self.showDialog=showDialog,init()}function DialogController($mdDialog){function cancel(response){$mdDialog.hide(response)}function createSurveyForm(response){$mdDialog.hide(response)}var self=this;self.cancel=cancel,self.createSurveyForm=createSurveyForm}angular.module("studio.dashboard").service("NewSurveyFormDialogService",NewSurveyFormDialogService),NewSurveyFormDialogService.$inject=["$mdDialog"]}(),function(){"use strict";function directive(OtusButtonWidgetFactory){var ddo={scope:{click:"="},templateUrl:"app/editor/ui/base/button/button.html",retrict:"E",link:function(scope,element,attrs){scope.widget=OtusButtonWidgetFactory.create(scope,attrs,scope.$parent.widget)}};return ddo}angular.module("editor.ui").directive("otusButton",directive),directive.$inject=["OtusButtonWidgetFactory"]}(),function(){"use strict";function OtusButtonWidgetFactory(){function create(templateData,templateConfig,parentWidget){return new OtusButtonWidget(templateData,templateConfig,parentWidget)}var self=this;return self.create=create,self}function OtusButtonWidget(templateData,templateConfig,parentWidget){var self=this,validTooltipDirections=["top","bottom","left","right"];self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.ariaLabel=templateConfig.ariaLabel||templateConfig.label,self.template.label=templateConfig.label,self.template.tooltip=templateConfig.tooltip||templateConfig.label,self.template.tooltipDirection=void 0!==templateConfig.tooltipDirection&&validTooltipDirections.indexOf(templateConfig.tooltipDirection)!==-1?templateConfig.tooltipDirection:"top",self.template.leftIcon=templateConfig.iconButton||templateConfig.leftIcon,self.template.rightIcon=templateConfig.rightIcon,self.template.hasLeftIcon=void 0!==self.template.leftIcon,self.template.hasRightIcon=void 0===templateConfig.iconButton&&void 0!==self.template.rightIcon,self.css.iconButton=void 0!==templateConfig.iconButton?"md-icon-button":"",self.parent=parentWidget,self.event.click=templateData.click}angular.module("editor.ui").factory("OtusButtonWidgetFactory",OtusButtonWidgetFactory)}(),function(){"use strict";function EditableCustomIDService(WorkspaceService,UpdateQuestionEventFactory,$mdToast){function isEmpty(customizedID){return""===customizedID}function removeAllBlankSpaces(customizedID){return customizedID.replace(/\s/g,"")}function restoreScreenID(event,editableID_Object){event.target.innerText=editableID_Object.getCustomizedID()}function hasChanges(customizedID,editableID_Object){return customizedID!==editableID_Object.getCustomizedID()}function execute(event,editableID_Object){var customizedID=removeAllBlankSpaces(event.target.innerText);customizedID===editableID_Object.getCustomizedID()||isEmpty(customizedID)?restoreScreenID(event,editableID_Object):hasChanges(customizedID,editableID_Object)&&(_checkIfIsAvailable(customizedID)?(editableID_Object.updateCustomizedID(customizedID),UpdateQuestionEventFactory.create().execute(self),restoreScreenID(event,editableID_Object)):($mdToast.show($mdToast.simple().textContent("O ID inserido já está em uso.")),restoreScreenID(event,editableID_Object)))}function _checkIfIsAvailable(customizedID){return!!WorkspaceService.getSurvey().isAvailableCustomID(customizedID)}var self=this;self.isEmpty=isEmpty,self.removeAllBlankSpaces=removeAllBlankSpaces,self.restoreScreenID=restoreScreenID,self.hasChanges=hasChanges,self.execute=execute}angular.module("editor.ui").service("EditableCustomIDService",EditableCustomIDService),EditableCustomIDService.$inject=["WorkspaceService","UpdateQuestionEventFactory","$mdToast"]}(),function(){"use strict";function EditableID($element,EditableIDFactory,EditableCustomIDService){function onInit(){_editableID=EditableIDFactory.create(self.item),$element.children()[0].innerText=_editableID.getCustomizedID()}self=this;var _editableID;self.$onInit=onInit,$element.on("focusout",function(event){EditableCustomIDService.execute(event,_editableID)})}angular.module("editor.ui").component("editableId",{templateUrl:"app/editor/ui/base/editable-id/editable-id.html",controller:EditableID,bindings:{item:"<"}}),EditableID.$inject=["$element","EditableIDFactory","EditableCustomIDService"]}(),function(){"use strict";function EditableIDFactory(UpdateSurveyItemCustomID){function create(object){return new EditableIDComponent(object,UpdateSurveyItemCustomID)}var self=this;return self.create=create,self}function EditableIDComponent(object,UpdateSurveyItemCustomID){function getAutoGeneratedID(){var autoGeneratedID;return autoGeneratedID="CheckboxAnswerOption"===_object.objectType?_object.optionID:_object.templateID}function getCustomizedID(){var customizedID;return customizedID="CheckboxAnswerOption"===_object.objectType?_object.customOptionID:_object.customID}function getLastValidID(){return _lastValidID}function updateCustomizedID(customizedID){_lastValidID=customizedID,"CheckboxAnswerOption"===_object.objectType?_object.setCustomOptionID(customizedID):UpdateSurveyItemCustomID.execute(_object,customizedID)}var _lastValidID,self=this,_object=object;self.getCustomizedID=getCustomizedID,self.getAutoGeneratedID=getAutoGeneratedID,self.getLastValidID=getLastValidID,self.updateCustomizedID=updateCustomizedID}angular.module("editor.ui").factory("EditableIDFactory",EditableIDFactory),EditableIDFactory.$inject=["UpdateSurveyItemCustomID"]}(),function(){"use strict";function otusInputText(OtusInputTextWidgetFactory){var ddo={scope:{model:"=",disabled:"@"},templateUrl:"app/editor/ui/base/input-text/input-text.html",retrict:"E",link:function(scope,element,attrs){scope.widget=OtusInputTextWidgetFactory.create(scope,attrs,element,scope.$parent.widget||scope.$parent.$parent.childWidget)}};return ddo}angular.module("editor.ui").directive("otusInputText",otusInputText),otusInputText.$inject=["OtusInputTextWidgetFactory"]}(),function(){"use strict";function OtusInputTextWidgetFactory(){function create(templateData,templateConfig,element,parentWidget){return new OtusInputTextWidget(templateData,templateConfig,element,parentWidget)}var self=this;return self.create=create,self}function OtusInputTextWidget(templateData,templateConfig,element,parentWidget){var self=this;self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.ariaLabel=templateConfig.ariaLabel||templateConfig.label,self.template.label=templateConfig.label,self.template.leftIcon=templateConfig.iconButton||templateConfig.leftIcon,self.template.rightIcon=templateConfig.rightIcon,self.template.hasLeftIcon=void 0!==self.template.leftIcon,self.template.hasRightIcon=void 0===templateConfig.iconButton&&void 0!==self.template.rightIcon,self.parent=parentWidget,self.modelReference=templateData.model,self.style=templateData.style,templateData.model instanceof Function?self.model=templateData.model():self.model=templateData.model,element.on("change",function(){self.modelReference instanceof Function?self.modelReference(self.model):self.modelReference=self.model})}angular.module("editor.ui").factory("OtusInputTextWidgetFactory",OtusInputTextWidgetFactory)}(),function(){"use strict";function directive(OtusTextEditorWidgetFactory){var ddo={scope:{placeholder:"@",label:"=",ariaLabel:"@",leftIcon:"@",ngModel:"="},templateUrl:"app/editor/ui/base/text-editor/text-editor.html",retrict:"E",link:function(scope,element){scope.widget=OtusTextEditorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusTextEditor",directive),directive.$inject=["OtusTextEditorWidgetFactory"]}(),function(){"use strict";function OtusTextEditorWidgetFactory(UpdateQuestionEventFactory){function create(scope,element){return new OtusTextEditorWidget(scope,element,UpdateQuestionEventFactory)}var self=this;return self.create=create,self}function OtusTextEditorWidget(scope,element,UpdateQuestionEventFactory){function _init(){self.ngModel&&_loadLabel()}function getClassName(){return"OtusTextEditorWidget"}function getUUID(){return scope.uuid}function getLabel(){return self.ngModel.ptBR.formattedText}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function _saveLabel(){self.ngModel.ptBR.formattedText=_removeSpecialCharacters(event.target.innerHTML),self.ngModel.ptBR.plainText=event.target.innerText}function _removeSpecialCharacters(value){return value.replace(/"/g,"'")}function _loadLabel(){self.getElement().children()[0].innerHTML=self.getLabel()}var self=this;self.input=angular.element(element.children()[0]),self.ngModel=scope.ngModel,self.placeholder=scope.placeholder,self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getLabel=getLabel,_init(),element.on("focusout",function(event){_saveLabel(),UpdateQuestionEventFactory.create().execute(self)})}angular.module("editor.ui").factory("OtusTextEditorWidgetFactory",OtusTextEditorWidgetFactory),OtusTextEditorWidgetFactory.$inject=["UpdateQuestionEventFactory"]}(),function(){"use strict";function otusMetadataGroup(MetadataGroupWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/metadata/group/metadata-group.html",link:function(scope,element){scope.widget=MetadataGroupWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMetadataGroup",otusMetadataGroup),otusMetadataGroup.$inject=["MetadataGroupWidgetFactory"]}(),function(){"use strict";function MetadataGroupWidgetFactory(MetadataOptionWidgetFactory,AddMetadataAnswerEventFactory,RemoveMetadataOptionEventFactory){function create(scope,element){return new MetadataGroupWidget(scope,element,MetadataOptionWidgetFactory,AddMetadataAnswerEventFactory,RemoveMetadataOptionEventFactory)}var self=this;return self.create=create,self}function MetadataGroupWidget(scope,element,MetadataOptionWidgetFactory,AddMetadataAnswerEventFactory,RemoveMetadataOptionEventFactory){function _init(){self.getItem().metadata.options.length>0&&_loadOptions()}function getClassName(){return"MetadataGroupWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function _loadOptions(){self.getItem().metadata.options.forEach(function(option){var optionWidget=MetadataOptionWidgetFactory.create(option,self);self.options.push(optionWidget)})}function addOption(){var newOption=AddMetadataAnswerEventFactory.create().execute(self),optionWidget=MetadataOptionWidgetFactory.create(newOption,self);self.options.push(optionWidget)}function removeLastOption(){RemoveMetadataOptionEventFactory.create().execute(self),self.options.splice(-1)}var self=this;self.ngModel=scope.ngModel,self.options=[],self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.addOption=addOption,self.removeLastOption=removeLastOption,_init()}angular.module("editor.ui").factory("MetadataGroupWidgetFactory",MetadataGroupWidgetFactory),MetadataGroupWidgetFactory.$inject=["MetadataOptionWidgetFactory","AddMetadataAnswerEventFactory","RemoveMetadataOptionEventFactory"]}(),function(){"use strict";function MetadataOptionWidgetFactory(){function create(option,parentGroup){return new MetadataAnswerOptionWidget(option,parentGroup)}var self=this;return self.create=create,self}function MetadataAnswerOptionWidget(option,parentGroup){var self=this;self.name="MetadataAnswerOption",self.parentGroup=parentGroup,self.option=option}angular.module("editor.ui").factory("MetadataOptionWidgetFactory",MetadataOptionWidgetFactory)}(),function(){"use strict";function directive(SurveyItemWidgetFactory,SheetContentService){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/misc/misc.html",retrict:"E",link:function(scope,element){scope.widget=SurveyItemWidgetFactory.create(scope,element,SheetContentService.lastLoadedQuestion)}};return ddo}angular.module("editor.ui").directive("miscItem",directive),directive.$inject=["SurveyItemWidgetFactory","SheetContentService"]}(),function(){"use strict";function directive(SurveyItemWidgetFactory,SheetContentService){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/question.html",retrict:"E",link:function(scope,element){scope.widget=SurveyItemWidgetFactory.create(scope,element,SheetContentService.lastLoadedQuestion)}};return ddo}angular.module("editor.ui").directive("otusQuestionItem",directive),directive.$inject=["SurveyItemWidgetFactory","SheetContentService"]}(),function(){"use strict";function otusItemIcon(){var ddo={scope:{item:"@item"},templateUrl:"app/editor/ui/survey-item-editor/item-icon/otus-item-icon-template.html",retrict:"E",link:function(scope,element,attrs){
scope.type=getItemIcon(scope.item)}};return ddo}function getItemIcon(objectType){var mapping={CalendarQuestion:{icon:"date_range",tooltip:"Data"},IntegerQuestion:{icon:"looks_one",tooltip:"Número Inteiro"},DecimalQuestion:{icon:"exposure_zero",tooltip:"Número Decimal"},SingleSelectionQuestion:{icon:"radio_button_checked",tooltip:"Seleção Única"},CheckboxQuestion:{icon:"check_box",tooltip:"Checkbox"},TextQuestion:{icon:"text_format",tooltip:"Texto"},EmailQuestion:{icon:"email",tooltip:"Email"},TimeQuestion:{icon:"access_time",tooltip:"Hora"},PhoneQuestion:{icon:"phone",tooltip:"Telefone"},TextItem:{icon:"message",tooltip:"Texto"},ImageItem:{icon:"image",tooltip:"Imagem"}};return mapping[objectType]}angular.module("editor.ui").directive("otusItemIcon",otusItemIcon),otusItemIcon.$inject=[]}(),function(){"use strict";function SurveyItemSettingsContentService(TemplateLoaderService){function loadNavigation(contentArea,scope){TemplateLoaderService.load(NAVIGATION_TEMPLATE,scope,function(template){contentArea.append(template)})}function closeNavigation(contentArea){contentArea.empty()}var self=this;self.loadNavigation=loadNavigation,self.closeNavigation=closeNavigation}angular.module("editor.ui").service("SurveyItemSettingsContentService",SurveyItemSettingsContentService),SurveyItemSettingsContentService.$inject=["TemplateLoaderService"]}(),function(){"use strict";function SurveyItemSettingsController($scope,$element,SurveyItemSettingsContentService){function navigation(templateID){var contentArea=$element.find(".toolbar-content-"+templateID);contentArea.children().length?SurveyItemSettingsContentService.closeNavigation(contentArea):SurveyItemSettingsContentService.loadNavigation(contentArea,$scope)}var self=this;self.navigation=navigation}angular.module("editor.ui").controller("SurveyItemSettingsController",SurveyItemSettingsController),SurveyItemSettingsController.$inject=["$scope","$element","SurveyItemSettingsContentService"]}(),function(){"use strict";function directive(SurveyItemSettingsWidgetFactory,UUIDService){var ddo={scope:{},restrict:"E",controller:"SurveyItemSettingsController",templateUrl:"app/editor/ui/survey-item-editor/survey-item-settings/survey-item-settings.html",link:function(scope,element,attrs){scope.uuid=UUIDService.generateUUID(),scope.widget=SurveyItemSettingsWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusSurveyItemSettings",directive),directive.$inject=["SurveyItemSettingsWidgetFactory","UUIDService"]}(),function(){"use strict";function SurveyItemSettingsWidgetFactory(){function create(scope,element){return new SurveyItemSettingsWidget(scope,element)}var self=this;return self.create=create,self}function SurveyItemSettingsWidget(scope,element){function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.$parent.$parent.widget}function getItem(){return getParent().getItem()}function navigationButton(){self.ngClass.open=!self.ngClass.open,self.showNavigationEditor=!self.showNavigationEditor}function validationButton(){self.ngClass.open=!self.ngClass.open,self.showValidationEditor=!self.showValidationEditor}var self=this;self.className="SurveyItemSettingsWidget",self.ngClass={},self.ngClass.open=!1,self.showNavigationEditor=!1,self.showValidationEditor=!1,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.navigationButton=navigationButton,self.validationButton=validationButton}angular.module("editor.ui").factory("SurveyItemSettingsWidgetFactory",SurveyItemSettingsWidgetFactory)}(),function(){"use strict";function otusFillingRulesEditor(FillingRulesEditorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/editor/validation-editor.html",link:function(scope,element){scope.widget=FillingRulesEditorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusFillingRulesEditor",otusFillingRulesEditor),otusFillingRulesEditor.$inject=["FillingRulesEditorWidgetFactory"]}(),function(){"use strict";function FillingRulesEditorWidgetFactory(AddFillingRulesEventFactory,RemoveFillingRulesEventFactory,OtusFillingRulesWidgetFactory,$compile,UpdateFillingRulesEventFactory){function create(scope,element){return new FillingRulesEditorWidget(scope,element,AddFillingRulesEventFactory,RemoveFillingRulesEventFactory,OtusFillingRulesWidgetFactory,$compile,UpdateFillingRulesEventFactory)}var self=this;return self.create=create,self}function FillingRulesEditorWidget(scope,element,AddFillingRulesEventFactory,RemoveFillingRulesEventFactory,OtusFillingRulesWidgetFactory,$compile,UpdateFillingRulesEventFactory){function _init(){showList=showListFeeder(),Object.keys(self.getItem().fillingRules.options).length>0?(Object.keys(self.getItem().fillingRules.options),_loadOptions()):addValidator("mandatory")}function showListFeeder(){var showList=getItem().validators();return showList}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function _loadOptions(){Object.keys(self.getItem().fillingRules.options).forEach(function(validatorToLoad){appendFillingRules(validatorToLoad)})}function addValidator(validator){AddFillingRulesEventFactory.create().execute(getItem(),validator),appendFillingRules(validator)}function appendFillingRules(validator){showList.splice(showList.indexOf(validator),1);var template=OtusFillingRulesWidgetFactory.create(validator),validatorsColumn=element.find("#validators-column"),validatorTemplate=$compile(template)(scope);validatorsColumn.append(validatorTemplate)}function deleteValidator(validator){showList.push(validator),RemoveFillingRulesEventFactory.create().execute(self,validator)}function updateFillingRules(){UpdateFillingRulesEventFactory.create().execute()}function checkIfShow(fillingRule){return showList.indexOf(fillingRule)>-1}function menuDisabler(){return!(showList.length>0)}var self=this;self.ngModel=scope.ngModel,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.addValidator=addValidator,self.checkIfShow=checkIfShow,self.deleteValidator=deleteValidator,self.updateFillingRules=updateFillingRules,self.menuDisabler=menuDisabler,_init();var showList}angular.module("editor.ui").factory("FillingRulesEditorWidgetFactory",FillingRulesEditorWidgetFactory),FillingRulesEditorWidgetFactory.$inject=["AddFillingRulesEventFactory","RemoveFillingRulesEventFactory","OtusFillingRulesWidgetFactory","$compile","UpdateFillingRulesEventFactory"]}(),function(){"use strict";function service($mdDialog){function _init(){_dialogSettings.templateUrl="app/navigation-builder/messenger/dialog/text/text-dialog-template.html",_dialogSettings.controller=DialogController,_dialogSettings.controllerAs="ctrl",_dialogSettings.escapeToClose=!1,_dialogSettings.fullscreen=!1,_dialogSettings.hasBackdrop=!1}function showDialog(message){_dialogSettings.locals={message:message},$mdDialog.show(_dialogSettings)}var self=this,_dialogSettings={};_init(),self.showDialog=showDialog}function DialogController($mdDialog,message){function cancel(response){$mdDialog.hide(response)}function confirm(response){$mdDialog.hide(response)}var self=this;self.message=message,self.cancel=cancel,self.confirm=confirm}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.TextDialogService",service),service.$inject=["$mdDialog"]}(),function(){"use strict";function service($mdPanel){function _init(){var panelPosition=$mdPanel.newPanelPosition().absolute().center();_dialogSettings.attachTo=angular.element(document.body),_dialogSettings.controller=DialogController,_dialogSettings.controllerAs="ctrl",_dialogSettings.position=panelPosition,_dialogSettings.templateUrl="app/navigation-builder/messenger/dialog/text/text-panel-template.html"}function showDialog(message){_dialogSettings.locals={message:message},_panelRef=$mdPanel.create(_dialogSettings),_panelRef.open().finally(function(){_panelRef=void 0})}var self=this,_dialogSettings={},_panelRef=null;_init(),self.showDialog=showDialog}function DialogController(message){function cancel(response){$mdDialog.hide(response)}function confirm(response){$mdDialog.hide(response)}var self=this;self.message=message,self.cancel=cancel,self.confirm=confirm}angular.module("otusjs.studio.navigationBuilder").service("otusjs.studio.navigationBuilder.TextPanelService",service),service.$inject=["$mdPanel"]}(),function(){"use strict";function imageItem(ImageItemWidgetFactory){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/misc/image/image-item.html",retrict:"E",link:function(scope,element){scope.widget=scope.$parent.widget}};return ddo}angular.module("editor.ui").directive("imageItem",imageItem)}(),function(){"use strict";function ImageItemWidgetFactory(){function create(scope){return new ImageItemWidget(scope)}var self=this;return self.create=create,self}function ImageItemWidget(scope){function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<image-item></image-item>"}var self=this;self.name="ImageItem",self.getParent=getParent,self.item=getItem(),self.getTemplate=getTemplate}angular.module("editor.ui").factory("ImageItemWidgetFactory",ImageItemWidgetFactory)}(),function(){"use strict";function textItem(TextItemWidgetFactory){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/misc/text/text-item.html",retrict:"E",link:function(scope,element){scope.widget=scope.$parent.widget}};return ddo}angular.module("editor.ui").directive("textItem",textItem),textItem.$inject=["TextItemWidgetFactory"]}(),function(){"use strict";function TextItemWidgetFactory(){function create(scope){return new TextItemWidget(scope)}var self=this;return self.create=create,self}function TextItemWidget(scope){function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<text-item></text-item>"}var self=this;self.name="TextItem",self.getParent=getParent,self.item=getItem(),self.getTemplate=getTemplate}angular.module("editor.ui").factory("TextItemWidgetFactory",TextItemWidgetFactory)}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/calendar/calendar-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("calendarQuestion",directive)}(),function(){"use strict";function CalendarQuestionWidgetFactory(){function create(scope,element){return new CalendarQuestionWidget(scope,element)}var self=this;return self.create=create,self}function CalendarQuestionWidget(scope,element){function getClassName(){return"CalendarQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<calendar-question></calendar-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("CalendarQuestionWidgetFactory",CalendarQuestionWidgetFactory)}(),function(){"use strict";function checkboxQuestion(CheckboxQuestionWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/survey-item/question/checkbox/checkbox-question.html",link:function(scope,element){scope.widget=CheckboxQuestionWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("checkboxQuestion",checkboxQuestion),checkboxQuestion.$inject=["CheckboxQuestionWidgetFactory"]}(),function(){"use strict";function CheckboxQuestionWidgetFactory(UpdateQuestionEventFactory,CheckboxSuffixIDGenerator,WorkspaceService){function create(scope,element){return new CheckboxQuestionWidget(scope,element,UpdateQuestionEventFactory,CheckboxSuffixIDGenerator,WorkspaceService)}var self=this;return self.create=create,self}function CheckboxQuestionWidget(scope,element,UpdateQuestionEventFactory,CheckboxSuffixIDGenerator,WorkspaceService){function _init(){self.getItem().options.length>0&&_loadAnswerOptions()}function getClassName(){return"CheckboxQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<checkbox-question></checkbox-question>"}function addOption(){self.getItem().createOption(_generateOptionId()),UpdateQuestionEventFactory.create().execute(self.getItem())}function _loadAnswerOptions(){var clonedArray=angular.copy(self.getItem().options);self.getItem().options=[],clonedArray.forEach(function(checkboxAnswerOption){self.getItem().loadJsonOption(JSON.stringify(checkboxAnswerOption))})}function removeLastOption(){self.getItem().removeLastOption(),UpdateQuestionEventFactory.create().execute(self.getItem())}function _generateOptionId(){var checkboxID,quantity=self.getItem().options.length;do checkboxID=self.getItem().customID+CheckboxSuffixIDGenerator.generateSuffixByOptionsLength(quantity++);while(!WorkspaceService.getSurvey().isAvailableCustomID(checkboxID));return checkboxID}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate,self.addOption=addOption,self.removeLastOption=removeLastOption,_init()}angular.module("editor.ui").factory("CheckboxQuestionWidgetFactory",CheckboxQuestionWidgetFactory),CheckboxQuestionWidgetFactory.$inject=["UpdateQuestionEventFactory","CheckboxSuffixIDGenerator","WorkspaceService"]}(),function(){"use strict";function directive(DecimalQuestionWidgetFactory){var ddo={scope:{ngModel:"=",ariaLabel:"@"},templateUrl:"app/editor/ui/survey-item/question/decimal/decimal-question.html",restrict:"E",link:function(scope,element){scope.widget=DecimalQuestionWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("decimalQuestion",directive),directive.$inject=["DecimalQuestionWidgetFactory"]}(),function(){"use strict";function DecimalQuestionWidgetFactory(){function create(scope,element){return new DecimalQuestionWidget(scope,element)}var self=this;return self.create=create,self}function DecimalQuestionWidget(scope,element){function getClassName(){return"DecimalQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<decimal-question></decimal-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("DecimalQuestionWidgetFactory",DecimalQuestionWidgetFactory)}(),function(){"use strict";angular.module("editor.ui").directive("uiDecimal",function(){return{link:function($scope,element,attrs,ngModelCtrl){function shouldPrintChar(event){var keycode=(angular.element(event.currentTarget),event.which);return isNumberKey(keycode)||isValidKey(keycode)}function formatedInteger(event){var element=angular.element(event.currentTarget),keycode=event.which,currentValue=element.val();0===currentValue.length?lastValidValue="":isNumberKey(keycode)||isValidKey(keycode)?lastValidValue=element.val():isValidKey(keycode)||element.val(lastValidValue)}function isNumberKey(keycode){return keycode>=48&&keycode<=57||keycode>=96&&keycode<=105}function isValidKey(keycode){var minusKey=109===keycode,commaKey=188===keycode,dotKey=190===keycode,shiftKey=16===keycode,backspaceKey=8===keycode,homeKey=36===keycode,endKey=35===keycode,deleteKey=46===keycode,controlKey=17===keycode,leftKey=37===keycode,rightKey=39===keycode;return minusKey||commaKey||dotKey||shiftKey||backspaceKey||homeKey||endKey||deleteKey||controlKey||leftKey||rightKey}var lastValidValue;element.on("keydown",shouldPrintChar),element.on("keyup",formatedInteger)}}})}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/email/email-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("emailQuestion",directive)}(),function(){"use strict";function EmailQuestionWidgetFactory(){function create(scope,element){return new EmailQuestionWidget(scope,element)}var self=this;return self.create=create,self}function EmailQuestionWidget(scope,element){function getClassName(){return"EmailQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<email-question></email-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("EmailQuestionWidgetFactory",EmailQuestionWidgetFactory)}(),function(){"use strict";function directive(IntegerQuestionWidgetFactory){var ddo={scope:{ngModel:"=",ariaLabel:"@"},templateUrl:"app/editor/ui/survey-item/question/integer/integer-question.html",restrict:"E",link:function(scope,element){scope.widget=IntegerQuestionWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("integerQuestion",directive),directive.$inject=["IntegerQuestionWidgetFactory"]}(),function(){"use strict";function IntegerQuestionWidgetFactory(){function create(scope,element){return new IntegerQuestionWidget(scope,element)}var self=this;return self.create=create,self}function IntegerQuestionWidget(scope,element){function getClassName(){return"IntegerQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<integer-question></integer-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("IntegerQuestionWidgetFactory",IntegerQuestionWidgetFactory)}(),function(){"use strict";angular.module("editor.ui").directive("uiInteger",function(){return{link:function($scope,element,attrs,ngModelCtrl){function shouldPrintChar(event){var keycode=(angular.element(event.currentTarget),event.which);return isNumberKey(keycode)||isValidKey(keycode)}function formatedInteger(event){var element=angular.element(event.currentTarget),keycode=event.which,currentValue=element.val();0===currentValue.length?lastValidValue="":isNumberKey(keycode)||isValidKey(keycode)?lastValidValue=element.val():isValidKey(keycode)||element.val(lastValidValue)}function isNumberKey(keycode){return keycode>=48&&keycode<=57||keycode>=96&&keycode<=105}function isValidKey(keycode){var minusKey=109===keycode,shiftKey=16===keycode,backspaceKey=8===keycode,homeKey=36===keycode,endKey=35===keycode,deleteKey=46===keycode,controlKey=17===keycode,leftKey=37===keycode,rightKey=39===keycode;return minusKey||shiftKey||backspaceKey||homeKey||endKey||deleteKey||controlKey||leftKey||rightKey}var lastValidValue;element.on("keydown",shouldPrintChar),element.on("keyup",formatedInteger)}}})}(),function(){"use strict";function directive(){var ddo={scope:{ngModel:"=",ariaLabel:"@"},templateUrl:"app/editor/ui/survey-item/question/phone/phone-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("phoneQuestion",directive)}(),function(){"use strict";function PhoneQuestionWidgetFactory(){function create(scope,element){return new PhoneQuestionWidget(scope,element)}var self=this;return self.create=create,self}function PhoneQuestionWidget(scope,element){function getClassName(){return"PhoneQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<phone-question></phone-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("PhoneQuestionWidgetFactory",PhoneQuestionWidgetFactory)}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/text/text-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("textQuestion",directive)}(),function(){"use strict";function TextQuestionWidgetFactory(){function create(scope,element){return new TextQuestionWidget(scope,element)}var self=this;return self.create=create,self}function TextQuestionWidget(scope,element){function getClassName(){return"TextQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<text-question></text-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("TextQuestionWidgetFactory",TextQuestionWidgetFactory)}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/time/time-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("timeQuestion",directive)}(),function(){"use strict";function TimeQuestionWidgetFactory(){function create(scope,element){return new TimeQuestionWidget(scope,element)}var self=this;return self.create=create,self}function TimeQuestionWidget(scope,element){function getClassName(){return"TimeQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<time-question></time-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("TimeQuestionWidgetFactory",TimeQuestionWidgetFactory)}(),function(){"use strict";function otusAlphanumericValidator(AlphanumericValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/alphanumeric/alphanumeric-validator.html",link:function(scope,element){scope.widget=AlphanumericValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusAlphanumericValidator",otusAlphanumericValidator),otusAlphanumericValidator.$inject=["AlphanumericValidatorWidgetFactory"]}(),function(){"use strict";function AlphanumericValidatorWidgetFactory(){function create(scope,element){return new AlphanumericValidator(scope,element)}var self=this;return self.create=create,self}function AlphanumericValidator(scope,element){function _init(){var avaiableRules=parent.fillingRules.options;avaiableRules.hasOwnProperty(whoAmI)&&(self.data=avaiableRules[whoAmI].data.reference)}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return parent.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="alphanumeric";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var parent=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("AlphanumericValidatorWidgetFactory",AlphanumericValidatorWidgetFactory)}(),function(){"use strict";function otusDistinctValidator(DistinctValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/distinct/distinct-validator.html",link:function(scope,element){scope.widget=DistinctValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusDistinctValidator",otusDistinctValidator),otusDistinctValidator.$inject=["DistinctValidatorWidgetFactory"]}(),function(){"use strict";function DistinctValidatorWidgetFactory(){function create(scope,element){return new DistinctValidator(scope,element)}var self=this;return self.create=create,self}function DistinctValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="distinct";self.data,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("DistinctValidatorWidgetFactory",DistinctValidatorWidgetFactory)}(),function(){"use strict";function otusFutureDateValidator(FutureDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/future-date/future-date-validator.html",link:function(scope,element){scope.widget=FutureDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusFutureDateValidator",otusFutureDateValidator),otusFutureDateValidator.$inject=["FutureDateValidatorWidgetFactory"]}(),function(){"use strict";function FutureDateValidatorWidgetFactory(){function create(scope,element){return new FutureDateValidator(scope,element)}var self=this;return self.create=create,self}function FutureDateValidator(scope,element){function _init(){self.data=new Date(question.fillingRules.options[whoAmI].data.reference)}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="futureDate";self.data,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("FutureDateValidatorWidgetFactory",FutureDateValidatorWidgetFactory)}(),function(){"use strict";function otusInValidator(InValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/in/in-validator.html",link:function(scope,element){scope.widget=InValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusInValidator",otusInValidator),otusInValidator.$inject=["InValidatorWidgetFactory"]}(),function(){"use strict";function InValidatorWidgetFactory(){function create(scope,element){return new InValidator(scope,element)}var self=this;return self.create=create,self}function InValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="in";self.data={initial:null,end:null},self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("InValidatorWidgetFactory",InValidatorWidgetFactory)}(),function(){"use strict";function otusLowerCaseValidator(LowerCaseValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/lower-case/lower-case-validator.html",link:function(scope,element){scope.widget=LowerCaseValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusLowerCaseValidator",otusLowerCaseValidator),otusLowerCaseValidator.$inject=["LowerCaseValidatorWidgetFactory"]}(),function(){"use strict";function LowerCaseValidatorWidgetFactory(){function create(scope,element){return new LowerCaseValidator(scope,element)}var self=this;return self.create=create,self}function LowerCaseValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="lowerCase";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("LowerCaseValidatorWidgetFactory",LowerCaseValidatorWidgetFactory)}(),function(){"use strict";function otusLowerLimitValidator(LowerLimitValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/lower-limit/lower-limit-validator.html",link:function(scope,element){scope.widget=LowerLimitValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusLowerLimitValidator",otusLowerLimitValidator),otusLowerLimitValidator.$inject=["LowerLimitValidatorWidgetFactory"]}(),function(){"use strict";function LowerLimitValidatorWidgetFactory(){function create(scope,element){return new LowerLimitValidator(scope,element)}var self=this;return self.create=create,self}function LowerLimitValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="lowerLimit";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("LowerLimitValidatorWidgetFactory",LowerLimitValidatorWidgetFactory)}(),function(){"use strict";function otusMandatoryValidator(MandatoryValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/mandatory/mandatory-validator.html",link:function(scope,element){scope.widget=MandatoryValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMandatoryValidator",otusMandatoryValidator),otusMandatoryValidator.$inject=["MandatoryValidatorWidgetFactory"]}(),function(){"use strict";function MandatoryValidatorWidgetFactory(){function create(scope,element){return new MandatoryValidator(scope,element)}var self=this;return self.create=create,self}function MandatoryValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}var self=this,whoAmI="mandatory";self.data,self.updateData=updateData;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MandatoryValidatorWidgetFactory",MandatoryValidatorWidgetFactory)}(),function(){"use strict";function otusMaxDateValidator(MaxDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/max-date/max-date-validator.html",link:function(scope,element){scope.widget=MaxDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMaxDateValidator",otusMaxDateValidator),
otusMaxDateValidator.$inject=["MaxDateValidatorWidgetFactory"]}(),function(){"use strict";function MaxDateValidatorWidgetFactory(){function create(scope,element){return new MaxDateValidator(scope,element)}var self=this;return self.create=create,self}function MaxDateValidator(scope,element){function _init(){self.data=new Date(question.fillingRules.options[whoAmI].data.reference),updateData()}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="maxDate";self.data=new Date,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MaxDateValidatorWidgetFactory",MaxDateValidatorWidgetFactory)}(),function(){"use strict";function otusMaxLengthValidator(MaxLengthValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/max-length/max-length-validator.html",link:function(scope,element){scope.widget=MaxLengthValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMaxLengthValidator",otusMaxLengthValidator),otusMaxLengthValidator.$inject=["MaxLengthValidatorWidgetFactory"]}(),function(){"use strict";function MaxLengthValidatorWidgetFactory(){function create(scope,element){return new MaxLengthValidator(scope,element)}var self=this;return self.create=create,self}function MaxLengthValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="maxLength";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MaxLengthValidatorWidgetFactory",MaxLengthValidatorWidgetFactory)}(),function(){"use strict";function otusMaxTimeValidator(MaxTimeValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/max-time/max-time-validator.html",link:function(scope,element){scope.widget=MaxTimeValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMaxTimeValidator",otusMaxTimeValidator),otusMaxTimeValidator.$inject=["MaxTimeValidatorWidgetFactory"]}(),function(){"use strict";function MaxTimeValidatorWidgetFactory(){function create(scope,element){return new MaxTimeValidator(scope,element)}var self=this;return self.create=create,self}function MaxTimeValidator(scope,element){function _init(){var referenceValue=question.fillingRules.options[whoAmI].data.reference;""!==referenceValue?self.data=new Date(referenceValue):(self.data.setHours("01"),self.data.setMinutes("00"),self.data.setSeconds("00"),self.data.setMilliseconds("00")),self.updateData()}function updateData(){self.data&&(getRuleType().data.reference=self.data.toString(),scope.$parent.widget.updateFillingRules())}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="maxTime";self.data=new Date,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MaxTimeValidatorWidgetFactory",MaxTimeValidatorWidgetFactory)}(),function(){"use strict";function otusMinDateValidator(MinDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/min-date/min-date-validator.html",link:function(scope,element){scope.widget=MinDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMinDateValidator",otusMinDateValidator),otusMinDateValidator.$inject=["MinDateValidatorWidgetFactory"]}(),function(){"use strict";function MinDateValidatorWidgetFactory(){function create(scope,element){return new MinDateValidator(scope,element)}var self=this;return self.create=create,self}function MinDateValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=new Date(avaiableRules[whoAmI].data.reference),self.updateData()}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="minDate";self.data=(new Date).toLocaleDateString(),self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MinDateValidatorWidgetFactory",MinDateValidatorWidgetFactory)}(),function(){"use strict";function otusMinLengthValidator(MinLengthValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/min-length/min-length-validator.html",link:function(scope,element){scope.widget=MinLengthValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMinLengthValidator",otusMinLengthValidator),otusMinLengthValidator.$inject=["MinLengthValidatorWidgetFactory"]}(),function(){"use strict";function MinLengthValidatorWidgetFactory(){function create(scope,element){return new MinLengthValidator(scope,element)}var self=this;return self.create=create,self}function MinLengthValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="minLength";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MinLengthValidatorWidgetFactory",MinLengthValidatorWidgetFactory)}(),function(){"use strict";function otusMinTimeValidator(MinTimeValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/min-time/min-time-validator.html",link:function(scope,element){scope.widget=MinTimeValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMinTimeValidator",otusMinTimeValidator),otusMinTimeValidator.$inject=["MinTimeValidatorWidgetFactory"]}(),function(){"use strict";function MinTimeValidatorWidgetFactory(){function create(scope,element){return new MinTimeValidator(scope,element)}var self=this;return self.create=create,self}function MinTimeValidator(scope,element){function _init(){var referenceValue=question.fillingRules.options[whoAmI].data.reference;""!==referenceValue?self.data=new Date(referenceValue):(self.data.setHours("01"),self.data.setMinutes("00"),self.data.setSeconds("00"),self.data.setMilliseconds("00")),self.updateData()}function updateData(){self.data&&(getRuleType().data.reference=self.data.toString(),scope.$parent.widget.updateFillingRules())}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="minTime";self.data=new Date("Fri Mar 25 2015 09:56:24 GMT+0100 (Tokyo Time)"),self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MinTimeValidatorWidgetFactory",MinTimeValidatorWidgetFactory)}(),function(){"use strict";function otusParameterValidator(ParameterValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/parameter/parameter-validator.html",link:function(scope,element){scope.widget=ParameterValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusParameterValidator",otusParameterValidator),otusParameterValidator.$inject=["ParameterValidatorWidgetFactory"]}(),function(){"use strict";function ParameterValidatorWidgetFactory(){function create(scope,element){return new ParameterValidator(scope,element)}var self=this;return self.create=create,self}function ParameterValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;avaiableRules.hasOwnProperty(whoAmI)&&(self.data=avaiableRules[whoAmI].data.reference)}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="parameter";self.data="",self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("ParameterValidatorWidgetFactory",ParameterValidatorWidgetFactory)}(),function(){"use strict";function otusPastDateValidator(PastDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/past-date/past-date-validator.html",link:function(scope,element){scope.widget=PastDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusPastDateValidator",otusPastDateValidator),otusPastDateValidator.$inject=["PastDateValidatorWidgetFactory"]}(),function(){"use strict";function PastDateValidatorWidgetFactory(){function create(scope,element){return new PastDateValidator(scope,element)}var self=this;return self.create=create,self}function PastDateValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=new Date(avaiableRules[whoAmI].data.reference),self.updateData()}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="pastDate";self.data=new Date,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("PastDateValidatorWidgetFactory",PastDateValidatorWidgetFactory)}(),function(){"use strict";function otusPrecisionValidator(PrecisionValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/precision/precision-validator.html",link:function(scope,element){scope.widget=PrecisionValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusPrecisionValidator",otusPrecisionValidator),otusPrecisionValidator.$inject=["PrecisionValidatorWidgetFactory"]}(),function(){"use strict";function PrecisionValidatorWidgetFactory(){function create(scope,element){return new PrecisionValidator(scope,element)}var self=this;return self.create=create,self}function PrecisionValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="precision";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("PrecisionValidatorWidgetFactory",PrecisionValidatorWidgetFactory)}(),function(){"use strict";function otusScaleValidator(ScaleValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/scale/scale-validator.html",link:function(scope,element){scope.widget=ScaleValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusScaleValidator",otusScaleValidator),otusScaleValidator.$inject=["ScaleValidatorWidgetFactory"]}(),function(){"use strict";function ScaleValidatorWidgetFactory(){function create(scope,element){return new ScaleValidator(scope,element)}var self=this;return self.create=create,self}function ScaleValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="scale";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("ScaleValidatorWidgetFactory",ScaleValidatorWidgetFactory)}(),function(){"use strict";function otusRangeDateValidator(RangeDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/range-date/range-date-validator.html",link:function(scope,element){scope.widget=RangeDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusRangeDateValidator",otusRangeDateValidator),otusRangeDateValidator.$inject=["RangeDateValidatorWidgetFactory"]}(),function(){"use strict";function RangeDateValidatorWidgetFactory(){function create(scope,element){return new RangeDateValidator(scope,element)}var self=this;return self.create=create,self}function RangeDateValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data.initial=new Date(avaiableRules[whoAmI].data.reference.initial),self.data.end=new Date(avaiableRules[whoAmI].data.reference.end),self.updateData()}function updateData(){getRuleType().data.reference.initial=self.data.initial.toLocaleDateString(),getRuleType().data.reference.end=self.data.end.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="rangeDate";self.data={initial:new Date,end:new Date},self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("RangeDateValidatorWidgetFactory",RangeDateValidatorWidgetFactory)}(),function(){"use strict";function otusSpecialsValidator(SpecialsValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/specials/specials-validator.html",link:function(scope,element){scope.widget=SpecialsValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusSpecialsValidator",otusSpecialsValidator),otusSpecialsValidator.$inject=["SpecialsValidatorWidgetFactory"]}(),function(){"use strict";function SpecialsValidatorWidgetFactory(){function create(scope,element){return new SpecialsValidator(scope,element)}var self=this;return self.create=create,self}function SpecialsValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="specials";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("SpecialsValidatorWidgetFactory",SpecialsValidatorWidgetFactory)}();!function(){"use strict";function otusUpperCaseValidator(UpperCaseValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/upper-case/upper-case-validator.html",link:function(scope,element){scope.widget=UpperCaseValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusUpperCaseValidator",otusUpperCaseValidator),otusUpperCaseValidator.$inject=["UpperCaseValidatorWidgetFactory"]}();!function(){"use strict";function UpperCaseValidatorWidgetFactory(){function create(scope,element){return new UpperCaseValidator(scope,element)}var self=this;return self.create=create,self}function UpperCaseValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="upperCase";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("UpperCaseValidatorWidgetFactory",UpperCaseValidatorWidgetFactory)}(),function(){"use strict";function otusUpperLimitValidator(UpperLimitValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/upper-limit/upper-limit-validator.html",link:function(scope,element){scope.widget=UpperLimitValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusUpperLimitValidator",otusUpperLimitValidator),otusUpperLimitValidator.$inject=["UpperLimitValidatorWidgetFactory"]}(),function(){"use strict";function UpperLimitValidatorWidgetFactory(){function create(scope,element){return new UpperLimitValidator(scope,element)}var self=this;return self.create=create,self}function UpperLimitValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="upperLimit";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("UpperLimitValidatorWidgetFactory",UpperLimitValidatorWidgetFactory)}(),function(){"use strict";function directive(SingleSelectionQuestionWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/survey-item/question/single-selection/group/single-selection-question.html",link:function(scope){scope.widget=scope.$parent.widget}};return ddo}angular.module("editor.ui").directive("singleSelectionQuestion",directive),directive.$inject=["SingleSelectionQuestionWidgetFactory"]}(),function(){"use strict";function SingleSelectionQuestionWidgetFactory(AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory){function create(scope,element){return new SingleSelectionQuestionWidget(scope,element,AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory)}var self=this;return self.create=create,self}function SingleSelectionQuestionWidget(scope,element,AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory){function _init(){self.getItem().options.length>0&&_loadAnswerOptions()}function getClassName(){return"SingleSelectionQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<single-selection-question></single-selection-question>"}function addOption(){var newOption=AddAnswerOptionEventFactory.create().execute(self),optionWidget=AnswerOptionWidgetFactory.create(newOption,self);self.options.push(optionWidget)}function _loadAnswerOptions(){self.getItem().options.forEach(function(awswerOption){var optionWidget=AnswerOptionWidgetFactory.create(awswerOption,self);self.options.push(optionWidget)})}function removeLastOption(){RemoveAnswerOptionEventFactory.create().execute(self),self.options.splice(-1)}var self=this;self.options=[],self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate,self.addOption=addOption,self.removeLastOption=removeLastOption,_init()}angular.module("editor.ui").factory("SingleSelectionQuestionWidgetFactory",SingleSelectionQuestionWidgetFactory),SingleSelectionQuestionWidgetFactory.$inject=["AnswerOptionWidgetFactory","AddAnswerOptionEventFactory","RemoveAnswerOptionEventFactory"]}(),function(){"use strict";function AnswerOptionWidgetFactory(){function create(option,parentGroup){return new AnswerOptionWidget(option,parentGroup)}var self=this;return self.create=create,self}function AnswerOptionWidget(option,parentGroup){var self=this;self.name="AnswerOption",self.parentGroup=parentGroup,self.option=option}angular.module("editor.ui").factory("AnswerOptionWidgetFactory",AnswerOptionWidgetFactory)}();