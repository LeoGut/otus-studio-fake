!function(){angular.module("studio",["dependencies","studio.dashboard","studio.authenticator","editor","otusjs","preview","surveyTemplates","ui.components","utils","otusjs.player.core","otusjs.player.component"])}(),function(){"use strict";angular.module("studio.authenticator",[])}(),function(){"use strict";function LoginController($scope,DashboardStateService,AuthenticationService){function authenticate(user){AuthenticationService.login(user)}function visitAccess(){DashboardStateService.goToHome()}var self=this;self.authenticate=authenticate,self.visitAccess=visitAccess}angular.module("studio.authenticator").controller("LoginController",LoginController),LoginController.$inject=["$scope","DashboardStateService","AuthenticationService"]}(),function(){angular.module("dependencies",["ngMaterial","ngMessages","ngAnimate","ui.router","lokijs","indexedDB","immutable","ui.utils.masks","otusDomainClient"])}(),function(){function localeConfiguration($mdDateLocaleProvider){$mdDateLocaleProvider.formatDate=function(date){return moment(date).format("DD/MM/YYYY")},$mdDateLocaleProvider.parseDate=function(dateString){var m=moment(dateString,"DD/MM/YYYY",!0);return m.isValid()?m.toDate():new Date(NaN)}}angular.module("studio").config(["$mdDateLocaleProvider",localeConfiguration])}(),function(){function stateConfiguration($stateProvider,$urlRouterProvider,$locationProvider){var dashboardMenu="app/dashboard/menu/dashboard-menu.html";$stateProvider.state("login",{url:"/login",views:{"system-wrap":{templateUrl:"app/authenticator/login.html",controller:"LoginController as loginController"}}}).state("home",{url:"/home",views:{"system-wrap":{templateUrl:"app/dashboard/main-dashboard-content-template.html",controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@home":{templateUrl:dashboardMenu},"system-content@home":{templateUrl:"app/dashboard/home/layout-template.html"},"section-info@home":{templateUrl:"app/dashboard/home/home-info-section.html"},"section-view@home":{templateUrl:"app/dashboard/home/home-view-section.html"},"section-commands@home":{templateUrl:"app/dashboard/home/home-commands-section.html"}}}).state("survey-templates",{url:"/survey-templates",views:{"system-wrap":{templateUrl:"app/dashboard/main-dashboard-content-template.html",controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@survey-templates":{templateUrl:dashboardMenu},"system-content@survey-templates":{templateUrl:"app/dashboard/survey-templates/layout-template.html",controller:"SurveyFormDashboardController as surveyFormDashboard"},"section-view@survey-templates":{templateUrl:"app/dashboard/survey-templates/survey-form-view-section.html",controller:"SurveyFormDashboardController as surveyFormDashboard"},"template-menu@survey-templates":{templateUrl:"app/dashboard/survey-templates/menu/md-fab.html"}}}).state("editor",{url:"/editor",params:{template:null},views:{"system-wrap":{templateUrl:"app/dashboard/main-dashboard-content-template.html",controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@editor":{templateUrl:dashboardMenu},"system-content@editor":{templateUrl:"app/editor/ui/main/main-container.html",controller:"MainContainerController as mainContainer",resolve:{executor:function(SurveyEditorService){},editor:function($stateParams,SurveyEditorService,CrossSessionDatabaseService,$window,$q){function _loadFromIndexedDB(){var promise=CrossSessionDatabaseService.findSurveyTemplateByOID(surveyTemplate_OID);promise.then(function(result){$stateParams.template=result.template,_startEditor($stateParams.template),deferred.resolve(!0)})}function _startEditor(surveyTemplate){SurveyEditorService.startEditorWithSurveyTemplate(surveyTemplate)}var surveyTemplate_OID=$window.sessionStorage.getItem("surveyTemplate_OID");if($stateParams.template)_startEditor($stateParams.template);else if(surveyTemplate_OID){var deferred=$q.defer();return _loadFromIndexedDB(),deferred.promise}}}}}}),$urlRouterProvider.otherwise("/login")}angular.module("studio").config(["$stateProvider","$urlRouterProvider","$locationProvider",stateConfiguration]).constant("APP_STATE",{HOME:"home",SURVEY_TEMPLATES:"survey-templates",EDITOR:"editor",LOGIN:"login"})}(),function(){function themeConfiguration($mdThemingProvider,$mdIconProvider){$mdThemingProvider.theme("layoutTheme").primaryPalette("blue",{default:"A200","hue-1":"200","hue-2":"50","hue-3":"700"}).accentPalette("blue-grey",{default:"900","hue-1":"50"}).warnPalette("red"),$mdThemingProvider.theme("greyTheme").primaryPalette("grey"),$mdIconProvider.defaultIconSet("app/assets/img/icons/mdi.svg",24)}angular.module("studio").config(["$mdThemingProvider","$mdIconProvider",themeConfiguration])}(),function(){"use strict";angular.module("studio.dashboard",[])}(),function(){"use strict";angular.module("editor",["editor.core","editor.database","editor.ui","editor.workspace"])}(),function(){"use strict";angular.module("preview",["preview.navigation"])}(),function(){"use strict";function AuthenticationService(LogoutDialogService,DashboardStateService,RestResourceService,$mdToast,$window){function logout(){LogoutDialogService.showDialog().onConfirm(function(){invalidateSession(RestResourceService)})}function invalidateSession(domainRestResourceService){var authenticatorResource=domainRestResourceService.getAuthenticatorResource();domainRestResourceService.isLogged()?invalidateSessionLoggedUser(authenticatorResource):invalidateSessionVisitant()}function invalidateSessionLoggedUser(authenticatorResource){authenticatorResource.invalidate(function(response){DashboardStateService.logout(),$window.sessionStorage.clear()})}function invalidateSessionVisitant(){$window.sessionStorage.clear(),DashboardStateService.logout()}function login(user){RestResourceService.setUrl(user.domain);var authenticatorResource=RestResourceService.getAuthenticatorResource();authenticatorResource.authenticate(user,function(response){RestResourceService.setSecurityToken(response.data),response.hasErrors?$mdToast.show($mdToast.simple().textContent(LOGIN_ERROR_MESSAGE)):DashboardStateService.goToHome()})}var LOGIN_ERROR_MESSAGE="Login Inválido! Verifique os dados informados.",self=this;self.logout=logout,self.login=login}angular.module("studio.authenticator").service("AuthenticationService",AuthenticationService),AuthenticationService.$inject=["LogoutDialogService","DashboardStateService","RestResourceService","$mdToast","$window"]}(),function(){"use strict";function DashboardStateService($state,$http,APP_STATE){function init(){self.currentState="Home"}function goToLogin(){self.currentState="Login",$state.go(APP_STATE.LOGIN)}function goToHome(){self.currentState="Home",$state.go(APP_STATE.HOME)}function goToFormTemplates(){self.currentState="SurveyTemplates",$state.go(APP_STATE.SURVEY_TEMPLATES)}function goToEditor(){self.currentState="Edição de Formulário",$state.go(APP_STATE.EDITOR)}function goToEditorWithSurveyTemplate(surveyTemplate){self.currentState="Edição de Formulário",$state.go(APP_STATE.EDITOR,{template:surveyTemplate})}function logout(){goToLogin()}var self=this;self.goToLogin=goToLogin,self.goToHome=goToHome,self.goToFormTemplates=goToFormTemplates,self.goToEditor=goToEditor,self.logout=logout,self.goToEditorWithSurveyTemplate=goToEditorWithSurveyTemplate,init()}angular.module("studio.dashboard").service("DashboardStateService",DashboardStateService),DashboardStateService.$inject=["$state","$http","APP_STATE"]}(),function(){"use strict";function HomeController($http,$scope,$rootScope){var $HTTP_GET_URL_LOGGED_USER=window.location.origin+"/otus-domain-rest/session/rest/register/loggedUser";$scope.loggedUser={},$http.get($HTTP_GET_URL_LOGGED_USER).then(function(response){$scope.loggedUser=response.data.data}),$scope.isAdmin=function(loggedUser){return loggedUser.admin},$scope.isNotAdmin=function(loggedUser){return!loggedUser.admin},$scope.doesNotHasRepository=function(){if($rootScope.repositories)return $rootScope.repositories.length}}angular.module("studio.dashboard").controller("HomeController",HomeController),HomeController.$inject=["$http","$scope","$rootScope"]}(),function(){"use strict";function DashboardMenuController(DashboardStateService,$mdSidenav,AuthenticationService){function getSelectedSystemArea(){return DashboardStateService.currentState}function open(){$mdSidenav("left").toggle()}function close(){$mdSidenav("left").close()}function openHome(){DashboardStateService.goToHome(),close()}function openFormTemplates(){DashboardStateService.goToFormTemplates(),close()}function logout(){AuthenticationService.logout()}var self=this;self.getSelectedSystemArea=getSelectedSystemArea,self.open=open,self.close=close,self.openHome=openHome,self.openFormTemplates=openFormTemplates,self.logout=logout}angular.module("studio.dashboard").controller("DashboardMenuController",DashboardMenuController),DashboardMenuController.$inject=["DashboardStateService","$mdSidenav","AuthenticationService"]}(),function(){"use strict";function SurveyFormDashboardController(NewSurveyFormDialogService,DashboardStateService,SurveyEditorService){function startNewSurveyForm(){NewSurveyFormDialogService.showDialog().onConfirm(function(workInitializationData){SurveyEditorService.startEditor(workInitializationData),DashboardStateService.goToEditor()})}var self=this;self.startNewSurveyForm=startNewSurveyForm}angular.module("studio.dashboard").controller("SurveyFormDashboardController",SurveyFormDashboardController),SurveyFormDashboardController.$inject=["NewSurveyFormDialogService","DashboardStateService","SurveyEditorService"]}(),function(){"use strict";angular.module("surveyTemplates",[])}(),function(){"use strict";function SurveyEditorService(WorkspaceService){function startEditor(initializationData){WorkspaceService.initializeWorkspace({owner:"visitor"}),WorkspaceService.startNewWork(initializationData)}function startEditorWithSurveyTemplate(surveyTemplate){WorkspaceService.initializeWorkspace({owner:"visitor"}),WorkspaceService.loadWork(surveyTemplate)}var self=this;self.startEditor=startEditor,self.startEditorWithSurveyTemplate=startEditorWithSurveyTemplate}angular.module("editor").service("SurveyEditorService",SurveyEditorService),SurveyEditorService.$inject=["WorkspaceService"]}(),function(){"use strict";angular.module("editor.core",[])}(),function(){"use strict";angular.module("editor.database",[]).config(function($indexedDBProvider){$indexedDBProvider.connection("otus-studio").upgradeDatabase(1,function(event,db,tx){var store=db.createObjectStore("survey_template",{keyPath:"template_oid"});store.createIndex("contributor_idx","contributor",{unique:!1})})})}(),function(){"use strict";angular.module("editor.ui",["angular-bind-html-compile"])}(),function(){"use strict";angular.module("editor.workspace",[])}(),function(){"use strict";function EditionPreviewService($stateParams,AddSurveyItemEventFactory,$timeout,$q){function loadSurveyTemplate(){if(_surveyToLoad=$stateParams.template,_surveyToLoad.itemContainer.length>0){self.isLoading=!0;var promise=_renderSurveyTemplate();promise.then(function(value){self.isLoading=!1})}}function _renderSurveyTemplate(){var deferred=$q.defer();return _scope.$$phase&&(AddSurveyItemEventFactory.create().load(_surveyToLoad.itemContainer[0]),_surveyToLoad.itemContainer.splice(0,1),_surveyToLoad.itemContainer.length>0?$timeout(function(){_surveyToLoad.itemContainer.forEach(function(item){AddSurveyItemEventFactory.create().load(item),_scope.$digest()}),deferred.resolve(!0)},1e3):deferred.resolve(!0)),deferred.promise}function isLoadingMode(){return $stateParams.template}function setScope(scope){_scope=scope}var _surveyToLoad,_scope,self=this;self.isLoading=!1,self.setScope=setScope,self.isLoadingMode=isLoadingMode,self.loadSurveyTemplate=loadSurveyTemplate}angular.module("preview").service("EditionPreviewService",EditionPreviewService),EditionPreviewService.$inject=["$stateParams","AddSurveyItemEventFactory","$timeout","$q"]}(),function(){"use strict";function otusSurveyPreviewGenerator(){var ddo={restrict:"A",controller:Controller};return ddo}function Controller($scope,$element,$compile,WorkspaceService){function _generateOtusPreview(){_newScope=$scope.$new(!0),_newScope.surveyTemplate=_getSurveyTemplateObject();var content=$compile(OTUS_SHEET_COMPONENT)(_newScope);$("#survey-preview").append(content)}function _getSurveyTemplateObject(){return JSON.parse(WorkspaceService.getSurvey().toJson())}var _newScope,OTUS_SHEET_COMPONENT='<otus-sheet md-theme="layoutTheme" survey-template="surveyTemplate" layout="column" flex="80"></otus-sheet>';$element.on("click",function(){var otusSheetDOMElement=$("otus-sheet");otusSheetDOMElement[0]&&(otusSheetDOMElement.remove(),_newScope.$destroy()),_generateOtusPreview()})}angular.module("preview").directive("otusSurveyPreviewGenerator",otusSurveyPreviewGenerator),Controller.$inject=["$scope","$element","$compile","WorkspaceService"]}(),function(){"use strict";function GraphFactory(){function create(){return new Graph}var self=this;return self.create=create,self}angular.module("preview.navigation").factory("GraphFactory",GraphFactory)}(),function(){"use strict";function surveyNavigationPreviewGenerator(NavigationPreviewService,WorkspaceService){function link(scope,element,attrs){element.on("click",function(){element.find(DOM_LOCATION_NAVEGATION_GRAPH)&&$(DOM_LOCATION_NAVEGATION_GRAPH).remove();var navigationObject=WorkspaceService.getSurvey().NavigationManager.getNavigationList(),createdGraph=NavigationPreviewService.createGraph(navigationObject);NavigationPreviewService.renderGraph(createdGraph)})}var ddo={restrict:"A",link:link};return ddo}var DOM_LOCATION_NAVEGATION_GRAPH="#survey-navigation-graph > svg:nth-child(1)";angular.module("preview.navigation").directive("surveyNavigationPreviewGenerator",surveyNavigationPreviewGenerator),surveyNavigationPreviewGenerator.$inject=["NavigationPreviewService","WorkspaceService"]}(),function(){"use strict";angular.module("preview.navigation",[])}(),function(){"use strict";var __slice=[].slice;angular.module("indexedDB",[]).provider("$indexedDB",function(){var IDBKeyRange,allTransactions,apiDirection,appendResultsToPromise,applyNeededUpgrades,cursorDirection,db,dbMode,dbName,dbPromise,dbVersion,defaultQueryOptions,errorMessageFor,indexedDB,readyState,upgradesByVersion;indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,IDBKeyRange=window.IDBKeyRange||window.mozIDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,dbMode={readonly:"readonly",readwrite:"readwrite"},readyState={pending:"pending"},cursorDirection={next:"next",nextunique:"nextunique",prev:"prev",prevunique:"prevunique"},apiDirection={ascending:cursorDirection.next,descending:cursorDirection.prev},dbName="",dbVersion=1,db=null,upgradesByVersion={},dbPromise=null,allTransactions=[],defaultQueryOptions={useIndex:void 0,keyRange:null,direction:cursorDirection.next},applyNeededUpgrades=function(oldVersion,event,db,tx,$log){var version;for(version in upgradesByVersion)!upgradesByVersion.hasOwnProperty(version)||oldVersion>=version||($log.log("$indexedDB: Running upgrade : "+version+" from "+oldVersion),upgradesByVersion[version](event,db,tx))},errorMessageFor=function(e){return e.target.readyState===readyState.pending?"Error: Operation pending":e.target.webkitErrorMessage||e.target.error.message||e.target.errorCode},appendResultsToPromise=function(promise,results){return void 0!==results?promise.then(function(){return results}):promise},this.connection=function(databaseName){return dbName=databaseName,this},this.upgradeDatabase=function(newVersion,callback){return upgradesByVersion[newVersion]=callback,dbVersion=Math.max.apply(null,Object.keys(upgradesByVersion)),this},this.$get=["$q","$rootScope","$log",function($q,$rootScope,$log){var DbQ,ObjectStore,Query,Transaction,addTransaction,closeDatabase,createDatabaseConnection,keyRangeForOptions,openDatabase,openTransaction,rejectWithError,validateStoreNames;return rejectWithError=function(deferred){return function(error){return $rootScope.$apply(function(){return deferred.reject(errorMessageFor(error))})}},createDatabaseConnection=function(){var dbReq,deferred;return deferred=$q.defer(),dbReq=indexedDB.open(dbName,parseInt(dbVersion)||1),dbReq.onsuccess=function(){db=dbReq.result,$rootScope.$apply(function(){deferred.resolve(db)})},dbReq.onblocked=dbReq.onerror=rejectWithError(deferred),dbReq.onupgradeneeded=function(event){var tx;db=event.target.result,tx=event.target.transaction,$log.log("$indexedDB: Upgrading database '"+db.name+"' from version "+event.oldVersion+" to version "+event.newVersion+" ..."),applyNeededUpgrades(event.oldVersion,event,db,tx,$log)},deferred.promise},openDatabase=function(){return dbPromise||(dbPromise=createDatabaseConnection())},closeDatabase=function(){return openDatabase().then(function(){return db.close(),db=null,dbPromise=null})},validateStoreNames=function(storeNames){var found,storeName,_i,_len;for(found=!0,_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],found&=db.objectStoreNames.contains(storeName);return found},openTransaction=function(storeNames,mode){return null==mode&&(mode=dbMode.readonly),openDatabase().then(function(){return validateStoreNames(storeNames)?new Transaction(storeNames,mode):$q.reject("Object stores "+storeNames+" do not exist.")})},keyRangeForOptions=function(options){return options.beginKey&&options.endKey?IDBKeyRange.bound(options.beginKey,options.endKey):void 0},addTransaction=function(transaction){return allTransactions.push(transaction.promise),transaction.promise.finally(function(){var index;return index=allTransactions.indexOf(transaction.promise),index>-1?allTransactions.splice(index,1):void 0})},Transaction=function(){function Transaction(storeNames,mode){null==mode&&(mode=dbMode.readonly),this.transaction=db.transaction(storeNames,mode),this.defer=$q.defer(),this.promise=this.defer.promise,this.setupCallbacks()}return Transaction.prototype.setupCallbacks=function(){return this.transaction.oncomplete=function(_this){return function(){return $rootScope.$apply(function(){return _this.defer.resolve("Transaction Completed")})}}(this),this.transaction.onabort=function(_this){return function(error){return $rootScope.$apply(function(){return _this.defer.reject("Transaction Aborted",error)})}}(this),this.transaction.onerror=function(_this){return function(error){return $rootScope.$apply(function(){return _this.defer.reject("Transaction Error",error)})}}(this),addTransaction(this)},Transaction.prototype.objectStore=function(storeName){return this.transaction.objectStore(storeName)},Transaction.prototype.abort=function(){return this.transaction.abort()},Transaction}(),DbQ=function(){function DbQ(){this.q=$q.defer(),this.promise=this.q.promise}return DbQ.prototype.reject=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],$rootScope.$apply(function(_this){return function(){var _ref;return(_ref=_this.q).reject.apply(_ref,args)}}(this))},DbQ.prototype.rejectWith=function(req){return req.onerror=req.onblocked=function(_this){return function(e){return _this.reject(errorMessageFor(e))}}(this)},DbQ.prototype.resolve=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],$rootScope.$apply(function(_this){return function(){var _ref;return(_ref=_this.q).resolve.apply(_ref,args)}}(this))},DbQ.prototype.notify=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],$rootScope.$apply(function(_this){return function(){var _ref;return(_ref=_this.q).notify.apply(_ref,args)}}(this))},DbQ.prototype.dbErrorFunction=function(){return function(_this){return function(error){return $rootScope.$apply(function(){return _this.q.reject(errorMessageFor(error))})}}(this)},DbQ.prototype.resolveWith=function(req){return this.rejectWith(req),req.onsuccess=function(_this){return function(e){return _this.resolve(e.target.result)}}(this)},DbQ}(),ObjectStore=function(){function ObjectStore(storeName,transaction){this.storeName=storeName,this.store=transaction.objectStore(storeName),this.transaction=transaction}return ObjectStore.prototype.defer=function(){return new DbQ},ObjectStore.prototype._mapCursor=function(defer,mapFunc,req){var results;return null==req&&(req=this.store.openCursor()),results=[],defer.rejectWith(req),req.onsuccess=function(e){var cursor;return(cursor=e.target.result)?(results.push(mapFunc(cursor)),defer.notify(mapFunc(cursor)),cursor.continue()):defer.resolve(results)}},ObjectStore.prototype._arrayOperation=function(data,mapFunc){var defer,item,req,results,_i,_len;for(defer=this.defer(),angular.isArray(data)||(data=[data]),_i=0,_len=data.length;_len>_i;_i++)item=data[_i],req=mapFunc(item),results=[],defer.rejectWith(req),req.onsuccess=function(e){return results.push(e.target.result),defer.notify(e.target.result),results.length>=data.length?defer.resolve(results):void 0};return 0===data.length?$q.when([]):defer.promise},ObjectStore.prototype.getAllKeys=function(){var defer,req;return defer=this.defer(),this.store.getAllKeys?(req=this.store.getAllKeys(),defer.resolveWith(req)):this._mapCursor(defer,function(cursor){return cursor.key}),defer.promise},ObjectStore.prototype.clear=function(){var defer,req;return defer=this.defer(),req=this.store.clear(),defer.resolveWith(req),defer.promise},ObjectStore.prototype.delete=function(key){var defer;return defer=this.defer(),defer.resolveWith(this.store.delete(key)),defer.promise},ObjectStore.prototype.upsert=function(data){return this._arrayOperation(data,function(_this){return function(item){return _this.store.put(item)}}(this))},ObjectStore.prototype.insert=function(data){return this._arrayOperation(data,function(_this){return function(item){return _this.store.add(item)}}(this))},ObjectStore.prototype.getAll=function(){var defer;return defer=this.defer(),this.store.getAll?defer.resolveWith(this.store.getAll()):this._mapCursor(defer,function(cursor){return cursor.value}),defer.promise},ObjectStore.prototype.eachWhere=function(query){var defer,direction,indexName,keyRange,req;return defer=this.defer(),indexName=query.indexName,keyRange=query.keyRange,direction=query.direction,req=indexName?this.store.index(indexName).openCursor(keyRange,direction):this.store.openCursor(keyRange,direction),this._mapCursor(defer,function(cursor){return cursor.value},req),defer.promise},ObjectStore.prototype.findWhere=function(query){return this.eachWhere(query)},ObjectStore.prototype.each=function(options){return null==options&&(options={}),this.eachBy(void 0,options)},ObjectStore.prototype.eachBy=function(indexName,options){var q;return null==indexName&&(indexName=void 0),null==options&&(options={}),q=new Query,q.indexName=indexName,q.keyRange=keyRangeForOptions(options),q.direction=options.direction||defaultQueryOptions.direction,this.eachWhere(q)},ObjectStore.prototype.count=function(){var defer;return defer=this.defer(),defer.resolveWith(this.store.count()),defer.promise},ObjectStore.prototype.find=function(key){var defer,req;return defer=this.defer(),req=this.store.get(key),defer.rejectWith(req),req.onsuccess=function(_this){return function(e){return e.target.result?defer.resolve(e.target.result):defer.reject(""+_this.storeName+":"+key+" not found.")}}(this),defer.promise},ObjectStore.prototype.findBy=function(index,key){var defer;return defer=this.defer(),defer.resolveWith(this.store.index(index).get(key)),defer.promise},ObjectStore.prototype.query=function(){return new Query},ObjectStore}(),Query=function(){function Query(){this.indexName=void 0,this.keyRange=void 0,this.direction=cursorDirection.next}return Query.prototype.$lt=function(value){return this.keyRange=IDBKeyRange.upperBound(value,!0),this},Query.prototype.$gt=function(value){return this.keyRange=IDBKeyRange.lowerBound(value,!0),this},Query.prototype.$lte=function(value){return this.keyRange=IDBKeyRange.upperBound(value),this},Query.prototype.$gte=function(value){return this.keyRange=IDBKeyRange.lowerBound(value),this},Query.prototype.$eq=function(value){return this.keyRange=IDBKeyRange.only(value),this},Query.prototype.$between=function(low,hi,exLow,exHi){return null==exLow&&(exLow=!1),null==exHi&&(exHi=!1),this.keyRange=IDBKeyRange.bound(low,hi,exLow,exHi),this},Query.prototype.$desc=function(unique){return this.direction=unique?cursorDirection.prevunique:cursorDirection.prev,this},Query.prototype.$asc=function(unique){return this.direction=unique?cursorDirection.nextunique:cursorDirection.next,this},Query.prototype.$index=function(indexName){return this.indexName=indexName,this},Query}(),{openStore:function(storeName,callBack,mode){return null==mode&&(mode=dbMode.readwrite),openTransaction([storeName],mode).then(function(transaction){var results;return results=callBack(new ObjectStore(storeName,transaction)),appendResultsToPromise(transaction.promise,results)})},openStores:function(storeNames,callback,mode){return null==mode&&(mode=dbMode.readwrite),openTransaction(storeNames,mode).then(function(transaction){var objectStores,results,storeName;return objectStores=function(){var _i,_len,_results;for(_results=[],_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],_results.push(new ObjectStore(storeName,transaction));return _results}(),results=callback.apply(null,objectStores),appendResultsToPromise(transaction.promise,results)})},openAllStores:function(callback,mode){return null==mode&&(mode=dbMode.readwrite),openDatabase().then(function(_this){return function(){var objectStores,results,storeName,storeNames,transaction;return storeNames=Array.prototype.slice.apply(db.objectStoreNames),transaction=new Transaction(storeNames,mode),objectStores=function(){var _i,_len,_results;for(_results=[],_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],_results.push(new ObjectStore(storeName,transaction));return _results}(),results=callback.apply(null,objectStores),appendResultsToPromise(transaction.promise,results)}}(this))},closeDatabase:function(){return closeDatabase()},deleteDatabase:function(){return closeDatabase().then(function(){var defer;return defer=new DbQ,defer.resolveWith(indexedDB.deleteDatabase(dbName)),defer.promise}).finally(function(){return $log.log("$indexedDB: "+dbName+" database deleted.")})},queryDirection:apiDirection,flush:function(){return allTransactions.length>0?$q.all(allTransactions):$q.when([])},databaseInfo:function(){return openDatabase().then(function(){var storeNames,transaction;return transaction=null,storeNames=Array.prototype.slice.apply(db.objectStoreNames),openTransaction(storeNames,dbMode.readonly).then(function(transaction){var store,storeName,stores;return stores=function(){var _i,_len,_results;for(_results=[],_i=0,_len=storeNames.length;_len>_i;_i++)storeName=storeNames[_i],store=transaction.objectStore(storeName),_results.push({name:storeName,keyPath:store.keyPath,autoIncrement:store.autoIncrement,indices:Array.prototype.slice.apply(store.indexNames)});return _results}(),transaction.promise.then(function(){return{name:db.name,version:db.version,objectStores:stores}})})})}}}]})}.call(this),function(){"use strict";function textEditionMenu(){var ddo={templateUrl:"app/shared/text-edition-menu/text-edition-menu-template.html",retrict:"E",link:linkFunc};return ddo}function linkFunc(scope,element,attrs){function bold(){return document.execCommand("bold",!1,null),!1}function italic(){return document.execCommand("italic",!1,null),!1}function underlined(){return document.execCommand("underline",!1,null),!1}function strikeThrough(){return document.execCommand("strikeThrough",!1,null),!1}scope.bold=bold,scope.italic=italic,scope.underlined=underlined,scope.strikeThrough=strikeThrough}angular.module("ui.components").directive("textEditionMenu",textEditionMenu)}(),function(){angular.module("ui.components",[])}(),function(){"use strict";function LogoutDialogService($mdDialog){function init(){self.dialogSettings={parent:angular.element(document.body),templateUrl:"app/dashboard/dialog/logout/logout-dialog.html",controller:DialogController,controllerAs:"controller",openFrom:"#system-toolbar",closeTo:{bottom:0}}}function showDialog(){return $mdDialog.show(self.dialogSettings).then(forwardSuccessfulExecution,forwardUnsuccessfulExecution),{onConfirm:function(callback){self.callback=callback}}}function forwardSuccessfulExecution(response){"confirm"==response.action&&self.callback&&self.callback(response.data)}function forwardUnsuccessfulExecution(){}var self=this;self.showDialog=showDialog,init()}function DialogController($mdDialog){function cancel(response){$mdDialog.hide(response)}function confirm(response){$mdDialog.hide(response)}var self=this;self.cancel=cancel,self.confirm=confirm}angular.module("studio.dashboard").service("LogoutDialogService",LogoutDialogService),LogoutDialogService.$inject=["$mdDialog"]}(),function(){"use strict";function otusToolbar(){var ddo={templateUrl:"app/dashboard/menu/toolbar/menu-toolbar.html",retrict:"E"};return ddo}angular.module("studio.dashboard").directive("otusToolbar",otusToolbar)}(),function(){"use strict";function SelectedSurveyTemplatesManagementService(){function selectSurveyTemplate(template){self.selectedSurveyTemplates.push(template)}function removeSurveyTemplate(template){self.selectedSurveyTemplates.splice(_getSelectedTemplateIndex(template),1)}function hasSelectedSurveyTemplate(){return 0!==self.selectedSurveyTemplates.length}function hasOnlyOneSelectedSurveyTemplate(){return 1===self.selectedSurveyTemplates.length}function _getSelectedTemplateIndex(template){return self.selectedSurveyTemplates.indexOf(template)}var self=this;self.selectedSurveyTemplates=[],self.selectSurveyTemplate=selectSurveyTemplate,self.removeSurveyTemplate=removeSurveyTemplate,self.hasSelectedSurveyTemplate=hasSelectedSurveyTemplate,self.hasOnlyOneSelectedSurveyTemplate=hasOnlyOneSelectedSurveyTemplate}angular.module("surveyTemplates").service("SelectedSurveyTemplatesManagementService",SelectedSurveyTemplatesManagementService)}(),function(){"use strict";function SurveyTemplateManagerService(CrossSessionDatabaseService,SurveyExportService){function initializeSurveyTemplateList(){var promise=CrossSessionDatabaseService.getAllSurveyTemplatesByContributor();promise.then(function(value){self.surveyTemplates=value})}function deleteSurveyTemplate(template){CrossSessionDatabaseService.deleteSurveyTemplate(template.template_oid),_removeOfSurveyTemplatesList(template)}function exportSurveyTemplate(template){return SurveyExportService.exportSurvey(JSON.stringify(template.template))}function editSurveyTemplate(template){}function _getTemplateIndex(template){return self.surveyTemplates.indexOf(template)}function _removeOfSurveyTemplatesList(template){self.surveyTemplates.splice(_getTemplateIndex(template),1)}var self=this;self.surveyTemplates=[],self.initializeSurveyTemplateList=initializeSurveyTemplateList,self.deleteSurveyTemplate=deleteSurveyTemplate,self.exportSurveyTemplate=exportSurveyTemplate,self.editSurveyTemplate=editSurveyTemplate}angular.module("surveyTemplates").service("SurveyTemplateManagerService",SurveyTemplateManagerService),SurveyTemplateManagerService.$inject=["CrossSessionDatabaseService","SurveyExportService"]}(),function(){"use strict";function SurveyTemplateUpload(SurveyTemplateUploadService){function linkFunction($scope,$element,$attrs){function _uploadSurveyTemplate(fileToUpload){SurveyTemplateUploadService.upload(fileToUpload)}function _createInput(){return fileUploadElement=document.createElement("input"),fileUploadElement.setAttribute("type","file"),fileUploadElement.setAttribute("accept",".json"),fileUploadElement}var fileUploadElement;$element.on("click",function(){fileUploadElement=_createInput(),fileUploadElement.click(),fileUploadElement.addEventListener("change",function(){var fileToUpload=this.files[0];_uploadSurveyTemplate(fileToUpload)})})}var ddo={restrict:"A",link:linkFunction};return ddo}angular.module("surveyTemplates").directive("surveyTemplateUpload",SurveyTemplateUpload),
SurveyTemplateUpload.$inject=["SurveyTemplateUploadService"]}(),function(){"use strict";function SurveyTemplateUploadService(CrossSessionDatabaseService,SurveyTemplateManagerService,$mdToast){function upload(fileSurveyTemplate){var reader=new FileReader;reader.readAsText(fileSurveyTemplate),reader.onload=function(){jsonReaded=reader.result;var promise=CrossSessionDatabaseService.insertSurveyTemplate(jsonReaded,{owner:"visitor"});promise.then(function(value){value&&$mdToast.show($mdToast.simple().textContent("Upload realizado com sucesso!"))},function(error){$mdToast.show($mdToast.simple().textContent(_getErrorMessage(error)))}),SurveyTemplateManagerService.initializeSurveyTemplateList()}}function _getErrorMessage(error){var message;switch(error){case"Key already exists in the object store.":message="Esse template já existe.";break;default:message="Ocorreu um erro ao realizar o upload"}return message}var jsonReaded,self=this;self.upload=upload}angular.module("surveyTemplates").service("SurveyTemplateUploadService",SurveyTemplateUploadService),SurveyTemplateUploadService.$inject=["CrossSessionDatabaseService","SurveyTemplateManagerService","$mdToast"]}(),function(){"use strict";function surveyTemplatesExport(SurveyTemplateManagerService,$mdToast,$timeout,SelectedSurveyTemplatesManagementService){var ddo={restrict:"A",link:function(scope,element){element.on("click",function(){SelectedSurveyTemplatesManagementService.selectedSurveyTemplates.forEach(function(template){var downloadElement=document.createElement("a");downloadElement.setAttribute("href",SurveyTemplateManagerService.exportSurveyTemplate(template)),downloadElement.setAttribute("download","surveyTemplate.json"),downloadElement.setAttribute("target","_blank"),downloadElement.click()}),$timeout(function(){$mdToast.show($mdToast.simple().textContent("Template(s) exportado(s) com sucesso!"))},1e3)})}};return ddo}angular.module("surveyTemplates").directive("surveyTemplatesExport",surveyTemplatesExport),surveyTemplatesExport.$inject=["SurveyTemplateManagerService","$mdToast","$timeout","SelectedSurveyTemplatesManagementService"]}(),function(){"use strict";function AddAnswerOptionEventFactory(AddAnswerOptionService,WorkspaceService){function create(){return new AddAnswerOptionEvent(AddAnswerOptionService,WorkspaceService)}var self=this;return self.create=create,self}function AddAnswerOptionEvent(AddAnswerOptionService,WorkspaceService){function execute(eventSource){var option=AddAnswerOptionService.execute(eventSource.getItem());return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),option}var self=this;self.execute=execute}angular.module("editor.core").factory("AddAnswerOptionEventFactory",AddAnswerOptionEventFactory),AddAnswerOptionEventFactory.$inject=["AddAnswerOptionService","WorkspaceService"]}(),function(){"use strict";function AddFillingRulesEventFactory(AddFillingRulesService,WorkspaceService){function create(){return new AddFillingRulesEvent(AddFillingRulesService,WorkspaceService)}var self=this;return self.create=create,self}function AddFillingRulesEvent(AddFillingRulesService,WorkspaceService){function execute(questionReference,validator){var option=AddFillingRulesService.execute(questionReference,validator);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),option}var self=this;self.execute=execute}angular.module("editor.core").factory("AddFillingRulesEventFactory",AddFillingRulesEventFactory),AddFillingRulesEventFactory.$inject=["AddFillingRulesService","WorkspaceService"]}(),function(){"use strict";function AddMetadataAnswerEventFactory(AddMetadataAnswerService,WorkspaceService){function create(){return new AddMetadataAnswerEvent(AddMetadataAnswerService,WorkspaceService)}var self=this;return self.create=create,self}function AddMetadataAnswerEvent(AddMetadataAnswerService,WorkspaceService){function execute(eventSource){var option=AddMetadataAnswerService.execute(eventSource.getItem());return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),option}var self=this;self.execute=execute}angular.module("editor.core").factory("AddMetadataAnswerEventFactory",AddMetadataAnswerEventFactory),AddMetadataAnswerEventFactory.$inject=["AddMetadataAnswerService","WorkspaceService"]}(),function(){"use strict";function AddRouteConditionEventFactory(AddRouteConditionService,WorkspaceService){function create(){return new AddRouteConditionEvent(AddRouteConditionService,WorkspaceService)}var self=this;return self.create=create,self}function AddRouteConditionEvent(AddRouteConditionService,WorkspaceService){function execute(conditionName,route){var routeCondition=AddRouteConditionService.execute(conditionName,route);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),routeCondition}var self=this;self.execute=execute}angular.module("editor.core").factory("AddRouteConditionEventFactory",AddRouteConditionEventFactory),AddRouteConditionEventFactory.$inject=["AddRouteConditionService","WorkspaceService"]}(),function(){"use strict";function AddRouteEventFactory(AddRouteService,WorkspaceService){function create(){return new AddRouteEvent(AddRouteService,WorkspaceService)}var self=this;return self.create=create,self}function AddRouteEvent(AddRouteService,WorkspaceService){function execute(routeData){var route=AddRouteService.execute(routeData);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),route}var self=this;self.execute=execute}angular.module("editor.core").factory("AddRouteEventFactory",AddRouteEventFactory),AddRouteEventFactory.$inject=["AddRouteService","WorkspaceService"]}(),function(){"use strict";function AddRuleEventFactory(AddRuleService,WorkspaceService){function create(){return new AddRuleEvent(AddRuleService,WorkspaceService)}var self=this;return self.create=create,self}function AddRuleEvent(AddRuleService,WorkspaceService){function execute(ruleData,route){var rule=AddRuleService.execute(ruleData,route);return WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork(),rule}var self=this;self.execute=execute}angular.module("editor.core").factory("AddRuleEventFactory",AddRuleEventFactory),AddRuleEventFactory.$inject=["AddRuleService","WorkspaceService"]}(),function(){"use strict";function AddSurveyItemEventFactory($rootScope,WorkspaceService,WidgetService,SheetContentService,AddSurveyItemService,PageAnchorService,$timeout){function create(){return new AddSurveyItemEvent($rootScope,WorkspaceService,WidgetService,SheetContentService,AddSurveyItemService,PageAnchorService,$timeout)}var self=this;return self.create=create,self}function AddSurveyItemEvent($rootScope,WorkspaceService,WidgetService,SheetContentService,AddSurveyItemService,PageAnchorService,$timeout){function execute(itemType){var item=AddSurveyItemService.execute(itemType,WorkspaceService.getSurvey());SheetContentService.loadQuestion(item),$rootScope.$broadcast("item.add",item),WorkspaceService.workspace.currentItem=item,WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}function load(itemToLoad){var newItem=AddSurveyItemService.execute(itemToLoad.objectType,WorkspaceService.getSurvey());newItem.isQuestion()?(newItem.label=itemToLoad.label,newItem.metadata.options=itemToLoad.metadata.options,newItem.fillingRules.options=itemToLoad.fillingRules.options,"SingleSelectionQuestion"!==itemToLoad.objectType&&"CheckboxQuestion"!==itemToLoad.objectType||(newItem.options=itemToLoad.options),"DecimalQuestion"!==itemToLoad.objectType&&"IntegerQuestion"!==itemToLoad.objectType||(newItem.unit=itemToLoad.unit)):"ImageItem"===itemToLoad.objectType?(newItem.url=itemToLoad.url,newItem.footer=itemToLoad.footer):newItem.value=itemToLoad.value,SheetContentService.loadQuestion(newItem),$rootScope.$broadcast("item.add",newItem),WorkspaceService.workspace.currentItem=newItem}var self=this;self.execute=execute,self.load=load}angular.module("editor.core").factory("AddSurveyItemEventFactory",AddSurveyItemEventFactory),AddSurveyItemEventFactory.$inject=["$rootScope","WorkspaceService","WidgetService","SheetContentService","AddSurveyItemService","PageAnchorService","$timeout"]}(),function(){"use strict";function RemoveAnswerOptionEventFactory(RemoveAnswerOptionService,WorkspaceService){function create(){return new RemoveAnswerOptionEvent(RemoveAnswerOptionService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveAnswerOptionEvent(RemoveAnswerOptionService,WorkspaceService){function execute(eventSource){RemoveAnswerOptionService.execute(eventSource.getItem()),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveAnswerOptionEventFactory",RemoveAnswerOptionEventFactory),RemoveAnswerOptionEventFactory.$inject=["RemoveAnswerOptionService","WorkspaceService"]}(),function(){"use strict";function RemoveFillingRulesEventFactory(RemoveFillingRulesWorkService,WorkspaceService){function create(){return new RemoveFillingRulesEvent(RemoveFillingRulesWorkService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveFillingRulesEvent(RemoveFillingRulesWorkService,WorkspaceService){function execute(questionSource,fillingRuleType){RemoveFillingRulesWorkService.execute(questionSource.getItem(),fillingRuleType),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveFillingRulesEventFactory",RemoveFillingRulesEventFactory),RemoveFillingRulesEventFactory.$inject=["RemoveFillingRulesWorkService","WorkspaceService"]}(),function(){"use strict";function RemoveMetadataOptionEventFactory(RemoveMetadataOptionService,WorkspaceService){function create(){return new RemoveMetadataOptionEvent(RemoveMetadataOptionService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveMetadataOptionEvent(RemoveMetadataOptionService,WorkspaceService){function execute(eventSource){RemoveMetadataOptionService.execute(eventSource.getItem()),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveMetadataOptionEventFactory",RemoveMetadataOptionEventFactory),RemoveMetadataOptionEventFactory.$inject=["RemoveMetadataOptionService","WorkspaceService"]}(),function(){"use strict";function RemoveRouteEventFactory(RemoveRouteService,WorkspaceService){function create(){return new RemoveRouteEvent(RemoveRouteService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveRouteEvent(RemoveRouteService,WorkspaceService){function execute(routeData){RemoveRouteService.execute(routeData),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveRouteEventFactory",RemoveRouteEventFactory),RemoveRouteEventFactory.$inject=["RemoveRouteService","WorkspaceService"]}(),function(){"use strict";function RemoveRuleEventFactory(RemoveRuleService,WorkspaceService){function create(){return new RemoveRuleEvent(RemoveRuleService,WorkspaceService)}var self=this;return self.create=create,self}function RemoveRuleEvent(RemoveRuleService,WorkspaceService){function execute(rule,route){RemoveRuleService.execute(rule,route),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveRuleEventFactory",RemoveRuleEventFactory),RemoveRuleEventFactory.$inject=["RemoveRuleService","WorkspaceService"]}(),function(){"use strict";function RemoveSurveyItemEventFactory($rootScope,WorkspaceService,RemoveSurveyItemService){function create(){return new RemoveSurveyItemEvent($rootScope,WorkspaceService,RemoveSurveyItemService)}var self=this;return self.create=create,self}function RemoveSurveyItemEvent($rootScope,WorkspaceService,RemoveSurveyItemService){function execute(item){RemoveSurveyItemService.execute(item,WorkspaceService.getSurvey()),$rootScope.$broadcast("item.remove."+item.templateID,item),WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("RemoveSurveyItemEventFactory",RemoveSurveyItemEventFactory),RemoveSurveyItemEventFactory.$inject=["$rootScope","WorkspaceService","RemoveSurveyItemService"]}(),function(){"use strict";function UpdateFillingRulesEventFactory(WorkspaceService){function create(){return new UpdateFillingRulesEvent(WorkspaceService)}var self=this;return self.create=create,self}function UpdateFillingRulesEvent(WorkspaceService){function execute(){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateFillingRulesEventFactory",UpdateFillingRulesEventFactory),UpdateFillingRulesEventFactory.$inject=["WorkspaceService"]}(),function(){"use strict";function UpdateQuestionEventFactory(SheetContentService,WorkspaceService){function create(){return new UpdateQuestionEvent(SheetContentService,WorkspaceService)}var self=this;return self.create=create,self}function UpdateQuestionEvent(SheetContentService,WorkspaceService){function execute(data){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateQuestionEventFactory",UpdateQuestionEventFactory),UpdateQuestionEventFactory.$inject=["SheetContentService","WorkspaceService"]}(),function(){"use strict";function UpdateRouteEventFactory(WorkspaceService){function create(){return new UpdateRouteEvent(WorkspaceService)}var self=this;return self.create=create,self}function UpdateRouteEvent(WorkspaceService){function execute(eventSource){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateRouteEventFactory",UpdateRouteEventFactory),UpdateRouteEventFactory.$inject=["WorkspaceService"]}(),function(){"use strict";function UpdateRuleEventFactory(WorkspaceService){function create(){return new UpdateRuleEvent(WorkspaceService)}var self=this;return self.create=create,self}function UpdateRuleEvent(WorkspaceService){function execute(eventSource){WorkspaceService.workspace.isdb.userEdits.store(self),WorkspaceService.saveWork()}var self=this;self.execute=execute}angular.module("editor.core").factory("UpdateRuleEventFactory",UpdateRuleEventFactory),UpdateRuleEventFactory.$inject=["WorkspaceService"]}(),function(){"use strict";function CrossSessionDatabaseService($q,$indexedDB,InsertHelperService){function saveSurveyTemplateRevision(template,session){$indexedDB.openStore(STORE_NAME,function(store){var entry={};entry.template_oid=template.oid,entry.contributor=session.owner,entry.template=JSON.parse(template.toJson()),store.upsert(entry).then(function(e){})})}function insertSurveyTemplate(template,session){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){var parsedTemplate=JSON.parse(template),entry={};entry.template_oid=parsedTemplate.oid,entry.contributor=session.owner,entry.template=parsedTemplate,store.insert(entry).then(function(success){defer.resolve(success)},function(error){defer.reject(error)})}),defer.promise}function getAllSurveyTemplates(){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){store.getAll().then(function(templates){defer.resolve(templates)})}),defer.promise}function getAllSurveyTemplatesByContributor(){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){var criteria=store.query();criteria=criteria.$eq("visitor"),criteria=criteria.$index(INDEX),store.eachWhere(criteria).then(function(templates){defer.resolve(templates)})}),defer.promise}function deleteSurveyTemplate(templateOID){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){store.delete(templateOID).then(function(){defer.resolve(!0)})}),defer.promise}function findSurveyTemplateByOID(oid){var defer=$q.defer();return $indexedDB.openStore(STORE_NAME,function(store){store.find(oid).then(function(template){defer.resolve(template)})}),defer.promise}var self=this,STORE_NAME="survey_template",INDEX="contributor_idx";self.saveSurveyTemplateRevision=saveSurveyTemplateRevision,self.getAllSurveyTemplates=getAllSurveyTemplates,self.getAllSurveyTemplatesByContributor=getAllSurveyTemplatesByContributor,self.deleteSurveyTemplate=deleteSurveyTemplate,self.insertSurveyTemplate=insertSurveyTemplate,self.findSurveyTemplateByOID=findSurveyTemplateByOID}angular.module("editor.database").service("CrossSessionDatabaseService",CrossSessionDatabaseService),CrossSessionDatabaseService.$inject=["$q","$indexedDB","InsertHelperService"]}(),function(){"use strict";function InsertHelperService(){function cloneObject(object){var clone={};return Object.keys(object).forEach(function(key){var property=object[key];property instanceof Function&&(clone[key]=property)}),clone}var self=this;self.cloneObject=cloneObject}angular.module("editor.database").service("InsertHelperService",InsertHelperService)}(),function(){"use strict";function InSessionDatabaseFactory(Loki){function create(){return new InSessionDatabase(Loki)}var self=this;return self.create=create,self}function InSessionDatabase(Loki){function init(){instance=new Loki("in-session-db.json"),self[USER_EDITS_COLLECTION]=new CollectionFacade(instance.addCollection(USER_EDITS_COLLECTION)),self[DATA_POOL_COLLECTION]=new CollectionFacade(instance.addCollection(DATA_POOL_COLLECTION))}var self=this,instance=null,USER_EDITS_COLLECTION="userEdits",DATA_POOL_COLLECTION="dataPool";init()}function CollectionFacade(collectionReference){function init(){Object.defineProperty(self,"collection",{value:collectionReference,writable:!1})}function store(data){self.collection.insert(data)}function storeUnique(data){var event=fetchEventBy("id",data.source.id);event?(remove(event),store(data)):self.collection.insert(data)}function fetchEventBy(attribute,value){var data=self.collection.chain().where(function(obj){return getModelValue(attribute,obj)===value}).simplesort("$loki","isdesc").data();return data}function fetchLastSelectEvent(){var data=self.collection.chain().where(function(event){return event.type.isSelectData()}).simplesort("$loki","isdesc").data();return data[0]}function fetchLastAddedData(){var data=self.collection.chain().simplesort("$loki","isdesc").data();return data[0]}function remove(data){self.collection.remove(data)}function getModelValue(modelpath,model){var pathArray=modelpath.split("."),modelValue=model;return pathArray.forEach(function(path){modelValue=modelValue[path]}),modelValue}var self=this;self.store=store,self.fetchEventBy=fetchEventBy,self.fetchLastSelectEvent=fetchLastSelectEvent,self.fetchLastAddedData=fetchLastAddedData,self.storeUnique=storeUnique,init()}angular.module("editor.database").factory("InSessionDatabaseFactory",InSessionDatabaseFactory),InSessionDatabaseFactory.$inject=["Loki"]}(),function(){"use strict";function mpath(){function getWidgetPath(directive){return MODULE.concat("core/question/".concat(directive).concat("/".concat(directive.concat("-question-template.html"))))}function getQuestionEditorWidgetPath(){return QUESTION_EDITOR_TEMPLATE}function getMetadataWidgetPath(){return METADATA_TEMPLATE}var self=this,MODULE="app/editor/ui/",QUESTION_EDITOR_TEMPLATE="app/editor/ui/core/survey-item-editor/survey-item-editor.html",METADATA_TEMPLATE="app/editor/ui/core/metadata/metadata-question-template.html";self.getWidgetPath=getWidgetPath,self.getQuestionEditorWidgetPath=getQuestionEditorWidgetPath,self.getMetadataWidgetPath=getMetadataWidgetPath}angular.module("editor.ui").service("editor.ui.mpath",mpath)}(),function(){"use strict";function UiBindingService(){function setScope(scope){scope.$on("otusWidgetPreLoad",function(event){}),scope.$on("otusWidgetBinding",function(event){})}var self=this;self.setScope=setScope}angular.module("editor.ui").service("UiBindingService",UiBindingService)}(),function(){"use strict";function WidgetService(WidgetTemplateService,SurveyItemWidgetFactory,SurveyItemEditorWidgetFactory,AnswerOptionWidgetFactory,MetadataGroupWidgetFactory,MetadataOptionWidgetFactory,NavigationWidgetFactory,RouteEditorWidgetFactory,RouteCreatorWidgetFactory){function getWidgetForModel(model){var widget=SurveyItemWidgetFactory.create(model);return widget.template=WidgetTemplateService.getDirectiveTemplate(model.objectType),widget}function getMetadataWidget(model){var widget=MetadataGroupWidgetFactory.create(model);return widget.template=WidgetTemplateService.getDirectiveTemplate("MetadataGroup"),widget}function getSurveyItemEditorWidget(question){return SurveyItemEditorWidgetFactory.create(question)}function getQuestionAnswerOptionWidget(model){return AnswerOptionWidgetFactory.create(model)}function getMetadataAnswerOptionWidget(model){return MetadataOptionWidgetFactory.create(model)}function getNavigationEditorWidget(model){return NavigationWidgetFactory.create(model)}function getRouteWidget(navigation,model){return RouteEditorWidgetFactory.create(navigation,model)}function getRouteCreatorWidget(model,element){var widget=RouteCreatorWidgetFactory.create(model,element);return self.widgetMap[widget.type]=self.widgetMap[widget.type]||{},self.widgetMap[widget.type][widget.name.guid]=widget.name,self.widgetMap[widget.type][widget.destination.guid]=widget.destination,self.widgetMap[widget.type][widget.processor.guid]=widget.processor,widget}var self=this;self.widgetMap={},self.getWidgetForModel=getWidgetForModel,self.getMetadataWidget=getMetadataWidget,self.getSurveyItemEditorWidget=getSurveyItemEditorWidget,self.getQuestionAnswerOptionWidget=getQuestionAnswerOptionWidget,self.getMetadataAnswerOptionWidget=getMetadataAnswerOptionWidget,self.getNavigationEditorWidget=getNavigationEditorWidget,self.getRouteWidget=getRouteWidget,self.getRouteCreatorWidget=getRouteCreatorWidget}angular.module("editor.ui").service("WidgetService",WidgetService),WidgetService.$inject=["WidgetTemplateService","SurveyItemWidgetFactory","SurveyItemEditorWidgetFactory","AnswerOptionWidgetFactory","MetadataGroupWidgetFactory","MetadataOptionWidgetFactory","NavigationWidgetFactory","RouteEditorWidgetFactory","RouteCreatorWidgetFactory"]}(),function(){"use strict";function WidgetTemplateService(){function getDirectiveTemplate(directive){return directiveTemplates[directive]}var self=this,directiveTemplates={CalendarQuestion:"<calendar-question></calendar-question>",IntegerQuestion:"<integer-question></integer-question>",SingleSelectionQuestion:"<single-selection-question></single-selection-question>",TextQuestion:"<text-question></text-question>",TimeQuestion:"<time-question></time-question>",PhoneQuestion:"<phone-question></phone-question>",CheckboxQuestion:"<checkbox-question></checkbox-question>",MetadataGroup:"<metadata-question></metadata-question>"};self.getDirectiveTemplate=getDirectiveTemplate}angular.module("editor.ui").service("WidgetTemplateService",WidgetTemplateService)}(),function(){function EditorToolbarController(WorkspaceService){function saveOfflineWork(){WorkspaceService.saveWork()}function isSurveyEmpty(){return 0===WorkspaceService.getSurvey().SurveyItemManager.getItemListSize()}var self=this;self.saveOfflineWork=saveOfflineWork,self.isSurveyEmpty=isSurveyEmpty}angular.module("editor.ui").controller("EditorToolbarController",EditorToolbarController),EditorToolbarController.$inject=["WorkspaceService"]}(),function(){"use strict";function MainContainerContentService(){function init(cotroller){controllerReference=cotroller}function showQuestionDataEditor(data){}var self=this,controllerReference=null;self.showQuestionDataEditor=showQuestionDataEditor,self.init=init}angular.module("editor.ui").service("MainContainerContentService",MainContainerContentService)}(),function(){function MainContainerController($scope,MainContainerContentService,UiBindingService,$mdBottomSheet){function init(){MainContainerContentService.init(self)}function showQuestionsMenu(){$mdBottomSheet.show({templateUrl:"app/editor/ui/survey-item-palette/bottom-sheet.html",disableParentScroll:!1})}var self=this;self.showQuestionsMenu=showQuestionsMenu,init(),UiBindingService.setScope($scope)}angular.module("editor.ui").controller("MainContainerController",MainContainerController),MainContainerController.$inject=["$scope","MainContainerContentService","UiBindingService","$mdBottomSheet"]}(),function(){"use strict";function AnchorController($element,PageAnchorService){var self=this;self.$onInit=function(){$element.attr("tabindex",-1),PageAnchorService.anchorRegistry($element)}}angular.module("editor.ui").component("otusPageAnchor",{templateUrl:"app/editor/ui/page-anchor-item/page-anchor-template.html",controller:AnchorController,bindings:{id:"<"}}),AnchorController.$inject=["$element","PageAnchorService"]}(),function(){function PageAnchorService(){function anchorRegistry(anchorElement){anchorList[anchorElement[0].id]=anchorElement}function sheetAutoFocus(sheet){var childrenNb=sheet.children().length;childrenNb>6?_focusOnBottom():_focusOnTop()}function _focusOnTop(){anchorList["top-anchor"].focus()}function _focusOnBottom(){anchorList["bottom-anchor"].focus()}var self=this,anchorList={};self.sheetAutoFocus=sheetAutoFocus,self.anchorRegistry=anchorRegistry}angular.module("editor.ui").service("PageAnchorService",PageAnchorService)}(),function(){"use strict";function otusSheet(){var ddo={restrict:"E",controller:"SheetController",controllerAs:"sheetController",templateUrl:"app/editor/ui/sheet/sheet.html"};return ddo}angular.module("editor.ui").directive("otusEditionSheet",otusSheet)}(),function(){"use strict";function SheetContentService(TemplateLoaderService,PageAnchorService,$q,$timeout){function init(scopeReference,sheetReference){scope=scopeReference,sheet=sheetReference}function loadQuestion(item){self.lastLoadedQuestion=item;var content=TemplateLoaderService.loadDirective("<otus:survey-item-editor></otus:survey-item-editor>",scope),sheetTemplate=sheet.find("#sheet").append(content);PageAnchorService.sheetAutoFocus(sheetTemplate)}function loadItem(item){self.lastLoadedQuestion=item;var content=TemplateLoaderService.loadDirective("<otus:page-item-editor></otus:page-item-editor>",scope);sheet.find("#sheet").append(content)}function unloadQuestion(question){sheet.find('[question-target="'+question.templateID+'"]').remove()}function updateQuestion(question){var target='[es-id="question-editor-'+question.templateID+'-label"]',label=UIUtils.jq(sheet.find(target)[0]);label.text(question.label.ptBR.plainText)}var self=this,scope=null,sheet=null;self.init=init,self.loadQuestion=loadQuestion,self.loadItem=loadItem,self.unloadQuestion=unloadQuestion,self.updateQuestion=updateQuestion}angular.module("editor.ui").service("SheetContentService",SheetContentService),SheetContentService.$inject=["TemplateLoaderService","PageAnchorService"]}(),function(){"use strict";function SheetController($scope,$element,SheetContentService,EditionPreviewService,WorkspaceService,$window){function _init(){EditionPreviewService.isLoadingMode()?(EditionPreviewService.setScope($scope),EditionPreviewService.loadSurveyTemplate()):$window.sessionStorage.setItem("surveyTemplate_OID",WorkspaceService.getSurvey().oid)}var self=this;self.EditionPreviewService=EditionPreviewService,SheetContentService.init($scope,$element),_init(),$scope.$on("$destroy",function(){WorkspaceService.closeWork(),$window.sessionStorage.removeItem("surveyTemplate_OID")})}angular.module("editor.ui").controller("SheetController",SheetController),SheetController.$inject=["$scope","$element","SheetContentService","EditionPreviewService","WorkspaceService","$window"]}(),function(){"use strict";function otusStage(){var ddo={restrict:"E",templateUrl:"app/editor/ui/stage/stage.html"};return ddo}angular.module("editor.ui").directive("otusStage",otusStage)}(),function(){"use strict";function SurveyItemWidgetFactory(CalendarQuestionWidgetFactory,IntegerQuestionWidgetFactory,DecimalQuestionWidgetFactory,SingleSelectionQuestionWidgetFactory,CheckboxQuestionWidgetFactory,TextQuestionWidgetFactory,TimeQuestionWidgetFactory,EmailQuestionWidgetFactory,PhoneQuestionWidgetFactory,TextItemWidgetFactory,ImageItemWidgetFactory){function create(scope,element,item){return widgetFactories[item.objectType].create(scope,element,item)}var self=this,widgetFactories={CalendarQuestion:CalendarQuestionWidgetFactory,IntegerQuestion:IntegerQuestionWidgetFactory,DecimalQuestion:DecimalQuestionWidgetFactory,SingleSelectionQuestion:SingleSelectionQuestionWidgetFactory,CheckboxQuestion:CheckboxQuestionWidgetFactory,TextQuestion:TextQuestionWidgetFactory,TimeQuestion:TimeQuestionWidgetFactory,EmailQuestion:EmailQuestionWidgetFactory,PhoneQuestion:PhoneQuestionWidgetFactory,TextItem:TextItemWidgetFactory,ImageItem:ImageItemWidgetFactory};return self.create=create,self}angular.module("editor.ui").factory("SurveyItemWidgetFactory",SurveyItemWidgetFactory),SurveyItemWidgetFactory.$inject=["CalendarQuestionWidgetFactory","IntegerQuestionWidgetFactory","DecimalQuestionWidgetFactory","SingleSelectionQuestionWidgetFactory","CheckboxQuestionWidgetFactory","TextQuestionWidgetFactory","TimeQuestionWidgetFactory","EmailQuestionWidgetFactory","PhoneQuestionWidgetFactory","TextItemWidgetFactory","ImageItemWidgetFactory"]}(),function(){"use strict";function directive(SurveyItemEditorWidgetFactory,SheetContentService,UUIDService,PageAnchorService){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item-editor/survey-item-editor.html",retrict:"E",link:function(scope,element,attrs){scope.uuid=UUIDService.generateUUID(),scope.widget=SurveyItemEditorWidgetFactory.create(scope,element,SheetContentService.lastLoadedQuestion)}};return ddo}angular.module("editor.ui").directive("otusSurveyItemEditor",directive),directive.$inject=["SurveyItemEditorWidgetFactory","SheetContentService","UUIDService","PageAnchorService"]}(),function(){"use strict";function SurveyItemEditorWidgetFactory(RemoveSurveyItemEventFactory){function create(scope,element,item){return new SurveyItemEditorWidget(scope,element,item,RemoveSurveyItemEventFactory)}var self=this;return self.create=create,self}function SurveyItemEditorWidget(scope,element,item,RemoveSurveyItemEventFactory){function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return item}function getQuestionId(){return getItem().templateID}function getContainer(){return item.isQuestion()?"<otus:question-item></otus:question-item>":"<misc-item></misc-item>"}function deleteSurveyItem(){RemoveSurveyItemEventFactory.create().execute(item),element.remove()}var self=this;self.className="SurveyItemEditorWidget",self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getContainer=getContainer,self.deleteSurveyItem=deleteSurveyItem,self.getQuestionId=getQuestionId}angular.module("editor.ui").factory("SurveyItemEditorWidgetFactory",SurveyItemEditorWidgetFactory),SurveyItemEditorWidgetFactory.$inject=["RemoveSurveyItemEventFactory"]}(),function(){"use strict";function directive(OtusSurveyItemPaletteWidgetFactory){var ddo={scope:{label:"@",ariaLabel:"@",leftIcon:"@"},transclude:!0,templateUrl:"app/editor/ui/survey-item-palette/survey-item-palette.html",retrict:"E",link:function(scope){scope.widget=OtusSurveyItemPaletteWidgetFactory.create(scope.$parent.widget)}};return ddo}angular.module("editor.ui").directive("otusSurveyItemPalette",directive),directive.$inject=["OtusSurveyItemPaletteWidgetFactory"]}(),function(){"use strict";function OtusSurveyItemPaletteWidgetFactory(AddSurveyItemEventFactory){function create(parentWidget){
return new OtusQuestionPaletteWidget(parentWidget,AddSurveyItemEventFactory)}var self=this;return self.create=create,self}function OtusQuestionPaletteWidget(parentWidget,AddSurveyItemEventFactory){function addCalendarQuestion(){AddSurveyItemEventFactory.create().execute("CalendarQuestion")}function addIntegerQuestion(){AddSurveyItemEventFactory.create().execute("IntegerQuestion")}function addDecimalQuestion(){AddSurveyItemEventFactory.create().execute("DecimalQuestion")}function addSingleSelectionQuestion(){AddSurveyItemEventFactory.create().execute("SingleSelectionQuestion")}function addTextQuestion(){AddSurveyItemEventFactory.create().execute("TextQuestion")}function addTimeQuestion(){AddSurveyItemEventFactory.create().execute("TimeQuestion")}function addEmailQuestion(){AddSurveyItemEventFactory.create().execute("EmailQuestion")}function addTextItem(){AddSurveyItemEventFactory.create().execute("TextItem")}function addImageItem(){AddSurveyItemEventFactory.create().execute("ImageItem")}function addPhoneQuestion(){AddSurveyItemEventFactory.create().execute("PhoneQuestion")}function addCheckboxQuestion(){AddSurveyItemEventFactory.create().execute("CheckboxQuestion")}var self=this;self.className=self.constructor.name,self.parent=parentWidget,self.addCalendarQuestion=addCalendarQuestion,self.addIntegerQuestion=addIntegerQuestion,self.addDecimalQuestion=addDecimalQuestion,self.addSingleSelectionQuestion=addSingleSelectionQuestion,self.addTextQuestion=addTextQuestion,self.addTimeQuestion=addTimeQuestion,self.addEmailQuestion=addEmailQuestion,self.addTextItem=addTextItem,self.addImageItem=addImageItem,self.addPhoneQuestion=addPhoneQuestion,self.addCheckboxQuestion=addCheckboxQuestion}angular.module("editor.ui").factory("OtusSurveyItemPaletteWidgetFactory",OtusSurveyItemPaletteWidgetFactory),OtusSurveyItemPaletteWidgetFactory.$inject=["AddSurveyItemEventFactory"]}(),function(){"use strict";angular.module("editor.ui").component("otusSurveyTemplateHeader",{templateUrl:"app/editor/ui/survey-template-header/survey-template-header-template.html",controller:function(WorkspaceService){var self=this;self.name="",self.acronym="",self.identity={},self.$onInit=function(){self.identity=WorkspaceService.getSurvey().identity,self.name=self.identity.name,self.acronym=self.identity.acronym}}})}(),function(){"use strict";function TemplateLoaderService($compile,$templateRequest,$templateCache){function load(templateUrl,scope,callback){$templateRequest(templateUrl).then(function(html){var compiledTemplate=compileTemplate(html,scope);callback&&callback(compiledTemplate)})}function loadDirective(html,scope){return $compile(html)(scope)}function compileTemplate(html,scope){return $compile(html)(scope)}var self=this;self.load=load,self.loadDirective=loadDirective}angular.module("editor.ui").service("TemplateLoaderService",TemplateLoaderService),TemplateLoaderService.$inject=["$compile","$templateRequest","$templateCache"]}(),function(){"use strict";function OtusFillingRulesWidgetFactory(){function create(validator){return validatorsTemplates[validator]}var self=this;self.create=create;var validatorsTemplates={alphanumeric:"<otus:alphanumeric-validator></otus:alphanumeric-validator>",distinct:"<otus:distinct-validator></otus:distinct-validator>",futureDate:"<otus:future-date-validator></otus:future-date-validator>",in:"<otus:in-validator></otus:in-validator>",lowerLimit:"<otus:lower-limit-validator></otus:lower-limit-validator>",lowerCase:"<otus:lower-case-validator></otus:lower-case-validator>",mandatory:"<otus:mandatory-validator></otus:mandatory-validator>",maxDate:"<otus:max-date-validator></otus:max-date-validator>",maxLength:"<otus:max-length-validator></otus:max-length-validator>",maxTime:"<otus:max-time-validator></otus:max-time-validator>",minDate:"<otus:min-date-validator></otus:min-date-validator>",minLength:"<otus:min-length-validator></otus:min-length-validator>",minTime:"<otus:min-time-validator></otus:min-time-validator>",parameter:"<otus:parameter-validator></otus:parameter-validator>",pastDate:"<otus:past-date-validator></otus:past-date-validator>",precision:"<otus:precision-validator></otus:precision-validator>",rangeDate:"<otus:range-date-validator></otus:range-date-validator>",scale:"<otus:scale-validator></otus:scale-validator>",specials:"<otus:specials-validator></otus:specials-validator>",upperCase:"<otus:upper-case-validator></otus:upper-case-validator>",upperLimit:"<otus:upper-limit-validator></otus:upper-limit-validator>"};return self}angular.module("editor.ui").factory("OtusFillingRulesWidgetFactory",OtusFillingRulesWidgetFactory)}(),function(){"use strict";function SurveyLoaderService(ModelFacadeService){function newSurvey(name,acronym,version){return ModelFacadeService.getSurveyFactory().create(name,acronym)}function loadSurvey(surveyTemplate){return ModelFacadeService.getSurveyFactory().load(surveyTemplate)}var self=this;self.newSurvey=newSurvey,self.loadSurvey=loadSurvey}angular.module("editor.workspace").service("SurveyLoaderService",SurveyLoaderService),SurveyLoaderService.$inject=["ModelFacadeService"]}(),function(){"use strict";function WorkspaceFactory(InSessionDatabaseFactory){function create(workSession){var inSessionDatabase=InSessionDatabaseFactory.create();return new Workspace(workSession,inSessionDatabase)}var self=this;return self.create=create,self}function Workspace(workSession,inSessionDatabase){function init(){self.isdb=inSessionDatabase,self.sessions={workspaceOwner:workSession}}function importProject(projectToImport){Object.defineProperty(self,"project",{value:projectToImport,writable:!1})}function attachWorkeSession(workSession){self.sessions[workSession.owner.username]=workSession}function loadProjectConfiguration(){}var self=this;self.importProject=importProject,self.attachWorkeSession=attachWorkeSession,self.loadProjectConfiguration=loadProjectConfiguration,init()}angular.module("editor.workspace").factory("WorkspaceFactory",WorkspaceFactory),WorkspaceFactory.$inject=["InSessionDatabaseFactory"]}(),function(){"use strict";function WorkspaceService(WorkspaceFactory,SurveyProjectFactory,SurveyLoaderService,CrossSessionDatabaseService,SurveyExportService){function initializeWorkspace(ownerWorkSession){self.workspace=WorkspaceFactory.create(ownerWorkSession),questionIdCounter=-1,notifyObservers({type:"NEW_PROJECT"})}function startNewWork(initializationData){var survey=SurveyLoaderService.newSurvey(initializationData.name,initializationData.acronym.toUpperCase(),initializationData.version);importProject(SurveyProjectFactory.create(survey,self.workspace.sessions.workspaceOwner))}function loadWork(surveyTemplate){var survey=SurveyLoaderService.loadSurvey(surveyTemplate);importProject(SurveyProjectFactory.create(survey,self.workspace.sessions.workspaceOwner))}function closeWork(){saveWork(),self.workspace.project.close("now"),questionIdCounter=-1,observers=[],self.workspace=void 0}function saveWork(){CrossSessionDatabaseService.saveSurveyTemplateRevision(self.workspace.project.survey,self.workspace.sessions.workspaceOwner)}function exportWork(){return SurveyExportService.exportSurvey(self.workspace.project.survey.toJson())}function getQuestionId(){return++questionIdCounter}function getSurvey(){return self.workspace.project.survey}function importProject(project){self.workspace.importProject(project),self.workspace.loadProjectConfiguration()}function notifyObservers(update){observers.forEach(function(observer){observer.update(update)})}function registerObserver(observer){observers.push(observer)}var self=this,questionIdCounter=-1,observers=[];self.initializeWorkspace=initializeWorkspace,self.startNewWork=startNewWork,self.loadWork=loadWork,self.closeWork=closeWork,self.saveWork=saveWork,self.getQuestionId=getQuestionId,self.exportWork=exportWork,self.getSurvey=getSurvey,self.registerObserver=registerObserver}angular.module("editor.workspace").service("WorkspaceService",WorkspaceService),WorkspaceService.$inject=["WorkspaceFactory","SurveyProjectFactory","SurveyLoaderService","CrossSessionDatabaseService","SurveyExportService"]}(),function(){"use strict";function surveyTemplateExport(WorkspaceService){var ddo={restrict:"A",link:function(scope,element){element.on("click",function(){var downloadElement=document.createElement("a");downloadElement.setAttribute("href",WorkspaceService.exportWork()),downloadElement.setAttribute("download","surveyTemplate.json"),downloadElement.setAttribute("target","_blank"),downloadElement.click()})}};return ddo}angular.module("editor.workspace").directive("surveyTemplateExport",surveyTemplateExport),surveyTemplateExport.$inject=["WorkspaceService"]}(),function(){"use strict";function SurveyExportService(){function exportSurvey(JsonTemplate){return"data:text/json;charset=utf-8,"+encodeURIComponent(JsonTemplate)}var self=this;self.exportSurvey=exportSurvey}angular.module("editor.workspace").service("SurveyExportService",SurveyExportService)}(),function(){"use strict";function SurveyProjectFactory(){function create(survey,author){return new SurveyProject(survey,author)}var self=this;return self.create=create,self}function SurveyProject(survey,author){function addContributor(contributor){contributors.push(contributor)}function removeContributor(contributor){var indexToRemove=contributors.indexOf(contributor);contributors=contributors.slice(indexToRemove,1)}function listContributors(){return contributors}function close(lastSaveDateTime){Object.defineProperty(self,"lastSaveDateTime",{value:lastSaveDateTime,writable:!1})}var self=this;self.configuration={};var contributors=[];Object.defineProperty(this,"survey",{value:survey,writable:!1}),Object.defineProperty(this,"creationDateTime",{value:Date.now(),writable:!1}),Object.defineProperty(this,"author",{value:author,writable:!1}),self.addContributor=addContributor,self.removeContributor=removeContributor,self.listContributors=listContributors,self.close=close}angular.module("editor.workspace").factory("SurveyProjectFactory",SurveyProjectFactory)}(),function(){"use strict";function EditingWorkFactory(){function create(){return new EditingWork}var self=this;return self.create=create,self}function EditingWork(){var self=this;self.survey=null,self.creationDateTime=null,self.author=null,self.contributors=null,self.isPublished=null,self.isSincronized=null,self.isLocallyPersisted=null}angular.module("editor.workspace").factory("EditingWorkFactory",EditingWorkFactory)}(),function(){"use strict";function EditingWorkService(){var self=this;self.startNewWork=startNewWork,self.loadWork=loadWork}angular.module("editor.workspace").factory("EditingWorkService",EditingWorkService)}(),function(){"use strict";function NavigationPreviewService(GraphFactory){function createGraph(navigationRules){return init(),iterate(navigationRules,drawNodes),iterate(navigationRules,drawEdges),draw(),navigationGraph}function init(){navigationGraph=GraphFactory.create()}function iterate(navigationRules,drawOptions){for(var navigationRule in navigationRules)drawOptions(navigationRules[navigationRule])}function drawNodes(navigationRule){navigationRule.hasOwnProperty("origin")&&navigationGraph.addNode(navigationRule.origin)}function drawEdges(navigationRule){if(navigationRule.hasOwnProperty("routes"))for(var i=0;i<navigationRule.routes.length;i++)navigationGraph.addEdge(navigationRule.origin,navigationRule.routes[i].destination,{directed:!0})}function draw(){layouter=new Graph.Layout.Spring(navigationGraph),layouter.layout()}function renderGraph(createdGraph){renderer=new Graph.Renderer.Raphael("survey-navigation-graph",createdGraph,$("#survey-navigation-graph").width(),$("#survey-navigation-graph").height()),renderer.draw()}var self=this;self.createGraph=createGraph,self.renderGraph=renderGraph;var navigationGraph,renderer,layouter}angular.module("preview.navigation").service("NavigationPreviewService",NavigationPreviewService),NavigationPreviewService.$inject=["GraphFactory"]}(),function(){function otusAccordion(OtusAccordionWidgetFactory){var directive={restrict:"E",transclude:!0,templateUrl:"app/shared/ui-components/accordion/accordion-template.html",scope:{},link:function(scope,template,attrs,controller,transclude){var userHeader,userContent,templateHeader=angular.element(template.children()[0]),templateContent=angular.element(template.children()[1]);transclude(function(clone,cloneScope){userHeader=angular.element(clone[1]),userContent=angular.element(clone[3])}),userHeader.children().insertBefore(templateHeader.children()),templateContent.append(userContent.children()),scope.widget=OtusAccordionWidgetFactory.create(scope,attrs,scope.$parent)}};return directive}angular.module("ui.components").directive("otusAccordion",otusAccordion),otusAccordion.$inject=["OtusAccordionWidgetFactory"]}(),function(){"use strict";function OtusAccordionWidgetFactory(){function create(templateData,templateConfig,parentWidget){return new OtusAccordionWidget(templateData,templateConfig,parentWidget)}var self=this;return self.create=create,self}function OtusAccordionWidget(templateData,templateConfig,parentWidget){function changeState(){self.isToShow=!self.isToShow,self.template.icon=self.isToShow?"expand_less":"expand_more"}var self=this;self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.icon="expand_more",self.parent=parentWidget,self.isToShow=!1,self.changeState=changeState}angular.module("ui.components").factory("OtusAccordionWidgetFactory",OtusAccordionWidgetFactory)}(),function(){"use strict";function SurveyTemplateController($element,$scope,SelectedSurveyTemplatesManagementService){function _select(){self.isSelected=!0,mdCard.addClass("selected-template"),SelectedSurveyTemplatesManagementService.selectSurveyTemplate(self.surveyTemplate)}function _remove(){self.isSelected=!1,mdCard.removeClass("selected-template"),SelectedSurveyTemplatesManagementService.removeSurveyTemplate(self.surveyTemplate)}function _scopeApply(){$scope.$apply()}var mdCard,self=this;self.isSelected=!1,self.$onDestroy=function(){self.isSelected&&SelectedSurveyTemplatesManagementService.removeSurveyTemplate(self.surveyTemplate)},$element.on("click",function(){mdCard=$element.children(),self.isSelected?_remove():_select(),_scopeApply()})}angular.module("surveyTemplates").component("surveyTemplate",{templateUrl:"app/dashboard/survey-templates/components/survey-template/survey-template.html",controller:SurveyTemplateController,bindings:{surveyTemplate:"<"}}),SurveyTemplateController.$inject=["$element","$scope","SelectedSurveyTemplatesManagementService"]}(),function(){"use strict";function SurveyTemplateControllerList(SurveyTemplateManagerService){function getSurveyTemplatesList(){return SurveyTemplateManagerService.surveyTemplates}var self=this;self.getSurveyTemplatesList=getSurveyTemplatesList,self.$onInit=function(){SurveyTemplateManagerService.initializeSurveyTemplateList()}}angular.module("surveyTemplates").component("surveyTemplatesList",{templateUrl:"app/dashboard/survey-templates/components/survey-templates-list/survey-templates-list.html",controller:SurveyTemplateControllerList}),SurveyTemplateControllerList.$inject=["SurveyTemplateManagerService"]}(),function(){"use strict";function SurveyTemplatesToolbarController(SurveyTemplateManagerService,SelectedSurveyTemplatesManagementService,$mdToast,DashboardStateService,$window){function deleteSelectedSurveyTemplate(){SelectedSurveyTemplatesManagementService.selectedSurveyTemplates.forEach(function(template){SurveyTemplateManagerService.deleteSurveyTemplate(template)}),$mdToast.show($mdToast.simple().textContent("Template(s) removido(s) com sucesso!"))}function openEditorForSelectedSurveyTemplate(){var selectedSurveyTemplate=_getSelectedSurveyTemplate();$window.sessionStorage.setItem("surveyTemplate_OID",selectedSurveyTemplate.oid),DashboardStateService.goToEditorWithSurveyTemplate(selectedSurveyTemplate)}function _getSelectedSurveyTemplate(){return SelectedSurveyTemplatesManagementService.selectedSurveyTemplates[0].template}var self=this;self.SelectedSurveyTemplatesManagementService=SelectedSurveyTemplatesManagementService,self.deleteSelectedSurveyTemplate=deleteSelectedSurveyTemplate,self.openEditorForSelectedSurveyTemplate=openEditorForSelectedSurveyTemplate}angular.module("surveyTemplates").component("surveyTemplatesToolbar",{templateUrl:"app/dashboard/survey-templates/components/survey-templates-toolbar/survey-templates-toolbar-template.html",controller:SurveyTemplatesToolbarController}),SurveyTemplatesToolbarController.$inject=["SurveyTemplateManagerService","SelectedSurveyTemplatesManagementService","$mdToast","DashboardStateService","$window"]}(),function(){"use strict";function NewSurveyFormDialogService($mdDialog){function init(){self.dialogSettings={parent:angular.element(document.body),templateUrl:"app/dashboard/survey-templates/dialog/new-survey-form/new-survey-form-dialog.html",controller:DialogController,controllerAs:"controller",openFrom:"#system-toolbar",closeTo:{bottom:0}}}function showDialog(){return $mdDialog.show(self.dialogSettings).then(forwardSuccessfulExecution,forwardUnsuccessfulExecution),{onConfirm:function(callback){self.callback=callback}}}function forwardSuccessfulExecution(response){"create"==response.action&&self.callback&&self.callback(response.data)}function forwardUnsuccessfulExecution(error){}var self=this;self.showDialog=showDialog,init()}function DialogController($mdDialog){function cancel(response){$mdDialog.hide(response)}function createSurveyForm(response){$mdDialog.hide(response)}var self=this;self.cancel=cancel,self.createSurveyForm=createSurveyForm}angular.module("studio.dashboard").service("NewSurveyFormDialogService",NewSurveyFormDialogService),NewSurveyFormDialogService.$inject=["$mdDialog"]}(),function(){"use strict";function directive(OtusButtonWidgetFactory){var ddo={scope:{click:"="},templateUrl:"app/editor/ui/base/button/button.html",retrict:"E",link:function(scope,element,attrs){scope.widget=OtusButtonWidgetFactory.create(scope,attrs,scope.$parent.widget)}};return ddo}angular.module("editor.ui").directive("otusButton",directive),directive.$inject=["OtusButtonWidgetFactory"]}(),function(){"use strict";function OtusButtonWidgetFactory(){function create(templateData,templateConfig,parentWidget){return new OtusButtonWidget(templateData,templateConfig,parentWidget)}var self=this;return self.create=create,self}function OtusButtonWidget(templateData,templateConfig,parentWidget){var self=this,validTooltipDirections=["top","bottom","left","right"];self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.ariaLabel=templateConfig.ariaLabel||templateConfig.label,self.template.label=templateConfig.label,self.template.tooltip=templateConfig.tooltip||templateConfig.label,self.template.tooltipDirection=void 0!==templateConfig.tooltipDirection&&validTooltipDirections.indexOf(templateConfig.tooltipDirection)!==-1?templateConfig.tooltipDirection:"top",self.template.leftIcon=templateConfig.iconButton||templateConfig.leftIcon,self.template.rightIcon=templateConfig.rightIcon,self.template.hasLeftIcon=void 0!==self.template.leftIcon,self.template.hasRightIcon=void 0===templateConfig.iconButton&&void 0!==self.template.rightIcon,self.css.iconButton=void 0!==templateConfig.iconButton?"md-icon-button":"",self.parent=parentWidget,self.event.click=templateData.click}angular.module("editor.ui").factory("OtusButtonWidgetFactory",OtusButtonWidgetFactory)}(),function(){"use strict";function otusInputText(OtusInputTextWidgetFactory){var ddo={scope:{model:"=",disabled:"@"},templateUrl:"app/editor/ui/base/input-text/input-text.html",retrict:"E",link:function(scope,element,attrs){scope.widget=OtusInputTextWidgetFactory.create(scope,attrs,element,scope.$parent.widget||scope.$parent.$parent.childWidget)}};return ddo}angular.module("editor.ui").directive("otusInputText",otusInputText),otusInputText.$inject=["OtusInputTextWidgetFactory"]}(),function(){"use strict";function OtusInputTextWidgetFactory(){function create(templateData,templateConfig,element,parentWidget){return new OtusInputTextWidget(templateData,templateConfig,element,parentWidget)}var self=this;return self.create=create,self}function OtusInputTextWidget(templateData,templateConfig,element,parentWidget){var self=this;self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.ariaLabel=templateConfig.ariaLabel||templateConfig.label,self.template.label=templateConfig.label,self.template.leftIcon=templateConfig.iconButton||templateConfig.leftIcon,self.template.rightIcon=templateConfig.rightIcon,self.template.hasLeftIcon=void 0!==self.template.leftIcon,self.template.hasRightIcon=void 0===templateConfig.iconButton&&void 0!==self.template.rightIcon,self.parent=parentWidget,self.modelReference=templateData.model,self.style=templateData.style,templateData.model instanceof Function?self.model=templateData.model():self.model=templateData.model,element.on("change",function(){self.modelReference instanceof Function?self.modelReference(self.model):self.modelReference=self.model})}angular.module("editor.ui").factory("OtusInputTextWidgetFactory",OtusInputTextWidgetFactory)}(),function(){"use strict";function directive(OtusTextEditorWidgetFactory){var ddo={scope:{placeholder:"@",label:"=",ariaLabel:"@",leftIcon:"@",ngModel:"="},templateUrl:"app/editor/ui/base/text-editor/text-editor.html",retrict:"E",link:function(scope,element){scope.widget=OtusTextEditorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusTextEditor",directive),directive.$inject=["OtusTextEditorWidgetFactory"]}(),function(){"use strict";function OtusTextEditorWidgetFactory(UpdateQuestionEventFactory){function create(scope,element){return new OtusTextEditorWidget(scope,element,UpdateQuestionEventFactory)}var self=this;return self.create=create,self}function OtusTextEditorWidget(scope,element,UpdateQuestionEventFactory){function _init(){self.ngModel&&_loadLabel()}function getClassName(){return"OtusTextEditorWidget"}function getUUID(){return scope.uuid}function getLabel(){return self.ngModel.ptBR.formattedText}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function _saveLabel(){self.ngModel.ptBR.formattedText=_removeSpecialCharacters(event.target.innerHTML),self.ngModel.ptBR.plainText=event.target.innerText}function _removeSpecialCharacters(value){return value.replace(/"/g,"'")}function _loadLabel(){self.getElement().children()[0].innerHTML=self.getLabel()}var self=this;self.input=angular.element(element.children()[0]),self.ngModel=scope.ngModel,self.placeholder=scope.placeholder,self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getLabel=getLabel,_init(),element.on("focusout",function(event){_saveLabel(),UpdateQuestionEventFactory.create().execute(self)})}angular.module("editor.ui").factory("OtusTextEditorWidgetFactory",OtusTextEditorWidgetFactory),OtusTextEditorWidgetFactory.$inject=["UpdateQuestionEventFactory"]}(),function(){"use strict";function otusMetadataGroup(MetadataGroupWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/metadata/group/metadata-group.html",link:function(scope,element){scope.widget=MetadataGroupWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMetadataGroup",otusMetadataGroup),otusMetadataGroup.$inject=["MetadataGroupWidgetFactory"]}(),function(){"use strict";function MetadataGroupWidgetFactory(MetadataOptionWidgetFactory,AddMetadataAnswerEventFactory,RemoveMetadataOptionEventFactory){function create(scope,element){return new MetadataGroupWidget(scope,element,MetadataOptionWidgetFactory,AddMetadataAnswerEventFactory,RemoveMetadataOptionEventFactory)}var self=this;return self.create=create,self}function MetadataGroupWidget(scope,element,MetadataOptionWidgetFactory,AddMetadataAnswerEventFactory,RemoveMetadataOptionEventFactory){function _init(){self.getItem().metadata.options.length>0&&_loadOptions()}function getClassName(){return"MetadataGroupWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function _loadOptions(){self.getItem().metadata.options.forEach(function(option){var optionWidget=MetadataOptionWidgetFactory.create(option,self);self.options.push(optionWidget)})}function addOption(){var newOption=AddMetadataAnswerEventFactory.create().execute(self),optionWidget=MetadataOptionWidgetFactory.create(newOption,self);self.options.push(optionWidget)}function removeLastOption(){RemoveMetadataOptionEventFactory.create().execute(self),self.options.splice(-1)}var self=this;self.ngModel=scope.ngModel,self.options=[],self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.addOption=addOption,self.removeLastOption=removeLastOption,_init()}angular.module("editor.ui").factory("MetadataGroupWidgetFactory",MetadataGroupWidgetFactory),MetadataGroupWidgetFactory.$inject=["MetadataOptionWidgetFactory","AddMetadataAnswerEventFactory","RemoveMetadataOptionEventFactory"]}(),function(){"use strict";function MetadataOptionWidgetFactory(){function create(option,parentGroup){return new MetadataAnswerOptionWidget(option,parentGroup)}var self=this;return self.create=create,self}function MetadataAnswerOptionWidget(option,parentGroup){var self=this;self.name="MetadataAnswerOption",self.parentGroup=parentGroup,self.option=option}angular.module("editor.ui").factory("MetadataOptionWidgetFactory",MetadataOptionWidgetFactory)}(),function(){"use strict";function otusNavigationEditor(RouteEditorWidgetFactory,NavigationWidgetFactory,WorkspaceService,UUIDService){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/navigation/editor/navigation-editor.html",link:function(scope,element,attrs){scope.uuid=UUIDService.generateUUID();var NavigationManager=WorkspaceService.getSurvey().NavigationManager;scope.widget=NavigationWidgetFactory.create(scope,element,NavigationManager,RouteEditorWidgetFactory)}};return ddo}angular.module("editor.ui").directive("otusNavigationEditor",otusNavigationEditor),otusNavigationEditor.$inject=["RouteEditorWidgetFactory","NavigationWidgetFactory","WorkspaceService","UUIDService"]}(),function(){"use strict";function NavigationWidgetFactory(){function create(scope,element,NavigationManagerService,RouteEditorWidgetFactory){return new NavigationWidget(scope,element,NavigationManagerService,RouteEditorWidgetFactory)}var self=this;return self.create=create,self}function NavigationWidget(scope,element,NavigationManagerService,RouteEditorWidgetFactory){function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getNavigation(){return navigation}function listRouteWidgets(){return routeEditorWidgets}function addRoute(route){var routeWidget=RouteEditorWidgetFactory.create(route,navigation);routeEditorWidgets.push(routeWidget)}function removeRoute(name){var routeToRemove=routeEditorWidgets.filter(function(routeEditorWidget){return routeEditorWidget.name()===name}),indexToRemove=routeEditorWidgets.indexOf(routeToRemove[0]);return indexToRemove>-1&&routeEditorWidgets.splice(indexToRemove,1),routeToRemove[0]}function setupScopeEvents(){enableQuestionAddEventListener(),enableQuestionRemoveEventListener(getItem().templateID)}function enableQuestionAddEventListener(){disableQuestionAddEventListener=scope.$on("item.add",addQuestionListener)}function enableQuestionRemoveEventListener(templateID){disableQuestionRemoveEventListener=scope.$on("item.remove."+templateID,removeQuestionListener)}function addQuestionListener(event,addedQuestion){navigation=NavigationManagerService.getNavigationByOrigin(getItem().templateID),navigation&&(addRoute(navigation.listRoutes()[0]),enableQuestionRemoveEventListener(addedQuestion.templateID),disableQuestionAddEventListener())}function removeQuestionListener(event){routeEditorWidgets=[],navigation=NavigationManagerService.getNavigationByOrigin(getItem().templateID),navigation?navigation.routes.forEach(function(route){addRoute(route),enableQuestionRemoveEventListener(route.destination)}):(enableQuestionAddEventListener(),disableQuestionRemoveEventListener())}var self=this;self.className="NavigationEditorWidget",self.css={};var navigation=NavigationManagerService.getNavigationByOrigin(getItem().templateID),routeEditorWidgets=[];self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getNavigation=getNavigation,self.getItem=getItem,self.listRouteWidgets=listRouteWidgets,self.addRoute=addRoute,self.removeRoute=removeRoute,setupScopeEvents();var disableQuestionAddEventListener,disableQuestionRemoveEventListener}angular.module("editor.ui").factory("NavigationWidgetFactory",NavigationWidgetFactory)}(),function(){"use strict";function directive(RouteConditionWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/navigation/route-condition/route-condition.html",link:function(scope){var route=scope.$parent.routeConditionDialog.currentRoute;scope.widget=RouteConditionWidgetFactory.create(route,scope.$parent.routeConditionDialog)}};return ddo}angular.module("editor.ui").directive("otusRouteCondition",directive),directive.$inject=["RouteConditionWidgetFactory"]}(),function(){"use strict";function RouteConditionWidgetFactory(AddRouteConditionEventFactory){function create(route,parentWidget){return new RouteConditionWidget(route,parentWidget,AddRouteConditionEventFactory)}var self=this;return self.create=create,self}function RouteConditionWidget(route,parentWidget,AddRouteConditionEventFactory){function newRouteConditionName(value){return void 0!==value&&(self.routeConditionName=value),self.routeConditionName}function addRouteCondition(){var routeCondition=AddRouteConditionEventFactory.create().execute(GROUP_NAME_SUFIX,self.route),routeConditionWidget={name:routeCondition.name,rules:[]};self.routeConditions.push(routeConditionWidget)}function addRule(ruleWidget){self.routeConditions[0].rules.push(ruleWidget)}function updateRuleList(widget){var ruleToRemove=self.routeConditions[0].rules.filter(function(ruleWidget){return ruleWidget.uuid===widget.uuid}),indexToRemove=self.routeConditions[0].rules.indexOf(ruleToRemove[0]);return indexToRemove>-1&&self.routeConditions[0].rules.splice(indexToRemove,1),ruleToRemove[0]}var self=this,GROUP_NAME_SUFIX="Grupo ";self.className=self.constructor.name,self.parent=parentWidget,self.route=route,self.routeConditionName="",self.routeConditions=[],self.addRouteCondition=addRouteCondition,self.newRouteConditionName=newRouteConditionName,self.addRule=addRule,self.updateRuleList=updateRuleList}angular.module("editor.ui").factory("RouteConditionWidgetFactory",RouteConditionWidgetFactory),RouteConditionWidgetFactory.$inject=["AddRouteConditionEventFactory"]}(),function(){"use strict";function directive(SurveyItemWidgetFactory,SheetContentService){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/misc/misc.html",retrict:"E",link:function(scope,element){scope.widget=SurveyItemWidgetFactory.create(scope,element,SheetContentService.lastLoadedQuestion)}};return ddo}angular.module("editor.ui").directive("miscItem",directive),directive.$inject=["SurveyItemWidgetFactory","SheetContentService"]}(),function(){"use strict";function directive(SurveyItemWidgetFactory,SheetContentService){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/question.html",retrict:"E",link:function(scope,element){scope.widget=SurveyItemWidgetFactory.create(scope,element,SheetContentService.lastLoadedQuestion)}};return ddo}angular.module("editor.ui").directive("otusQuestionItem",directive),directive.$inject=["SurveyItemWidgetFactory","SheetContentService"];
}(),function(){"use strict";function SurveyItemSettingsContentService(TemplateLoaderService){function loadNavigation(contentArea,scope){TemplateLoaderService.load(NAVIGATION_TEMPLATE,scope,function(template){contentArea.append(template)})}function closeNavigation(contentArea){contentArea.empty()}var self=this;self.loadNavigation=loadNavigation,self.closeNavigation=closeNavigation}angular.module("editor.ui").service("SurveyItemSettingsContentService",SurveyItemSettingsContentService),SurveyItemSettingsContentService.$inject=["TemplateLoaderService"]}(),function(){"use strict";function SurveyItemSettingsController($scope,$element,SurveyItemSettingsContentService){function navigation(templateID){var contentArea=$element.find(".toolbar-content-"+templateID);contentArea.children().length?SurveyItemSettingsContentService.closeNavigation(contentArea):SurveyItemSettingsContentService.loadNavigation(contentArea,$scope)}var self=this;self.navigation=navigation}angular.module("editor.ui").controller("SurveyItemSettingsController",SurveyItemSettingsController),SurveyItemSettingsController.$inject=["$scope","$element","SurveyItemSettingsContentService"]}(),function(){"use strict";function directive(SurveyItemSettingsWidgetFactory,UUIDService){var ddo={scope:{},restrict:"E",controller:"SurveyItemSettingsController",templateUrl:"app/editor/ui/survey-item-editor/survey-item-settings/survey-item-settings.html",link:function(scope,element,attrs){scope.uuid=UUIDService.generateUUID(),scope.widget=SurveyItemSettingsWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusSurveyItemSettings",directive),directive.$inject=["SurveyItemSettingsWidgetFactory","UUIDService"]}(),function(){"use strict";function SurveyItemSettingsWidgetFactory(){function create(scope,element){return new SurveyItemSettingsWidget(scope,element)}var self=this;return self.create=create,self}function SurveyItemSettingsWidget(scope,element){function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.$parent.$parent.widget}function getItem(){return getParent().getItem()}function navigationButton(){self.ngClass.open=!self.ngClass.open,self.showNavigationEditor=!self.showNavigationEditor}function validationButton(){self.ngClass.open=!self.ngClass.open,self.showValidationEditor=!self.showValidationEditor}var self=this;self.className="SurveyItemSettingsWidget",self.ngClass={},self.ngClass.open=!1,self.showNavigationEditor=!1,self.showValidationEditor=!1,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.navigationButton=navigationButton,self.validationButton=validationButton}angular.module("editor.ui").factory("SurveyItemSettingsWidgetFactory",SurveyItemSettingsWidgetFactory)}(),function(){"use strict";function otusFillingRulesEditor(FillingRulesEditorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/editor/validation-editor.html",link:function(scope,element){scope.widget=FillingRulesEditorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusFillingRulesEditor",otusFillingRulesEditor),otusFillingRulesEditor.$inject=["FillingRulesEditorWidgetFactory"]}(),function(){"use strict";function FillingRulesEditorWidgetFactory(AddFillingRulesEventFactory,RemoveFillingRulesEventFactory,OtusFillingRulesWidgetFactory,$compile,UpdateFillingRulesEventFactory){function create(scope,element){return new FillingRulesEditorWidget(scope,element,AddFillingRulesEventFactory,RemoveFillingRulesEventFactory,OtusFillingRulesWidgetFactory,$compile,UpdateFillingRulesEventFactory)}var self=this;return self.create=create,self}function FillingRulesEditorWidget(scope,element,AddFillingRulesEventFactory,RemoveFillingRulesEventFactory,OtusFillingRulesWidgetFactory,$compile,UpdateFillingRulesEventFactory){function _init(){showList=showListFeeder(),Object.keys(self.getItem().fillingRules.options).length>0?(Object.keys(self.getItem().fillingRules.options),_loadOptions()):addValidator("mandatory")}function showListFeeder(){var showList=getItem().validators();return showList}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function _loadOptions(){Object.keys(self.getItem().fillingRules.options).forEach(function(validatorToLoad){appendFillingRules(validatorToLoad)})}function addValidator(validator){AddFillingRulesEventFactory.create().execute(getItem(),validator),appendFillingRules(validator)}function appendFillingRules(validator){showList.splice(showList.indexOf(validator),1);var template=OtusFillingRulesWidgetFactory.create(validator),validatorsColumn=element.find("#validators-column"),validatorTemplate=$compile(template)(scope);validatorsColumn.append(validatorTemplate)}function deleteValidator(validator){showList.push(validator),RemoveFillingRulesEventFactory.create().execute(self,validator)}function updateFillingRules(){UpdateFillingRulesEventFactory.create().execute()}function checkIfShow(fillingRule){return showList.indexOf(fillingRule)>-1}function menuDisabler(){return!(showList.length>0)}var self=this;self.ngModel=scope.ngModel,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.addValidator=addValidator,self.checkIfShow=checkIfShow,self.deleteValidator=deleteValidator,self.updateFillingRules=updateFillingRules,self.menuDisabler=menuDisabler,_init();var showList}angular.module("editor.ui").factory("FillingRulesEditorWidgetFactory",FillingRulesEditorWidgetFactory),FillingRulesEditorWidgetFactory.$inject=["AddFillingRulesEventFactory","RemoveFillingRulesEventFactory","OtusFillingRulesWidgetFactory","$compile","UpdateFillingRulesEventFactory"]}(),function(){"use strict";function otusRouteCreator(RouteCreatorWidgetFactory){var ddo={scope:{flex:"@",leftIcon:"@",layout:"@"},restrict:"E",templateUrl:"app/editor/ui/navigation/route/creator/route-creator.html",link:function(scope,element,attr,controller){scope.widget=RouteCreatorWidgetFactory.create(attr,element,scope.$parent.widget)}};return ddo}angular.module("editor.ui").directive("otusRouteCreator",otusRouteCreator),otusRouteCreator.$inject=["RouteCreatorWidgetFactory"]}(),function(){"use strict";function RouteCreatorWidgetFactory(AddRouteEventFactory,RouteEditorWidgetFactory){function create(templateData,element,parentWidget){return new RouteCreatorWidget(templateData,element,parentWidget,AddRouteEventFactory,RouteEditorWidgetFactory)}var self=this;return self.create=create,self}function RouteCreatorWidget(templateData,element,parentWidget,AddRouteEventFactory,RouteEditorWidgetFactory){function routeDestination(value){return void 0!==value&&(self.routeData.destination=value),self.routeData.destination}function createRoute(){self.routeData.name=self.parent.getRouteName();var route=AddRouteEventFactory.create().execute(self.routeData);self.parent.addRoute(route),self.element.find("input").val(""),self.element.find("input").blur()}var self=this;self.className=self.constructor.name,self.template={},self.css={},self.css.ngClass={},self.element=element,self.parent=parentWidget,self.routeData={},self.routeData.parentNavigation=parentWidget.navigation,self.template.flex=templateData.flex,self.template.icon="low_priority",self.template.layout=templateData.layout,self.css.class=templateData.class,self.css.ngClass.open=!1,self.routeDestination=routeDestination,self.createRoute=createRoute,self.parent.routeCreatorWidget=self}angular.module("editor.ui").factory("RouteCreatorWidgetFactory",RouteCreatorWidgetFactory),RouteCreatorWidgetFactory.$inject=["AddRouteEventFactory","RouteEditorWidgetFactory"]}(),function(){"use strict";function otusRouteEditor(){var ddo={scope:{leftIcon:"@",widget:"="},restrict:"E",templateUrl:"app/editor/ui/navigation/route/editor/route-editor.html"};return ddo}angular.module("editor.ui").directive("otusRouteEditor",otusRouteEditor)}(),function(){"use strict";function RouteEditorWidgetFactory($mdDialog,RemoveRouteEventFactory,UpdateRouteEventFactory){function create(route,parentWidget){return new RouteEditorWidget(route,parentWidget,$mdDialog,RemoveRouteEventFactory,UpdateRouteEventFactory)}var self=this;return self.create=create,self}function RouteEditorWidget(route,parentWidget,$mdDialog,RemoveRouteEventFactory,UpdateRouteEventFactory){function editRoute(){self.dialogSettings={parent:angular.element(document.body),templateUrl:"app/editor/ui/navigation/route-condition/route-condition-dialog.html",openFrom:"#system-toolbar",controller:function(){var vm=this;vm.currentRoute=self.routeData,vm.close=function(){$mdDialog.hide()}},controllerAs:"routeConditionDialog",clickOutsideToClose:!0,fullscreen:!0,closeTo:{bottom:0}},$mdDialog.show(self.dialogSettings)}function removeRoute(){RemoveRouteEventFactory.create().execute(self.routeData),self.parent.removeRoute(self.routeData.name)}function name(value){return void 0!==value&&(self.routeData.name=value,UpdateRouteEventFactory.create().execute(self)),self.routeData.name}function destination(value){return void 0!==value&&(self.routeData.destination=value,UpdateRouteEventFactory.create().execute(self)),self.routeData.destination}var self=this;self.className=self.constructor.name,self.css={},self.css.ngClass={},self.template={},self.css.ngClass.isSimpleRoute=route.isSimple||!0,self.parent=parentWidget,self.routeData=route,self.routeData.parentNavigation=parentWidget.navigation,self.editRoute=editRoute,self.removeRoute=removeRoute,self.name=name,self.destination=destination}angular.module("editor.ui").factory("RouteEditorWidgetFactory",RouteEditorWidgetFactory),RouteEditorWidgetFactory.$inject=["$mdDialog","RemoveRouteEventFactory","UpdateRouteEventFactory"]}(),function(){"use strict";function otusRuleCreator(RuleCreatorWidgetFactory){var ddo={scope:{leftIcon:"@"},restrict:"E",templateUrl:"app/editor/ui/navigation/rule/creator/rule-creator.html",link:function(scope,element,attr,controller){scope.widget=RuleCreatorWidgetFactory.create(scope,scope.$parent.widget)}};return ddo}angular.module("editor.ui").directive("otusRuleCreator",otusRuleCreator),otusRuleCreator.$inject=["RuleCreatorWidgetFactory"]}(),function(){"use strict";function RuleCreatorWidgetFactory(AddRuleEventFactory,RuleEditorWidgetFactory,WorkspaceService){function create(scope,parentWidget){return new RuleCreatorWidget(scope,parentWidget,AddRuleEventFactory,RuleEditorWidgetFactory,WorkspaceService)}var self=this;return self.create=create,self}function RuleCreatorWidget(scope,parentWidget,AddRuleEventFactory,RuleEditorWidgetFactory,WorkspaceService){function avaiableQuestions(){return Object.keys(self.survey.questionContainer)}function when(value){return void 0!==value&&(self.newRule.when=value),self.newRule.when}function operator(value){return void 0!==value&&(self.newRule.operator=value),self.newRule.operator}function answer(value){return void 0!==value&&(self.newRule.answer=value),self.newRule.answer}function saveRule(){var newRule=AddRuleEventFactory.create().execute(self.newRule,self.route),ruleEditorWidget=RuleEditorWidgetFactory.create(newRule,self.parent);self.parent.addRule(ruleEditorWidget),self.newRule={}}var self=this;self.name="RuleCreator",self.newRule={},self.parent=parentWidget,self.route=parentWidget.route,self.survey=WorkspaceService.getSurvey(),self.icon="low_priority",self.avaiableQuestions=avaiableQuestions,self.when=when,self.operator=operator,self.answer=answer,self.saveRule=saveRule}angular.module("editor.ui").factory("RuleCreatorWidgetFactory",RuleCreatorWidgetFactory),RuleCreatorWidgetFactory.$inject=["AddRuleEventFactory","RuleEditorWidgetFactory","WorkspaceService"]}(),function(){"use strict";function otusRuleEditor(){var ddo={scope:{leftIcon:"@",widget:"="},restrict:"E",templateUrl:"app/editor/ui/navigation/rule/editor/rule-editor.html"};return ddo}angular.module("editor.ui").directive("otusRuleEditor",otusRuleEditor)}(),function(){"use strict";function RuleEditorWidgetFactory(RemoveRuleEventFactory,UUID){function create(rule,parentWidget){return new RuleEditorWidget(rule,parentWidget,RemoveRuleEventFactory,UUID)}var self=this;return self.create=create,self}function RuleEditorWidget(rule,parentWidget,RemoveRuleEventFactory,UUID){function when(value){return void 0!==value&&(self.rule.when=value),self.rule.when}function operator(value){return void 0!==value&&(self.rule.operator=value),self.rule.operator}function answer(value){return void 0!==value&&(self.rule.answer=value),self.rule.answer}function removeRule(){RemoveRuleEventFactory.create().execute(self.rule,self.route),self.parent.updateRuleList(self)}var self=this;self.className=self.constructor.name,self.uuid=UUID.generateUUID(),self.parent=parentWidget,self.route=parentWidget.route,self.rule=rule,self.newRuleGroup={},self.ruleGroups=[],self.when=when,self.operator=operator,self.answer=answer,self.removeRule=removeRule}angular.module("editor.ui").factory("RuleEditorWidgetFactory",RuleEditorWidgetFactory),RuleEditorWidgetFactory.$inject=["RemoveRuleEventFactory","UUID"]}(),function(){"use strict";function imageItem(ImageItemWidgetFactory){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/misc/image/image-item.html",retrict:"E",link:function(scope,element){scope.widget=scope.$parent.widget}};return ddo}angular.module("editor.ui").directive("imageItem",imageItem)}(),function(){"use strict";function ImageItemWidgetFactory(){function create(scope){return new ImageItemWidget(scope)}var self=this;return self.create=create,self}function ImageItemWidget(scope){function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<image-item></image-item>"}var self=this;self.name="ImageItem",self.getParent=getParent,self.item=getItem(),self.getTemplate=getTemplate}angular.module("editor.ui").factory("ImageItemWidgetFactory",ImageItemWidgetFactory)}(),function(){"use strict";function textItem(TextItemWidgetFactory){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/misc/text/text-item.html",retrict:"E",link:function(scope,element){scope.widget=scope.$parent.widget}};return ddo}angular.module("editor.ui").directive("textItem",textItem),textItem.$inject=["TextItemWidgetFactory"]}(),function(){"use strict";function TextItemWidgetFactory(){function create(scope){return new TextItemWidget(scope)}var self=this;return self.create=create,self}function TextItemWidget(scope){function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<text-item></text-item>"}var self=this;self.name="TextItem",self.getParent=getParent,self.item=getItem(),self.getTemplate=getTemplate}angular.module("editor.ui").factory("TextItemWidgetFactory",TextItemWidgetFactory)}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/calendar/calendar-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("calendarQuestion",directive)}(),function(){"use strict";function CalendarQuestionWidgetFactory(){function create(scope,element){return new CalendarQuestionWidget(scope,element)}var self=this;return self.create=create,self}function CalendarQuestionWidget(scope,element){function getClassName(){return"CalendarQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<calendar-question></calendar-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("CalendarQuestionWidgetFactory",CalendarQuestionWidgetFactory)}(),function(){"use strict";function checkboxQuestion(CheckboxQuestionWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/survey-item/question/checkbox/checkbox-question.html",link:function(scope,element){scope.widget=CheckboxQuestionWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("checkboxQuestion",checkboxQuestion),checkboxQuestion.$inject=["CheckboxQuestionWidgetFactory"]}(),function(){"use strict";function CheckboxQuestionWidgetFactory(AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory){function create(scope,element){return new CheckboxQuestionWidget(scope,element,AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory)}var self=this;return self.create=create,self}function CheckboxQuestionWidget(scope,element,AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory){function _init(){self.getItem().options.length>0&&_loadAnswerOptions()}function getClassName(){return"CheckboxQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<checkbox-question></checkbox-question>"}function addOption(){var newOption=AddAnswerOptionEventFactory.create().execute(self),optionWidget=AnswerOptionWidgetFactory.create(newOption,self);self.options.push(optionWidget)}function _loadAnswerOptions(){self.getItem().options.forEach(function(awswerOption){var optionWidget=AnswerOptionWidgetFactory.create(awswerOption,self);self.options.push(optionWidget)})}function removeLastOption(){RemoveAnswerOptionEventFactory.create().execute(self),self.options.splice(-1)}var self=this;self.options=[],self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate,self.addOption=addOption,self.removeLastOption=removeLastOption,_init()}angular.module("editor.ui").factory("CheckboxQuestionWidgetFactory",CheckboxQuestionWidgetFactory),CheckboxQuestionWidgetFactory.$inject=["AnswerOptionWidgetFactory","AddAnswerOptionEventFactory","RemoveAnswerOptionEventFactory"]}(),function(){"use strict";function directive(DecimalQuestionWidgetFactory){var ddo={scope:{ngModel:"=",ariaLabel:"@"},templateUrl:"app/editor/ui/survey-item/question/decimal/decimal-question.html",restrict:"E",link:function(scope,element){scope.widget=DecimalQuestionWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("decimalQuestion",directive),directive.$inject=["DecimalQuestionWidgetFactory"]}(),function(){"use strict";function DecimalQuestionWidgetFactory(){function create(scope,element){return new DecimalQuestionWidget(scope,element)}var self=this;return self.create=create,self}function DecimalQuestionWidget(scope,element){function getClassName(){return"DecimalQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<decimal-question></decimal-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("DecimalQuestionWidgetFactory",DecimalQuestionWidgetFactory)}(),function(){"use strict";angular.module("editor.ui").directive("uiDecimal",function(){return{link:function($scope,element,attrs,ngModelCtrl){function shouldPrintChar(event){var keycode=(angular.element(event.currentTarget),event.which);return isNumberKey(keycode)||isValidKey(keycode)}function formatedInteger(event){var element=angular.element(event.currentTarget),keycode=event.which,currentValue=element.val();0===currentValue.length?lastValidValue="":isNumberKey(keycode)||isValidKey(keycode)?lastValidValue=element.val():isValidKey(keycode)||element.val(lastValidValue)}function isNumberKey(keycode){return keycode>=48&&keycode<=57||keycode>=96&&keycode<=105}function isValidKey(keycode){var minusKey=109===keycode,commaKey=188===keycode,dotKey=190===keycode,shiftKey=16===keycode,backspaceKey=8===keycode,homeKey=36===keycode,endKey=35===keycode,deleteKey=46===keycode,controlKey=17===keycode,leftKey=37===keycode,rightKey=39===keycode;return minusKey||commaKey||dotKey||shiftKey||backspaceKey||homeKey||endKey||deleteKey||controlKey||leftKey||rightKey}var lastValidValue;element.on("keydown",shouldPrintChar),element.on("keyup",formatedInteger)}}})}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/email/email-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("emailQuestion",directive)}(),function(){"use strict";function EmailQuestionWidgetFactory(){function create(scope,element){return new EmailQuestionWidget(scope,element)}var self=this;return self.create=create,self}function EmailQuestionWidget(scope,element){function getClassName(){return"EmailQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<email-question></email-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("EmailQuestionWidgetFactory",EmailQuestionWidgetFactory)}(),function(){"use strict";function directive(IntegerQuestionWidgetFactory){var ddo={scope:{ngModel:"=",ariaLabel:"@"},templateUrl:"app/editor/ui/survey-item/question/integer/integer-question.html",restrict:"E",link:function(scope,element){scope.widget=IntegerQuestionWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("integerQuestion",directive),directive.$inject=["IntegerQuestionWidgetFactory"]}(),function(){"use strict";function IntegerQuestionWidgetFactory(){function create(scope,element){return new IntegerQuestionWidget(scope,element)}var self=this;return self.create=create,self}function IntegerQuestionWidget(scope,element){function getClassName(){return"IntegerQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<integer-question></integer-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("IntegerQuestionWidgetFactory",IntegerQuestionWidgetFactory)}(),function(){"use strict";angular.module("editor.ui").directive("uiInteger",function(){return{link:function($scope,element,attrs,ngModelCtrl){function shouldPrintChar(event){var keycode=(angular.element(event.currentTarget),event.which);return isNumberKey(keycode)||isValidKey(keycode)}function formatedInteger(event){var element=angular.element(event.currentTarget),keycode=event.which,currentValue=element.val();0===currentValue.length?lastValidValue="":isNumberKey(keycode)||isValidKey(keycode)?lastValidValue=element.val():isValidKey(keycode)||element.val(lastValidValue)}function isNumberKey(keycode){return keycode>=48&&keycode<=57||keycode>=96&&keycode<=105}function isValidKey(keycode){var minusKey=109===keycode,shiftKey=16===keycode,backspaceKey=8===keycode,homeKey=36===keycode,endKey=35===keycode,deleteKey=46===keycode,controlKey=17===keycode,leftKey=37===keycode,rightKey=39===keycode;return minusKey||shiftKey||backspaceKey||homeKey||endKey||deleteKey||controlKey||leftKey||rightKey}var lastValidValue;element.on("keydown",shouldPrintChar),element.on("keyup",formatedInteger)}}})}(),function(){"use strict";function directive(){var ddo={scope:{ngModel:"=",ariaLabel:"@"},templateUrl:"app/editor/ui/survey-item/question/phone/phone-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("phoneQuestion",directive)}(),function(){"use strict";function PhoneQuestionWidgetFactory(){function create(scope,element){return new PhoneQuestionWidget(scope,element)}var self=this;return self.create=create,self}function PhoneQuestionWidget(scope,element){function getClassName(){return"PhoneQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<phone-question></phone-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("PhoneQuestionWidgetFactory",PhoneQuestionWidgetFactory)}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/text/text-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("textQuestion",directive)}(),function(){"use strict";function TextQuestionWidgetFactory(){function create(scope,element){return new TextQuestionWidget(scope,element)}var self=this;return self.create=create,self}function TextQuestionWidget(scope,element){function getClassName(){return"TextQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<text-question></text-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("TextQuestionWidgetFactory",TextQuestionWidgetFactory)}(),function(){"use strict";function directive(){var ddo={scope:{},templateUrl:"app/editor/ui/survey-item/question/time/time-question.html",retrict:"E"};return ddo}angular.module("editor.ui").directive("timeQuestion",directive)}(),function(){"use strict";function TimeQuestionWidgetFactory(){function create(scope,element){return new TimeQuestionWidget(scope,element)}var self=this;return self.create=create,self}function TimeQuestionWidget(scope,element){function getClassName(){return"TimeQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<time-question></time-question>"}var self=this;self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate}angular.module("editor.ui").factory("TimeQuestionWidgetFactory",TimeQuestionWidgetFactory)}(),function(){"use strict";function otusAlphanumericValidator(AlphanumericValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/alphanumeric/alphanumeric-validator.html",link:function(scope,element){scope.widget=AlphanumericValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusAlphanumericValidator",otusAlphanumericValidator),otusAlphanumericValidator.$inject=["AlphanumericValidatorWidgetFactory"]}(),function(){"use strict";function AlphanumericValidatorWidgetFactory(){function create(scope,element){return new AlphanumericValidator(scope,element)}var self=this;return self.create=create,self}function AlphanumericValidator(scope,element){function _init(){var avaiableRules=parent.fillingRules.options;avaiableRules.hasOwnProperty(whoAmI)&&(self.data=avaiableRules[whoAmI].data.reference)}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return parent.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="alphanumeric";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var parent=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("AlphanumericValidatorWidgetFactory",AlphanumericValidatorWidgetFactory)}(),function(){"use strict";function otusDistinctValidator(DistinctValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/distinct/distinct-validator.html",link:function(scope,element){scope.widget=DistinctValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusDistinctValidator",otusDistinctValidator),otusDistinctValidator.$inject=["DistinctValidatorWidgetFactory"]}(),function(){"use strict";function DistinctValidatorWidgetFactory(){function create(scope,element){return new DistinctValidator(scope,element)}var self=this;return self.create=create,self}function DistinctValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="distinct";self.data,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("DistinctValidatorWidgetFactory",DistinctValidatorWidgetFactory)}(),function(){"use strict";function otusFutureDateValidator(FutureDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/future-date/future-date-validator.html",link:function(scope,element){scope.widget=FutureDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusFutureDateValidator",otusFutureDateValidator),otusFutureDateValidator.$inject=["FutureDateValidatorWidgetFactory"]}(),function(){"use strict";function FutureDateValidatorWidgetFactory(){function create(scope,element){return new FutureDateValidator(scope,element)}var self=this;return self.create=create,self}function FutureDateValidator(scope,element){function _init(){self.data=new Date(question.fillingRules.options[whoAmI].data.reference)}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="futureDate";self.data,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("FutureDateValidatorWidgetFactory",FutureDateValidatorWidgetFactory)}(),function(){"use strict";function otusInValidator(InValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/in/in-validator.html",link:function(scope,element){scope.widget=InValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusInValidator",otusInValidator),otusInValidator.$inject=["InValidatorWidgetFactory"]}(),function(){"use strict";function InValidatorWidgetFactory(){function create(scope,element){return new InValidator(scope,element)}var self=this;return self.create=create,self}function InValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="in";self.data={initial:null,
end:null},self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("InValidatorWidgetFactory",InValidatorWidgetFactory)}(),function(){"use strict";function otusLowerCaseValidator(LowerCaseValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/lower-case/lower-case-validator.html",link:function(scope,element){scope.widget=LowerCaseValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusLowerCaseValidator",otusLowerCaseValidator),otusLowerCaseValidator.$inject=["LowerCaseValidatorWidgetFactory"]}(),function(){"use strict";function LowerCaseValidatorWidgetFactory(){function create(scope,element){return new LowerCaseValidator(scope,element)}var self=this;return self.create=create,self}function LowerCaseValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="lowerCase";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("LowerCaseValidatorWidgetFactory",LowerCaseValidatorWidgetFactory)}(),function(){"use strict";function otusLowerLimitValidator(LowerLimitValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/lower-limit/lower-limit-validator.html",link:function(scope,element){scope.widget=LowerLimitValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusLowerLimitValidator",otusLowerLimitValidator),otusLowerLimitValidator.$inject=["LowerLimitValidatorWidgetFactory"]}(),function(){"use strict";function LowerLimitValidatorWidgetFactory(){function create(scope,element){return new LowerLimitValidator(scope,element)}var self=this;return self.create=create,self}function LowerLimitValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="lowerLimit";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("LowerLimitValidatorWidgetFactory",LowerLimitValidatorWidgetFactory)}(),function(){"use strict";function otusMandatoryValidator(MandatoryValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/mandatory/mandatory-validator.html",link:function(scope,element){scope.widget=MandatoryValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMandatoryValidator",otusMandatoryValidator),otusMandatoryValidator.$inject=["MandatoryValidatorWidgetFactory"]}(),function(){"use strict";function MandatoryValidatorWidgetFactory(){function create(scope,element){return new MandatoryValidator(scope,element)}var self=this;return self.create=create,self}function MandatoryValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}var self=this,whoAmI="mandatory";self.data,self.updateData=updateData;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MandatoryValidatorWidgetFactory",MandatoryValidatorWidgetFactory)}(),function(){"use strict";function otusMaxDateValidator(MaxDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/max-date/max-date-validator.html",link:function(scope,element){scope.widget=MaxDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMaxDateValidator",otusMaxDateValidator),otusMaxDateValidator.$inject=["MaxDateValidatorWidgetFactory"]}(),function(){"use strict";function MaxDateValidatorWidgetFactory(){function create(scope,element){return new MaxDateValidator(scope,element)}var self=this;return self.create=create,self}function MaxDateValidator(scope,element){function _init(){self.data=new Date(question.fillingRules.options[whoAmI].data.reference),updateData()}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="maxDate";self.data=new Date,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MaxDateValidatorWidgetFactory",MaxDateValidatorWidgetFactory)}(),function(){"use strict";function otusMaxLengthValidator(MaxLengthValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/max-length/max-length-validator.html",link:function(scope,element){scope.widget=MaxLengthValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMaxLengthValidator",otusMaxLengthValidator),otusMaxLengthValidator.$inject=["MaxLengthValidatorWidgetFactory"]}(),function(){"use strict";function MaxLengthValidatorWidgetFactory(){function create(scope,element){return new MaxLengthValidator(scope,element)}var self=this;return self.create=create,self}function MaxLengthValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="maxLength";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MaxLengthValidatorWidgetFactory",MaxLengthValidatorWidgetFactory)}(),function(){"use strict";function otusMaxTimeValidator(MaxTimeValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/max-time/max-time-validator.html",link:function(scope,element){scope.widget=MaxTimeValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMaxTimeValidator",otusMaxTimeValidator),otusMaxTimeValidator.$inject=["MaxTimeValidatorWidgetFactory"]}(),function(){"use strict";function MaxTimeValidatorWidgetFactory(){function create(scope,element){return new MaxTimeValidator(scope,element)}var self=this;return self.create=create,self}function MaxTimeValidator(scope,element){function _init(){var referenceValue=question.fillingRules.options[whoAmI].data.reference;""!==referenceValue?self.data=new Date(referenceValue):(self.data.setHours("01"),self.data.setMinutes("00"),self.data.setSeconds("00"),self.data.setMilliseconds("00")),self.updateData()}function updateData(){self.data&&(getRuleType().data.reference=self.data.toString(),scope.$parent.widget.updateFillingRules())}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="maxTime";self.data=new Date,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MaxTimeValidatorWidgetFactory",MaxTimeValidatorWidgetFactory)}(),function(){"use strict";function otusMinDateValidator(MinDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/min-date/min-date-validator.html",link:function(scope,element){scope.widget=MinDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMinDateValidator",otusMinDateValidator),otusMinDateValidator.$inject=["MinDateValidatorWidgetFactory"]}(),function(){"use strict";function MinDateValidatorWidgetFactory(){function create(scope,element){return new MinDateValidator(scope,element)}var self=this;return self.create=create,self}function MinDateValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=new Date(avaiableRules[whoAmI].data.reference),self.updateData()}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="minDate";self.data=(new Date).toLocaleDateString(),self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MinDateValidatorWidgetFactory",MinDateValidatorWidgetFactory)}(),function(){"use strict";function otusMinLengthValidator(MinLengthValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/min-length/min-length-validator.html",link:function(scope,element){scope.widget=MinLengthValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMinLengthValidator",otusMinLengthValidator),otusMinLengthValidator.$inject=["MinLengthValidatorWidgetFactory"]}(),function(){"use strict";function MinLengthValidatorWidgetFactory(){function create(scope,element){return new MinLengthValidator(scope,element)}var self=this;return self.create=create,self}function MinLengthValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="minLength";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MinLengthValidatorWidgetFactory",MinLengthValidatorWidgetFactory)}(),function(){"use strict";function otusMinTimeValidator(MinTimeValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/min-time/min-time-validator.html",link:function(scope,element){scope.widget=MinTimeValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusMinTimeValidator",otusMinTimeValidator),otusMinTimeValidator.$inject=["MinTimeValidatorWidgetFactory"]}(),function(){"use strict";function MinTimeValidatorWidgetFactory(){function create(scope,element){return new MinTimeValidator(scope,element)}var self=this;return self.create=create,self}function MinTimeValidator(scope,element){function _init(){var referenceValue=question.fillingRules.options[whoAmI].data.reference;""!==referenceValue?self.data=new Date(referenceValue):(self.data.setHours("01"),self.data.setMinutes("00"),self.data.setSeconds("00"),self.data.setMilliseconds("00")),self.updateData()}function updateData(){self.data&&(getRuleType().data.reference=self.data.toString(),scope.$parent.widget.updateFillingRules())}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="minTime";self.data=new Date("Fri Mar 25 2015 09:56:24 GMT+0100 (Tokyo Time)"),self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("MinTimeValidatorWidgetFactory",MinTimeValidatorWidgetFactory)}(),function(){"use strict";function otusParameterValidator(ParameterValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/parameter/parameter-validator.html",link:function(scope,element){scope.widget=ParameterValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusParameterValidator",otusParameterValidator),otusParameterValidator.$inject=["ParameterValidatorWidgetFactory"]}(),function(){"use strict";function ParameterValidatorWidgetFactory(){function create(scope,element){return new ParameterValidator(scope,element)}var self=this;return self.create=create,self}function ParameterValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;avaiableRules.hasOwnProperty(whoAmI)&&(self.data=avaiableRules[whoAmI].data.reference)}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="parameter";self.data="",self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("ParameterValidatorWidgetFactory",ParameterValidatorWidgetFactory)}(),function(){"use strict";function otusPastDateValidator(PastDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/past-date/past-date-validator.html",link:function(scope,element){scope.widget=PastDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusPastDateValidator",otusPastDateValidator),otusPastDateValidator.$inject=["PastDateValidatorWidgetFactory"]}(),function(){"use strict";function PastDateValidatorWidgetFactory(){function create(scope,element){return new PastDateValidator(scope,element)}var self=this;return self.create=create,self}function PastDateValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=new Date(avaiableRules[whoAmI].data.reference),self.updateData()}function updateData(){getRuleType().data.reference=self.data.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="pastDate";self.data=new Date,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("PastDateValidatorWidgetFactory",PastDateValidatorWidgetFactory)}(),function(){"use strict";function otusPrecisionValidator(PrecisionValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/precision/precision-validator.html",link:function(scope,element){scope.widget=PrecisionValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusPrecisionValidator",otusPrecisionValidator),otusPrecisionValidator.$inject=["PrecisionValidatorWidgetFactory"]}(),function(){"use strict";function PrecisionValidatorWidgetFactory(){function create(scope,element){return new PrecisionValidator(scope,element)}var self=this;return self.create=create,self}function PrecisionValidator(scope,element){function _init(){self.data=question.fillingRules.options[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="precision";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("PrecisionValidatorWidgetFactory",PrecisionValidatorWidgetFactory)}(),function(){"use strict";function otusRangeDateValidator(RangeDateValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/range-date/range-date-validator.html",link:function(scope,element){scope.widget=RangeDateValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusRangeDateValidator",otusRangeDateValidator),otusRangeDateValidator.$inject=["RangeDateValidatorWidgetFactory"]}(),function(){"use strict";function RangeDateValidatorWidgetFactory(){function create(scope,element){return new RangeDateValidator(scope,element)}var self=this;return self.create=create,self}function RangeDateValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data.initial=new Date(avaiableRules[whoAmI].data.reference.initial),self.data.end=new Date(avaiableRules[whoAmI].data.reference.end),self.updateData()}function updateData(){getRuleType().data.reference.initial=self.data.initial.toLocaleDateString(),getRuleType().data.reference.end=self.data.end.toLocaleDateString(),scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="rangeDate";self.data={initial:new Date,end:new Date},self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("RangeDateValidatorWidgetFactory",RangeDateValidatorWidgetFactory)}(),function(){"use strict";function otusScaleValidator(ScaleValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/scale/scale-validator.html",link:function(scope,element){scope.widget=ScaleValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusScaleValidator",otusScaleValidator),otusScaleValidator.$inject=["ScaleValidatorWidgetFactory"]}(),function(){"use strict";function ScaleValidatorWidgetFactory(){function create(scope,element){return new ScaleValidator(scope,element)}var self=this;return self.create=create,self}function ScaleValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="scale";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("ScaleValidatorWidgetFactory",ScaleValidatorWidgetFactory)}(),function(){"use strict";function otusSpecialsValidator(SpecialsValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/specials/specials-validator.html",link:function(scope,element){scope.widget=SpecialsValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusSpecialsValidator",otusSpecialsValidator),otusSpecialsValidator.$inject=["SpecialsValidatorWidgetFactory"]}(),function(){"use strict";function SpecialsValidatorWidgetFactory(){function create(scope,element){return new SpecialsValidator(scope,element)}var self=this;return self.create=create,self}function SpecialsValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="specials";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("SpecialsValidatorWidgetFactory",SpecialsValidatorWidgetFactory)}(),function(){"use strict";function otusUpperCaseValidator(UpperCaseValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/upper-case/upper-case-validator.html",link:function(scope,element){scope.widget=UpperCaseValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusUpperCaseValidator",otusUpperCaseValidator),otusUpperCaseValidator.$inject=["UpperCaseValidatorWidgetFactory"]}(),function(){"use strict";function UpperCaseValidatorWidgetFactory(){function create(scope,element){return new UpperCaseValidator(scope,element)}var self=this;return self.create=create,self}function UpperCaseValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="upperCase";self.data=!0,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("UpperCaseValidatorWidgetFactory",UpperCaseValidatorWidgetFactory)}(),function(){"use strict";function otusUpperLimitValidator(UpperLimitValidatorWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/validation/require/upper-limit/upper-limit-validator.html",link:function(scope,element){scope.widget=UpperLimitValidatorWidgetFactory.create(scope,element)}};return ddo}angular.module("editor.ui").directive("otusUpperLimitValidator",otusUpperLimitValidator),otusUpperLimitValidator.$inject=["UpperLimitValidatorWidgetFactory"]}(),function(){"use strict";function UpperLimitValidatorWidgetFactory(){function create(scope,element){return new UpperLimitValidator(scope,element)}var self=this;return self.create=create,self}function UpperLimitValidator(scope,element){function _init(){var avaiableRules=question.fillingRules.options;self.data=avaiableRules[whoAmI].data.reference}function updateData(){getRuleType().data.reference=self.data,scope.$parent.widget.updateFillingRules()}function getRuleType(){return question.fillingRules.options[whoAmI]}function deleteValidator(){scope.$parent.widget.deleteValidator(whoAmI),element.remove(),scope.$destroy()}var self=this,whoAmI="upperLimit";self.data=null,self.updateData=updateData,self.deleteValidator=deleteValidator;var question=scope.$parent.widget.getItem();_init()}angular.module("editor.ui").factory("UpperLimitValidatorWidgetFactory",UpperLimitValidatorWidgetFactory)}(),function(){"use strict";function directive(SingleSelectionQuestionWidgetFactory){var ddo={scope:{},restrict:"E",templateUrl:"app/editor/ui/survey-item/question/single-selection/group/single-selection-question.html",link:function(scope){scope.widget=scope.$parent.widget}};return ddo}angular.module("editor.ui").directive("singleSelectionQuestion",directive),directive.$inject=["SingleSelectionQuestionWidgetFactory"]}(),function(){"use strict";function SingleSelectionQuestionWidgetFactory(AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory){function create(scope,element){return new SingleSelectionQuestionWidget(scope,element,AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory)}var self=this;return self.create=create,self}function SingleSelectionQuestionWidget(scope,element,AnswerOptionWidgetFactory,AddAnswerOptionEventFactory,RemoveAnswerOptionEventFactory){function _init(){self.getItem().options.length>0&&_loadAnswerOptions()}function getClassName(){return"SingleSelectionQuestionWidget"}function getUUID(){return scope.uuid}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function getTemplate(){return"<single-selection-question></single-selection-question>"}function addOption(){var newOption=AddAnswerOptionEventFactory.create().execute(self),optionWidget=AnswerOptionWidgetFactory.create(newOption,self);self.options.push(optionWidget)}function _loadAnswerOptions(){self.getItem().options.forEach(function(awswerOption){var optionWidget=AnswerOptionWidgetFactory.create(awswerOption,self);self.options.push(optionWidget)})}function removeLastOption(){RemoveAnswerOptionEventFactory.create().execute(self),self.options.splice(-1)}var self=this;self.options=[],self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getTemplate=getTemplate,self.addOption=addOption,self.removeLastOption=removeLastOption,_init()}angular.module("editor.ui").factory("SingleSelectionQuestionWidgetFactory",SingleSelectionQuestionWidgetFactory),SingleSelectionQuestionWidgetFactory.$inject=["AnswerOptionWidgetFactory","AddAnswerOptionEventFactory","RemoveAnswerOptionEventFactory"]}(),function(){"use strict";function AnswerOptionWidgetFactory(){function create(option,parentGroup){return new AnswerOptionWidget(option,parentGroup)}var self=this;return self.create=create,self}function AnswerOptionWidget(option,parentGroup){var self=this;self.name="AnswerOption",self.parentGroup=parentGroup,self.option=option}angular.module("editor.ui").factory("AnswerOptionWidgetFactory",AnswerOptionWidgetFactory)}();